<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Administration guide for Red Hat Developer Hub</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.2"/><meta name="description" content="Red Hat Developer Hub is an enterprise-grade platform for building developer portals. As an administrative user, you can manage roles and permissions of other users and configure Developer Hub to meet the specific needs of your organization."/><link rel="next" href="#assembly-add-custom-app-file-openshift_admin-rhdh" title="1. Adding a custom application configuration file to Red Hat OpenShift Container Platform"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><section xml:lang="en-US" class="article" id="idm45975126016672"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Developer Hub</span> <span class="productnumber">1.4</span></div><div><h1 class="title">Administration guide for Red Hat Developer Hub</h1></div><div><h3 class="subtitle"><em/></h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat Customer Content Services</span></div></div><div><a href="#idm45975125086368">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Red Hat Developer Hub is an enterprise-grade platform for building developer portals. As an administrative user, you can manage roles and permissions of other users and configure Developer Hub to meet the specific needs of your organization.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="section"><a href="#assembly-add-custom-app-file-openshift_admin-rhdh">1. Adding a custom application configuration file to Red Hat OpenShift Container Platform</a></span><ul><li><span class="section"><a href="#proc-add-custom-app-file-openshift-helm_admin-rhdh">1.1. Adding a custom application configuration file to OpenShift Container Platform using the Helm chart</a></span></li><li><span class="section"><a href="#proc-add-custom-app-config-file-ocp-operator_admin-rhdh">1.2. Adding a custom application configuration file to OpenShift Container Platform using the Operator</a></span></li></ul></li><li><span class="section"><a href="#assembly-configuring-external-postgresql-databases">2. Configuring external PostgreSQL databases</a></span><ul><li><span class="section"><a href="#proc-configuring-postgresql-instance-using-operator_admin-rhdh">2.1. Configuring an external PostgreSQL instance using the Operator</a></span></li><li><span class="section"><a href="#proc-configuring-postgresql-instance-using-helm_admin-rhdh">2.2. Configuring an external PostgreSQL instance using the Helm Chart</a></span></li><li><span class="section"><a href="#proc-migrating-databases-to-an-external-server_admin-rhdh">2.3. Migrating local databases to an external database server using the Operator</a></span></li></ul></li><li><span class="section"><a href="#proc-configuring-an-rhdh-instance-with-tls-in-kubernetes_admin-rhdh">3. Configuring an RHDH instance with a TLS connection in Kubernetes</a></span></li><li><span class="section"><a href="#assembly-running-rhdh-behind-a-proxy">4. Running the RHDH application behind a corporate proxy</a></span><ul><li><span class="section"><a href="#understanding-no-proxy">4.1. Understanding the <code class="literal">NO_PROXY</code> exclusion rules</a></span></li><li><span class="section"><a href="#proc-configuring-proxy-in-helm-deployment_admin-rhdh">4.2. Configuring proxy information in Helm deployment</a></span></li><li><span class="section"><a href="#proc-configuring-proxy-in-operator-deployment_admin-rhdh">4.3. Configuring proxy information in Operator deployment</a></span></li></ul></li><li><span class="section"><a href="#assembly-rhdh-integration-aws">5. Red Hat Developer Hub integration with Amazon Web Services (AWS)</a></span></li><li><span class="section"><a href="#assembly-admin-templates">6. Managing templates</a></span><ul><li><span class="section"><a href="#proc-creating-templates_assembly-admin-templates">6.1. Creating a template by using the Template Editor</a></span></li><li><span class="section"><a href="#ref-creating-templates_assembly-admin-templates">6.2. Creating a template as a YAML file</a></span></li><li><span class="section"><a href="#proc-adding-templates_assembly-admin-templates">6.3. Importing an existing template to Red Hat Developer Hub</a></span></li></ul></li><li><span class="section"><a href="#assembly-techdocs-plugin_assembly-admin-templates">7. Configuring the TechDocs plugin in Red Hat Developer Hub</a></span><ul><li><span class="section"><a href="#con-techdocs-configure-storage_assembly-admin-templates">7.1. Configuring storage for TechDocs files</a></span></li><li><span class="section"><a href="#con-techdocs-config-cicd_assembly-admin-templates">7.2. Configuring CI/CD to generate and publish TechDocs sites</a></span></li></ul></li><li><span class="section"><a href="#proc-rhdh-deployment-config_assembly-admin-templates">8. Configuring Red Hat Developer Hub deployment</a></span><ul><li><span class="section"><a href="#proc-mount-directories-pvcs_assembly-admin-templates">8.1. Mounting directories from pre-created PVCs</a></span></li></ul></li></ul></div><p>
		Red Hat Developer Hub is an enterprise-grade, open developer platform that you can use to build developer portals. This platform contains a supported and opinionated framework that helps reduce the friction and frustration of developers while boosting their productivity.
	</p><section class="section" id="assembly-add-custom-app-file-openshift_admin-rhdh"><div class="titlepage"><div><div><h2 class="title">1. Adding a custom application configuration file to Red Hat OpenShift Container Platform</h2></div></div></div><p>
			To access the Red Hat Developer Hub, you must add a custom application configuration file to Red Hat OpenShift Container Platform. In OpenShift Container Platform, you can use the following content as a base template to create a ConfigMap named <code class="literal">app-config-rhdh</code>:
		</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  app-config-rhdh.yaml: |
    app:
      title: Red Hat Developer Hub</pre><p>
			You can add the custom application configuration file to OpenShift Container Platform in one of the following ways:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The Red Hat Developer Hub Operator
				</li><li class="listitem">
					The Red Hat Developer Hub Helm chart
				</li></ul></div><section class="section" id="proc-add-custom-app-file-openshift-helm_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">1.1. Adding a custom application configuration file to OpenShift Container Platform using the Helm chart</h3></div></div></div><p>
				You can use the Red Hat Developer Hub Helm chart to add a custom application configuration file to your OpenShift Container Platform instance.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created an Red Hat OpenShift Container Platform account.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						From the OpenShift Container Platform web console, select the <span class="strong strong"><strong>ConfigMaps</strong></span> tab.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Create ConfigMap</strong></span>.
					</li><li class="listitem">
						From <span class="strong strong"><strong>Create ConfigMap</strong></span> page, select the <span class="strong strong"><strong>YAML view</strong></span> option in <span class="strong strong"><strong>Configure via</strong></span> and make changes to the file, if needed.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Create</strong></span>.
					</li><li class="listitem">
						Go to the <span class="strong strong"><strong>Helm</strong></span> tab to see the list of Helm releases.
					</li><li class="listitem">
						Click the overflow menu on the Helm release that you want to use and select <span class="strong strong"><strong>Upgrade</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Use either the <span class="strong strong"><strong>Form view</strong></span> or <span class="strong strong"><strong>YAML view</strong></span> to edit the Helm configuration.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Using <span class="strong strong"><strong>Form view</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Expand <span class="strong strong"><strong>Root Schema → Backstage chart schema → Backstage parameters → Extra app configuration files to inline into command arguments</strong></span>.
									</li><li class="listitem">
										Click the <span class="strong strong"><strong>Add Extra app configuration files to inline into command arguments</strong></span> link.
									</li><li class="listitem"><p class="simpara">
										Enter the value in the following fields:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<span class="strong strong"><strong>configMapRef</strong></span>: <code class="literal">app-config-rhdh</code>
											</li><li class="listitem">
												<span class="strong strong"><strong>filename</strong></span>: <code class="literal">app-config-rhdh.yaml</code>
											</li></ul></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Upgrade</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Using <span class="strong strong"><strong>YAML view</strong></span>
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Set the value of the <code class="literal">upstream.backstage.extraAppConfig.configMapRef</code> and <code class="literal">upstream.backstage.extraAppConfig.filename</code> parameters as follows:
									</p><pre class="programlisting language-yaml"># ... other Red Hat Developer Hub Helm Chart configurations
upstream:
  backstage:
    extraAppConfig:
      - configMapRef: app-config-rhdh
        filename: app-config-rhdh.yaml
# ... other Red Hat Developer Hub Helm Chart configurations</pre></li><li class="listitem">
										Click <span class="strong strong"><strong>Upgrade</strong></span>.
									</li></ol></div></li></ul></div></li></ol></div></section><section class="section" id="proc-add-custom-app-config-file-ocp-operator_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">1.2. Adding a custom application configuration file to OpenShift Container Platform using the Operator</h3></div></div></div><p>
				A custom application configuration file is a <code class="literal">ConfigMap</code> object that you can use to change the configuration of your Red Hat Developer Hub instance. If you are deploying your Developer Hub instance on Red Hat OpenShift Container Platform, you can use the Red Hat Developer Hub Operator to add a custom application configuration file to your OpenShift Container Platform instance by creating the <code class="literal">ConfigMap</code> object and referencing it in the Developer Hub custom resource (CR).
			</p><p>
				The custom application configuration file contains a sensitive environment variable, named <code class="literal">BACKEND_SECRET</code>. This variable contains a mandatory backend authentication key that Developer Hub uses to reference an environment variable defined in an OpenShift Container Platform secret. You must create a secret, named 'secrets-rhdh', and reference it in the Developer Hub CR.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					You are responsible for protecting your Red Hat Developer Hub installation from external and unauthorized access. Manage the backend authentication key like any other secret. Meet strong password requirements, do not expose it in any configuration files, and only inject it into configuration files as an environment variable.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have an active Red Hat OpenShift Container Platform account.
					</li><li class="listitem">
						Your administrator has installed the Red Hat Developer Hub Operator in OpenShift Container Platform. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.4/html-single/administration_guide_for_red_hat_developer_hub/index">Installing the Red Hat Developer Hub Operator</a>.
					</li><li class="listitem">
						You have created the Red Hat Developer Hub CR in OpenShift Container Platform.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						From the <span class="strong strong"><strong>Developer</strong></span> perspective in the OpenShift Container Platform web console, select the <span class="strong strong"><strong>Topology</strong></span> view, and click the <span class="strong strong"><strong>Open URL</strong></span> icon on the Developer Hub pod to identify your Developer Hub external URL: <span class="emphasis"><em>&lt;RHDH_URL&gt;</em></span>.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Developer</strong></span> perspective in the OpenShift Container Platform web console, select the <span class="strong strong"><strong>ConfigMaps</strong></span> view.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Create ConfigMap</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Select the <span class="strong strong"><strong>YAML view</strong></span> option in <span class="strong strong"><strong>Configure via</strong></span> and use the following example as a base template to create a <code class="literal">ConfigMap</code> object, such as <code class="literal">app-config-rhdh.yaml</code>:
					</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  "app-config-rhdh.yaml": |
    app:
      title: Red Hat Developer Hub
      baseUrl: &lt;RHDH_URL&gt; <span id="CO1-1"/><span class="callout">1</span>
    backend:
      auth:
        externalAccess:
            - type: legacy
              options:
                subject: legacy-default-config
                secret: "${BACKEND_SECRET}" <span id="CO1-2"/><span class="callout">2</span>
      baseUrl: &lt;RHDH_URL&gt; <span id="CO1-3"/><span class="callout">3</span>
      cors:
        origin: &lt;RHDH_URL&gt; <span id="CO1-4"/><span class="callout">4</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the external URL of your Red Hat Developer Hub instance.
							</div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Use an environment variable exposing an OpenShift Container Platform secret to define the mandatory Developer Hub backend authentication key.
							</div></dd><dt><a href="#CO1-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Set the external URL of your Red Hat Developer Hub instance.
							</div></dd><dt><a href="#CO1-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Set the external URL of your Red Hat Developer Hub instance.
							</div></dd></dl></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Create</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Secrets</strong></span> view.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Create Key/value Secret</strong></span>.
					</li><li class="listitem">
						Create a secret named <code class="literal">secrets-rhdh</code>.
					</li><li class="listitem"><p class="simpara">
						Add a key named <code class="literal">BACKEND_SECRET</code> and a base64 encoded string as a value. Use a unique value for each Red Hat Developer Hub instance. For example, you can use the following command to generate a key from your terminal:
					</p><pre class="programlisting language-yaml">node -p 'require("crypto").randomBytes(24).toString("base64")'</pre></li><li class="listitem">
						Click <span class="strong strong"><strong>Create</strong></span>.
					</li><li class="listitem">
						Select the <span class="strong strong"><strong>Topology</strong></span> view.
					</li><li class="listitem"><p class="simpara">
						Click the overflow menu for the Red Hat Developer Hub instance that you want to use and select <span class="strong strong"><strong>Edit Backstage</strong></span> to load the YAML view of the Red Hat Developer Hub instance.
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/rhdh/operator-install-2.png" alt="operator install 2"/></div></div></li><li class="listitem"><p class="simpara">
						In the CR, enter the name of the custom application configuration config map as the value for the <code class="literal">spec.application.appConfig.configMaps</code> field, and enter the name of your secret as the value for the <code class="literal">spec.application.extraEnvs.secrets</code> field. For example:
					</p><pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha1
kind: Backstage
metadata:
  name: developer-hub
spec:
  application:
    appConfig:
      mountPath: /opt/app-root/src
      configMaps:
         - name: app-config-rhdh
    extraEnvs:
      secrets:
         - name: secrets-rhdh
    extraFiles:
      mountPath: /opt/app-root/src
    replicas: 1
    route:
      enabled: true
  database:
    enableLocalDb: true</pre></li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>.
					</li><li class="listitem">
						Navigate back to the <span class="strong strong"><strong>Topology</strong></span> view and wait for the Red Hat Developer Hub pod to start.
					</li><li class="listitem">
						Click the <span class="strong strong"><strong>Open URL</strong></span> icon to use the Red Hat Developer Hub platform with the configuration changes.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information about roles and responsibilities in Developer Hub, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.4/html-single/administration_guide_for_red_hat_developer_hub/index">Role-Based Access Control (RBAC) in Red Hat Developer Hub</a>.
					</li></ul></div></section></section><section class="section" id="assembly-configuring-external-postgresql-databases"><div class="titlepage"><div><div><h2 class="title">2. Configuring external PostgreSQL databases</h2></div></div></div><p>
			As an administrator, you can configure and use external PostgreSQL databases in Red Hat Developer Hub. You can use a PostgreSQL certificate file to configure an external PostgreSQL instance using the Operator or Helm Chart.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Developer Hub supports the configuration of external PostgreSQL databases. You can perform maintenance activities, such as backing up your data or configuring high availability (HA) for the external PostgreSQL databases.
			</p><p>
				By default, the Red Hat Developer Hub operator or Helm Chart creates a local PostgreSQL database. However, this configuration is not suitable for the production environments. For production deployments, disable the creation of local database and configure Developer Hub to connect to an external PostgreSQL instance instead.
			</p></div></div><section class="section" id="proc-configuring-postgresql-instance-using-operator_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">2.1. Configuring an external PostgreSQL instance using the Operator</h3></div></div></div><p>
				You can configure an external PostgreSQL instance using the Red Hat Developer Hub Operator. By default, the Operator creates and manages a local instance of PostgreSQL in the same namespace where you have deployed the RHDH instance. However, you can change this default setting to configure an external PostgreSQL database server, for example, Amazon Web Services (AWS) Relational Database Service (RDS) or Azure database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are using a supported version of PostgreSQL. For more information, see the <a class="link" href="https://access.redhat.com/support/policy/updates/developerhub">Product life cycle page</a>.
					</li><li class="listitem"><p class="simpara">
						You have the following details:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">db-host</code>: Denotes your PostgreSQL instance Domain Name System (DNS) or IP address
							</li><li class="listitem">
								<code class="literal">db-port</code>: Denotes your PostgreSQL instance port number, such as <code class="literal">5432</code>
							</li><li class="listitem">
								<code class="literal">username</code>: Denotes the user name to connect to your PostgreSQL instance
							</li><li class="listitem">
								<code class="literal">password</code>: Denotes the password to connect to your PostgreSQL instance
							</li></ul></div></li><li class="listitem">
						You have installed the Red Hat Developer Hub Operator.
					</li><li class="listitem">
						Optional: You have a CA certificate, Transport Layer Security (TLS) private key, and TLS certificate so that you can secure your database connection by using the TLS protocol. For more information, refer to your PostgreSQL vendor documentation.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, Developer Hub uses a database for each plugin and automatically creates it if none is found. You might need the <code class="literal">Create Database</code> privilege in addition to <code class="literal">PSQL Database</code> privileges for configuring an external PostgreSQL instance.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Create a certificate secret to configure your PostgreSQL instance with a TLS connection:
					</p><pre class="programlisting language-yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;crt-secret&gt; <span id="CO2-1"/><span class="callout">1</span>
type: Opaque
stringData:
 postgres-ca.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;ca-certificate-key&gt; <span id="CO2-2"/><span class="callout">2</span>
 postgres-key.key: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-private-key&gt; <span id="CO2-3"/><span class="callout">3</span>
 postgres-crt.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-certificate-key&gt; <span id="CO2-4"/><span class="callout">4</span>
  # ...
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Provide the name of the certificate secret.
							</div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide the CA certificate key.
							</div></dd><dt><a href="#CO2-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Optional: Provide the TLS private key.
							</div></dd><dt><a href="#CO2-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Provide the TLS certificate key.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Create a credential secret to connect with the PostgreSQL instance:
					</p><pre class="programlisting language-yaml">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;cred-secret&gt; <span id="CO3-1"/><span class="callout">1</span>
type: Opaque
stringData: <span id="CO3-2"/><span class="callout">2</span>
 POSTGRES_PASSWORD: &lt;password&gt;
 POSTGRES_PORT: "&lt;db-port&gt;"
 POSTGRES_USER: &lt;username&gt;
 POSTGRES_HOST: &lt;db-host&gt;
 PGSSLMODE: &lt;ssl-mode&gt; # for TLS connection <span id="CO3-3"/><span class="callout">3</span>
 NODE_EXTRA_CA_CERTS: &lt;abs-path-to-pem-file&gt; # for TLS connection, e.g. /opt/app-root/src/postgres-crt.pem <span id="CO3-4"/><span class="callout">4</span>
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Provide the name of the credential secret.
							</div></dd><dt><a href="#CO3-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide credential data to connect with your PostgreSQL instance.
							</div></dd><dt><a href="#CO3-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Optional: Provide the value based on the required <a class="link" href="https://www.postgresql.org/docs/15/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">Secure Sockets Layer (SSL) mode</a>.
							</div></dd><dt><a href="#CO3-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Provide the value only if you need a TLS connection for your PostgreSQL instance.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">Backstage</code> custom resource (CR):
					</p><pre class="programlisting language-terminal">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: rhdh.redhat.com/v1alpha1
kind: Backstage
metadata:
  name: &lt;backstage-instance-name&gt;
spec:
  database:
    enableLocalDb: false <span id="CO4-1"/><span class="callout">1</span>
  application:
    extraFiles:
      mountPath: &lt;path&gt; # e g /opt/app-root/src
      secrets:
        - name: &lt;crt-secret&gt; <span id="CO4-2"/><span class="callout">2</span>
          key: postgres-crt.pem, postgres-ca.pem, postgres-key.key # key name as in &lt;crt-secret&gt; Secret
    extraEnvs:
      secrets:
        - name: &lt;cred-secret&gt; <span id="CO4-3"/><span class="callout">3</span>
        # ...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the value of the <code class="literal">enableLocalDb</code> parameter to <code class="literal">false</code> to disable creating local PostgreSQL instances.
							</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide the name of the certificate secret if you have configured a TLS connection.
							</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Provide the name of the credential secret that you created.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The environment variables listed in the <code class="literal">Backstage</code> CR work with the Operator default configuration. If you have changed the Operator default configuration, you must reconfigure the <code class="literal">Backstage</code> CR accordingly.
						</p></div></div></li><li class="listitem">
						Apply the <code class="literal">Backstage</code> CR to the namespace where you have deployed the RHDH instance.
					</li></ol></div></section><section class="section" id="proc-configuring-postgresql-instance-using-helm_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">2.2. Configuring an external PostgreSQL instance using the Helm Chart</h3></div></div></div><p>
				You can configure an external PostgreSQL instance by using the Helm Chart. By default, the Helm Chart creates and manages a local instance of PostgreSQL in the same namespace where you have deployed the RHDH instance. However, you can change this default setting to configure an external PostgreSQL database server, for example, Amazon Web Services (AWS) Relational Database Service (RDS) or Azure database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are using a supported version of PostgreSQL. For more information, see the <a class="link" href="https://access.redhat.com/support/policy/updates/developerhub">Product life cycle page</a>.
					</li><li class="listitem"><p class="simpara">
						You have the following details:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">db-host</code>: Denotes your PostgreSQL instance Domain Name System (DNS) or IP address
							</li><li class="listitem">
								<code class="literal">db-port</code>: Denotes your PostgreSQL instance port number, such as <code class="literal">5432</code>
							</li><li class="listitem">
								<code class="literal">username</code>: Denotes the user name to connect to your PostgreSQL instance
							</li><li class="listitem">
								<code class="literal">password</code>: Denotes the password to connect to your PostgreSQL instance
							</li></ul></div></li><li class="listitem">
						You have installed the RHDH application by using the Helm Chart.
					</li><li class="listitem">
						Optional: You have a CA certificate, Transport Layer Security (TLS) private key, and TLS certificate so that you can secure your database connection by using the TLS protocol. For more information, refer to your PostgreSQL vendor documentation.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					By default, Developer Hub uses a database for each plugin and automatically creates it if none is found. You might need the <code class="literal">Create Database</code> privilege in addition to <code class="literal">PSQL Database</code> privileges for configuring an external PostgreSQL instance.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Create a certificate secret to configure your PostgreSQL instance with a TLS connection:
					</p><pre class="programlisting language-terminal">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;crt-secret&gt; <span id="CO5-1"/><span class="callout">1</span>
type: Opaque
stringData:
 postgres-ca.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;ca-certificate-key&gt; <span id="CO5-2"/><span class="callout">2</span>
 postgres-key.key: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-private-key&gt; <span id="CO5-3"/><span class="callout">3</span>
 postgres-crt.pem: |-
  -----BEGIN CERTIFICATE-----
  &lt;tls-certificate-key&gt; <span id="CO5-4"/><span class="callout">4</span>
  # ...
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Provide the name of the certificate secret.
							</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide the CA certificate key.
							</div></dd><dt><a href="#CO5-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Optional: Provide the TLS private key.
							</div></dd><dt><a href="#CO5-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Provide the TLS certificate key.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Create a credential secret to connect with the PostgreSQL instance:
					</p><pre class="programlisting language-terminal">cat &lt;&lt;EOF | oc -n &lt;your-namespace&gt; create -f -
apiVersion: v1
kind: Secret
metadata:
 name: &lt;cred-secret&gt; <span id="CO6-1"/><span class="callout">1</span>
type: Opaque
stringData: <span id="CO6-2"/><span class="callout">2</span>
 POSTGRES_PASSWORD: &lt;password&gt;
 POSTGRES_PORT: "&lt;db-port&gt;"
 POSTGRES_USER: &lt;username&gt;
 POSTGRES_HOST: &lt;db-host&gt;
 PGSSLMODE: &lt;ssl-mode&gt; # for TLS connection <span id="CO6-3"/><span class="callout">3</span>
 NODE_EXTRA_CA_CERTS: &lt;abs-path-to-pem-file&gt; # for TLS connection, e.g. /opt/app-root/src/postgres-crt.pem <span id="CO6-4"/><span class="callout">4</span>
EOF</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Provide the name of the credential secret.
							</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide credential data to connect with your PostgreSQL instance.
							</div></dd><dt><a href="#CO6-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Optional: Provide the value based on the required <a class="link" href="https://www.postgresql.org/docs/15/libpq-connect.html#LIBPQ-CONNECT-SSLMODE">Secure Sockets Layer (SSL) mode</a>.
							</div></dd><dt><a href="#CO6-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Provide the value only if you need a TLS connection for your PostgreSQL instance.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Configure your PostgreSQL instance in the Helm configuration file named <code class="literal">values.yaml</code>:
					</p><pre class="programlisting language-yaml"># ...
upstream:
  postgresql:
    enabled: false  # disable PostgreSQL instance creation <span id="CO7-1"/><span class="callout">1</span>
    auth:
      existingSecret: &lt;cred-secret&gt; # inject credentials secret to Backstage <span id="CO7-2"/><span class="callout">2</span>
  backstage:
    appConfig:
      backend:
        database:
          connection:  # configure Backstage DB connection parameters
            host: ${POSTGRES_HOST}
            port: ${POSTGRES_PORT}
            user: ${POSTGRES_USER}
            password: ${POSTGRES_PASSWORD}
            ssl:
              rejectUnauthorized: true,
              ca:
                $file: /opt/app-root/src/postgres-ca.pem
              key:
                $file: /opt/app-root/src/postgres-key.key
              cert:
                $file: /opt/app-root/src/postgres-crt.pem
  extraEnvVarsSecrets:
    - &lt;cred-secret&gt; # inject credentials secret to Backstage <span id="CO7-3"/><span class="callout">3</span>
  extraEnvVars:
    - name: BACKEND_SECRET
      valueFrom:
        secretKeyRef:
          key: backend-secret
          name: '{{ include "janus-idp.backend-secret-name" $ }}'
  extraVolumeMounts:
    - mountPath: /opt/app-root/src/dynamic-plugins-root
      name: dynamic-plugins-root
    - mountPath: /opt/app-root/src/postgres-crt.pem
      name: postgres-crt # inject TLS certificate to Backstage cont. <span id="CO7-4"/><span class="callout">4</span>
      subPath: postgres-crt.pem
    - mountPath: /opt/app-root/src/postgres-ca.pem
      name: postgres-ca # inject CA certificate to Backstage cont. <span id="CO7-5"/><span class="callout">5</span>
      subPath: postgres-ca.pem
    - mountPath: /opt/app-root/src/postgres-key.key
      name: postgres-key # inject TLS private key to Backstage cont. <span id="CO7-6"/><span class="callout">6</span>
      subPath: postgres-key.key
  extraVolumes:
    - ephemeral:
        volumeClaimTemplate:
          spec:
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 1Gi
      name: dynamic-plugins-root
    - configMap:
        defaultMode: 420
        name: dynamic-plugins
        optional: true
      name: dynamic-plugins
    - name: dynamic-plugins-npmrc
      secret:
        defaultMode: 420
        optional: true
        secretName: dynamic-plugins-npmrc
    - name: postgres-crt
      secret:
        secretName: &lt;crt-secret&gt; <span id="CO7-7"/><span class="callout">7</span>
        # ...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO7-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								Set the value of the <code class="literal">upstream.postgresql.enabled</code> parameter to <code class="literal">false</code> to disable creating local PostgreSQL instances.
							</div></dd><dt><a href="#CO7-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								Provide the name of the credential secret.
							</div></dd><dt><a href="#CO7-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Provide the name of the credential secret.
							</div></dd><dt><a href="#CO7-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								Optional: Provide the name of the TLS certificate only for a TLS connection.
							</div></dd><dt><a href="#CO7-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								Optional: Provide the name of the CA certificate only for a TLS connection.
							</div></dd><dt><a href="#CO7-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								Optional: Provide the name of the TLS private key only if your TLS connection requires a private key.
							</div></dd><dt><a href="#CO7-7"><span class="callout">7</span></a> </dt><dd><div class="para">
								Provide the name of the certificate secret if you have configured a TLS connection.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Apply the configuration changes in your Helm configuration file named <code class="literal">values.yaml</code>:
					</p><pre class="programlisting language-terminal">helm upgrade -n &lt;your-namespace&gt; &lt;your-deploy-name&gt; openshift-helm-charts/redhat-developer-hub -f values.yaml --version 1.4.0</pre></li></ol></div></section><section class="section" id="proc-migrating-databases-to-an-external-server_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">2.3. Migrating local databases to an external database server using the Operator</h3></div></div></div><p>
				By default, Red Hat Developer Hub hosts the data for each plugin in a PostgreSQL database. When you fetch the list of databases, you might see multiple databases based on the number of plugins configured in Developer Hub. You can migrate the data from an RHDH instance hosted on a local PostgreSQL server to an external PostgreSQL service, such as AWS RDS, Azure database, or Crunchy database. To migrate the data from each RHDH instance, you can use PostgreSQL utilities, such as <a class="link" href="https://www.postgresql.org/docs/current/app-pgdump.html"><code class="literal">pg_dump</code></a> with <a class="link" href="https://www.postgresql.org/docs/current/app-psql.html"><code class="literal">psql</code></a> or <a class="link" href="https://www.pgadmin.org/"><code class="literal">pgAdmin</code></a>.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The following procedure uses a database copy script to do a quick migration.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <a class="link" href="https://www.postgresql.org/docs/current/app-pgdump.html"><code class="literal">pg_dump</code></a> and <a class="link" href="https://www.postgresql.org/docs/current/app-psql.html"><code class="literal">psql</code></a> utilities on your local machine.
					</li><li class="listitem">
						For data export, you have the PGSQL user privileges to make a full dump of local databases.
					</li><li class="listitem">
						For data import, you have the PGSQL admin privileges to create an external database and populate it with database dumps.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure port forwarding for the local PostgreSQL database pod by running the following command on a terminal:
					</p><pre class="programlisting language-terminal">oc port-forward -n &lt;your-namespace&gt; &lt;pgsql-pod-name&gt; &lt;forward-to-port&gt;:&lt;forward-from-port&gt;</pre><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">&lt;pgsql-pod-name&gt;</code> variable denotes the name of a PostgreSQL pod with the format <code class="literal">backstage-psql-&lt;deployment-name&gt;-&lt;_index&gt;</code>.
							</li><li class="listitem">
								The <code class="literal">&lt;forward-to-port&gt;</code> variable denotes the port of your choice to forward PostgreSQL data to.
							</li><li class="listitem"><p class="simpara">
								The <code class="literal">&lt;forward-from-port&gt;</code> variable denotes the local PostgreSQL instance port, such as <code class="literal">5432</code>.
							</p><div class="formalpara"><p class="title"><strong>Example: Configuring port forwarding</strong></p><p>
									
<pre class="programlisting language-terminal">oc port-forward -n developer-hub backstage-psql-developer-hub-0 15432:5432</pre>
								</p></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Make a copy of the following <code class="literal">db_copy.sh</code> script and edit the details based on your configuration:
					</p><pre class="programlisting language-bash">#!/bin/bash

to_host=&lt;db-service-host&gt; <span id="CO8-1"/><span class="callout">1</span>
to_port=5432 <span id="CO8-2"/><span class="callout">2</span>
to_user=postgres <span id="CO8-3"/><span class="callout">3</span>

from_host=127.0.0.1 <span id="CO8-4"/><span class="callout">4</span>
from_port=15432 <span id="CO8-5"/><span class="callout">5</span>
from_user=postgres <span id="CO8-6"/><span class="callout">6</span>

allDB=("backstage_plugin_app" "backstage_plugin_auth" "backstage_plugin_catalog" "backstage_plugin_permission" "backstage_plugin_scaffolder" "backstage_plugin_search") <span id="CO8-7"/><span class="callout">7</span>

for db in ${!allDB[@]};
do
  db=${allDB[$db]}
  echo Copying database: $db
  PGPASSWORD=$TO_PSW psql -h $to_host -p $to_port -U $to_user -c "create database $db;"
  pg_dump -h $from_host -p $from_port -U $from_user -d $db | PGPASSWORD=$TO_PSW psql -h $to_host -p $to_port -U $to_user -d $db
done</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO8-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The destination host name, for example, <code class="literal">&lt;db-instance-name&gt;.rds.amazonaws.com</code>.
							</div></dd><dt><a href="#CO8-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								The destination port, such as <code class="literal">5432</code>.
							</div></dd><dt><a href="#CO8-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								The destination server username, for example, <code class="literal">postgres</code>.
							</div></dd><dt><a href="#CO8-4"><span class="callout">4</span></a> </dt><dd><div class="para">
								The source host name, such as <code class="literal">127.0.0.1</code>.
							</div></dd><dt><a href="#CO8-5"><span class="callout">5</span></a> </dt><dd><div class="para">
								The source port number, such as the <code class="literal">&lt;forward-to-port&gt;</code> variable.
							</div></dd><dt><a href="#CO8-6"><span class="callout">6</span></a> </dt><dd><div class="para">
								The source server username, for example, <code class="literal">postgres</code>.
							</div></dd><dt><a href="#CO8-7"><span class="callout">7</span></a> </dt><dd><div class="para">
								The name of databases to import in double quotes separated by spaces, for example, <code class="literal">("backstage_plugin_app" "backstage_plugin_auth" "backstage_plugin_catalog" "backstage_plugin_permission" "backstage_plugin_scaffolder" "backstage_plugin_search")</code>.
							</div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Create a destination database for copying the data:
					</p><pre class="programlisting language-terminal">/bin/bash TO_PSW=&lt;destination-db-password&gt; /path/to/db_copy.sh <span id="CO9-1"/><span class="callout">1</span></pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO9-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								The <code class="literal">&lt;destination-db-password&gt;</code> variable denotes the password to connect to the destination database.
							</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can stop port forwarding when the copying of the data is complete. For more information about handling large databases and using the compression tools, see the <a class="link" href="https://www.postgresql.org/docs/current/backup-dump.html#BACKUP-DUMP-LARGE">Handling Large Databases</a> section on the PostgreSQL website.
						</p></div></div></li><li class="listitem">
						Reconfigure your <code class="literal">Backstage</code> custom resource (CR). For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.4/html-single/administration_guide_for_red_hat_developer_hub/index#proc-configuring-postgresql-instance-using-operator_admin-rhdh">Configuring an external PostgreSQL instance using the Operator</a>.
					</li><li class="listitem"><p class="simpara">
						Check that the following code is present at the end of your <code class="literal">Backstage</code> CR after reconfiguration:
					</p><pre class="programlisting language-yaml"># ...
spec:
  database:
    enableLocalDb: false
  application:
  # ...
    extraFiles:
      secrets:
        - name: &lt;crt-secret&gt;
          key: postgres-crt.pem # key name as in &lt;crt-secret&gt; Secret
    extraEnvs:
      secrets:
        - name: &lt;cred-secret&gt;
# ...</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Reconfiguring the <code class="literal">Backstage</code> CR deletes the corresponding <code class="literal">StatefulSet</code> and <code class="literal">Pod</code> objects, but does not delete the <code class="literal">PersistenceVolumeClaim</code> object. Use the following command to delete the local <code class="literal">PersistenceVolumeClaim</code> object:
						</p><pre class="programlisting language-terminal">oc -n developer-hub delete pvc &lt;local-psql-pvc-name&gt;</pre><p>
							where, the <code class="literal">&lt;local-psql-pvc-name&gt;</code> variable is in the <code class="literal">data-&lt;psql-pod-name&gt;</code> format.
						</p></div></div></li><li class="listitem">
						Apply the configuration changes.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that your RHDH instance is running with the migrated data and does not contain the local PostgreSQL database by running the following command:
					</p><pre class="programlisting language-terminal">oc get pods -n &lt;your-namespace&gt;</pre></li><li class="listitem"><p class="simpara">
						Check the output for the following details:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">backstage-developer-hub-xxx</code> pod is in running state.
							</li><li class="listitem"><p class="simpara">
								The <code class="literal">backstage-psql-developer-hub-0</code> pod is not available.
							</p><p class="simpara">
								You can also verify these details using the <span class="strong strong"><strong>Topology</strong></span> view in the OpenShift Container Platform web console.
							</p></li></ul></div></li></ol></div></section></section><section class="section" id="proc-configuring-an-rhdh-instance-with-tls-in-kubernetes_admin-rhdh"><div class="titlepage"><div><div><h2 class="title">3. Configuring an RHDH instance with a TLS connection in Kubernetes</h2></div></div></div><p>
			You can configure a RHDH instance with a Transport Layer Security (TLS) connection in a Kubernetes cluster, such as an Azure Red Hat OpenShift (ARO) cluster, any cluster from a supported cloud provider, or your own cluster with proper configuration. Transport Layer Security (TLS) ensures a secure connection for the RHDH instance with other entities, such as third-party applications, or external databases. However, you must use a public Certificate Authority (CA)-signed certificate to configure your Kubernetes cluster.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You have set up an Azure Red Hat OpenShift (ARO) cluster with a public CA-signed certificate. For more information about obtaining CA certificates, refer to your vendor documentation.
				</li><li class="listitem"><p class="simpara">
					You have created a namespace and setup a service account with proper read permissions on resources.
				</p><div class="formalpara"><p class="title"><strong>Example: Kubernetes manifest for role-based access control</strong></p><p>
						
<pre class="programlisting language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: backstage-read-only
rules:
  - apiGroups:
      - '*'
    resources:
      - pods
      - configmaps
      - services
      - deployments
      - replicasets
      - horizontalpodautoscalers
      - ingresses
      - statefulsets
      - limitranges
      - resourcequotas
      - daemonsets
    verbs:
      - get
      - list
      - watch
#...</pre>
					</p></div></li><li class="listitem">
					You have obtained the secret and the service CA certificate associated with your service account.
				</li><li class="listitem"><p class="simpara">
					You have created some resources and added annotations to them so they can be discovered by the Kubernetes plugin. You can apply these Kubernetes annotations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<code class="literal">backstage.io/kubernetes-id</code> to label components
						</li><li class="listitem">
							<code class="literal">backstage.io/kubernetes-namespace</code> to label namespaces
						</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Enable the Kubernetes plugins in the <code class="literal">dynamic-plugins-rhdh.yaml</code> file:
				</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes-backend-dynamic
        disabled: false <span id="CO10-1"/><span class="callout">1</span>
      - package: ./dynamic-plugins/dist/backstage-plugin-kubernetes
        disabled: false <span id="CO10-2"/><span class="callout">2</span>
        # ...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO10-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							Set the value to <code class="literal">false</code> to enable the <code class="literal">backstage-plugin-kubernetes-backend-dynamic</code> plugin.
						</div></dd><dt><a href="#CO10-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Set the value to <code class="literal">false</code> to enable the <code class="literal">backstage-plugin-kubernetes</code> plugin.
						</div></dd></dl></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">backstage-plugin-kubernetes</code> plugin is currently in <a class="link" href="https://access.redhat.com/support/offerings/techpreview">Technology Preview</a>. As an alternative, you can use the <code class="literal">./dynamic-plugins/dist/backstage-plugin-topology-dynamic</code> plugin, which is Generally Available (GA).
					</p></div></div></li><li class="listitem"><p class="simpara">
					Set the kubernetes cluster details and configure the catalog sync options in the <code class="literal">app-config-rhdh.yaml</code> file:
				</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: app-config-rhdh
data:
  "app-config-rhdh.yaml": |
  # ...
  catalog:
    rules:
      - allow: [Component, System, API, Resource, Location]
    providers:
      kubernetes:
        openshift:
          cluster: openshift
          processor:
            namespaceOverride: default
            defaultOwner: guests
          schedule:
            frequency:
              seconds: 30
            timeout:
              seconds: 5
  kubernetes:
    serviceLocatorMethod:
      type: 'multiTenant'
    clusterLocatorMethods:
      - type: 'config'
        clusters:
          - url: &lt;target-cluster-api-server-url&gt; <span id="CO11-1"/><span class="callout">1</span>
            name: openshift
            authProvider: 'serviceAccount'
            skipTLSVerify: false <span id="CO11-2"/><span class="callout">2</span>
            skipMetricsLookup: true
            dashboardUrl: &lt;target-cluster-console-url&gt; <span id="CO11-3"/><span class="callout">3</span>
            dashboardApp: openshift
            serviceAccountToken: ${K8S_SERVICE_ACCOUNT_TOKEN} <span id="CO11-4"/><span class="callout">4</span>
            caData: ${K8S_CONFIG_CA_DATA} <span id="CO11-5"/><span class="callout">5</span>
            # ...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO11-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The base URL to the Kubernetes control plane. You can run the <code class="literal">kubectl cluster-info</code> command to get the base URL.
						</div></dd><dt><a href="#CO11-2"><span class="callout">2</span></a> </dt><dd><div class="para">
							Set the value of this parameter to <code class="literal">false</code> to enable the verification of the TLS certificate.
						</div></dd><dt><a href="#CO11-3"><span class="callout">3</span></a> </dt><dd><div class="para">
							Optional: The link to the Kubernetes dashboard managing the ARO cluster.
						</div></dd><dt><a href="#CO11-4"><span class="callout">4</span></a> </dt><dd><div class="para">
							Optional: Pass the service account token using a <code class="literal">K8S_SERVICE_ACCOUNT_TOKEN</code> environment variable that you can define in your <code class="literal">secrets-rhdh</code> secret.
						</div></dd><dt><a href="#CO11-5"><span class="callout">5</span></a> </dt><dd><div class="para">
							Pass the CA data using a <code class="literal">K8S_CONFIG_CA_DATA</code> environment variable that you can define in your <code class="literal">secrets-rhdh</code> secret.
						</div></dd></dl></div></li><li class="listitem">
					Save the configuration changes.
				</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Run the RHDH application to import your catalog:
				</p><pre class="programlisting language-terminal">kubectl -n rhdh-operator get pods -w</pre></li><li class="listitem">
					Verify that the pod log shows no errors for your configuration.
				</li><li class="listitem">
					Go to <span class="strong strong"><strong>Catalog</strong></span> and check the component page in the Developer Hub instance to verify the cluster connection and the presence of your created resources.
				</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				If you encounter connection errors, such as certificate issues or permissions, check the message box in the component page or view the logs of the pod.
			</p></div></div></section><section class="section" id="assembly-running-rhdh-behind-a-proxy"><div class="titlepage"><div><div><h2 class="title">4. Running the RHDH application behind a corporate proxy</h2></div></div></div><p>
			You can run the RHDH application behind a corporate proxy by setting any of the following environment variables before starting the application:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">HTTP_PROXY</code>: Denotes the proxy to use for HTTP requests.
				</li><li class="listitem">
					<code class="literal">HTTPS_PROXY</code>: Denotes the proxy to use for HTTPS requests.
				</li></ul></div><p>
			Additionally, set the <code class="literal">NO_PROXY</code> environment variable to bypass the proxy for certain domains. The variable value is a comma-separated list of hostnames or IP addresses that can be accessed without the proxy, even if one is specified.
		</p><section class="section" id="understanding-no-proxy"><div class="titlepage"><div><div><h3 class="title">4.1. Understanding the <code class="literal">NO_PROXY</code> exclusion rules</h3></div></div></div><p>
				<code class="literal">NO_PROXY</code> is a comma or space-separated list of hostnames or IP addresses, with optional port numbers. If the input URL matches any of the entries listed in <code class="literal">NO_PROXY</code>, a direct request fetches that URL, for example, bypassing the proxy settings.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The default value for <code class="literal">NO_PROXY</code> in RHDH is <code class="literal">localhost,127.0.0.1</code>. If you want to override it, include at least <code class="literal">localhost</code> or <code class="literal">localhost:7007</code> in the list. Otherwise, the RHDH backend might fail.
				</p></div></div><p>
				Matching follows the rules below:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">NO_PROXY=*</code> will bypass the proxy for all requests.
					</li><li class="listitem">
						Space and commas might separate the entries in the <code class="literal">NO_PROXY</code> list. For example, <code class="literal">NO_PROXY="localhost,example.com"</code>, or <code class="literal">NO_PROXY="localhost example.com"</code>, or <code class="literal">NO_PROXY="localhost, example.com"</code> would have the same effect.
					</li><li class="listitem">
						If <code class="literal">NO_PROXY</code> contains no entries, configuring the <code class="literal">HTTP(S)_PROXY</code> settings makes the backend send all requests through the proxy.
					</li><li class="listitem">
						The backend does not perform a DNS lookup to determine if a request should bypass the proxy or not. For example, if DNS resolves <code class="literal">example.com</code> to <code class="literal">1.2.3.4</code>, setting <code class="literal">NO_PROXY=1.2.3.4</code> has no effect on requests sent to <code class="literal">example.com</code>. Only requests sent to the IP address <code class="literal">1.2.3.4</code> bypass the proxy.
					</li><li class="listitem">
						If you add a port after the hostname or IP address, the request must match both the host/IP and port to bypass the proxy. For example, <code class="literal">NO_PROXY=example.com:1234</code> would bypass the proxy for requests to <code class="literal">http(s)://example.com:1234</code>, but not for requests on other ports, like <code class="literal">http(s)://example.com</code>.
					</li><li class="listitem">
						If you do not specify a port after the hostname or IP address, all requests to that host/IP address will bypass the proxy regardless of the port. For example, <code class="literal">NO_PROXY=localhost</code> would bypass the proxy for requests sent to URLs like <code class="literal">http(s)://localhost:7077</code> and <code class="literal">http(s)://localhost:8888</code>.
					</li><li class="listitem">
						IP Address blocks in CIDR notation will not work. So setting <code class="literal">NO_PROXY=10.11.0.0/16</code> will not have any effect, even if the backend sends a request to an IP address in that block.
					</li><li class="listitem">
						Supports only IPv4 addresses. IPv6 addresses like <code class="literal">::1</code> will not work.
					</li><li class="listitem">
						Generally, the proxy is only bypassed if the hostname is an exact match for an entry in the <code class="literal">NO_PROXY</code> list. The only exceptions are entries that start with a dot (<code class="literal">.</code>) or with a wildcard (<code class="literal">*</code>). In such a case, bypass the proxy if the hostname ends with the entry.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					List the domain and the wildcard domain if you want to exclude a given domain and all its subdomains. For example, you would set <code class="literal">NO_PROXY=example.com,.example.com</code> to bypass the proxy for requests sent to <code class="literal">http(s)://example.com</code> and <code class="literal">http(s)://subdomain.example.com</code>.
				</p></div></div></section><section class="section" id="proc-configuring-proxy-in-helm-deployment_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">4.2. Configuring proxy information in Helm deployment</h3></div></div></div><p>
				For Helm-based deployment, either a developer or a cluster administrator with permissions to create resources in the cluster can configure the proxy variables in a <code class="literal">values.yaml</code> Helm configuration file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the Red Hat Developer Hub application.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Set the proxy information in your Helm configuration file:
					</p><pre class="programlisting language-yaml">upstream:
  backstage:
    extraEnvVars:
      - name: HTTP_PROXY
        value: '&lt;http_proxy_url&gt;'
      - name: HTTPS_PROXY
        value: '&lt;https_proxy_url&gt;'
      - name: NO_PROXY
        value: '&lt;no_proxy_settings&gt;'</pre><p class="simpara">
						Where,
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;http_proxy_url&gt;</code></span></dt><dd>
									Denotes a variable that you must replace with the HTTP proxy URL.
								</dd><dt><span class="term"><code class="literal">&lt;https_proxy_url&gt;</code></span></dt><dd>
									Denotes a variable that you must replace with the HTTPS proxy URL.
								</dd><dt><span class="term"><code class="literal">&lt;no_proxy_settings&gt;</code></span></dt><dd><p class="simpara">
									Denotes a variable that you must replace with comma-separated URLs, which you want to exclude from proxying, for example, <code class="literal">foo.com,baz.com</code>.
								</p><div class="formalpara"><p class="title"><strong>Example: Setting proxy variables using Helm Chart</strong></p><p>
										
<pre class="programlisting language-yaml">upstream:
  backstage:
    extraEnvVars:
      - name: HTTP_PROXY
        value: 'http://10.10.10.105:3128'
      - name: HTTPS_PROXY
        value: 'http://10.10.10.106:3128'
      - name: NO_PROXY
        value: 'localhost,example.org'</pre>
									</p></div></dd></dl></div></li><li class="listitem">
						Save the configuration changes.
					</li></ol></div></section><section class="section" id="proc-configuring-proxy-in-operator-deployment_admin-rhdh"><div class="titlepage"><div><div><h3 class="title">4.3. Configuring proxy information in Operator deployment</h3></div></div></div><p>
				For Operator-based deployment, the approach you use for proxy configuration is based on your role:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						As a cluster administrator with access to the Operator namespace, you can configure the proxy variables in the Operator’s default ConfigMap file. This configuration applies the proxy settings to all the users of the Operator.
					</li><li class="listitem">
						As a developer, you can configure the proxy variables in a custom resource (CR) file. This configuration applies the proxy settings to the RHDH application created from that CR.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the Red Hat Developer Hub application.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Perform one of the following steps based on your role:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								As an administrator, set the proxy information in the Operator’s default ConfigMap file:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
										Search for a ConfigMap file named <code class="literal">backstage-default-config</code> in the default namespace <code class="literal">rhdh-operator</code> and open it.
									</li><li class="listitem">
										Find the <code class="literal">deployment.yaml</code> key.
									</li><li class="listitem"><p class="simpara">
										Set the value of the <code class="literal">HTTP_PROXY</code>, <code class="literal">HTTPS_PROXY</code>, and <code class="literal">NO_PROXY</code> environment variables in the <code class="literal">Deployment</code> spec as shown in the following example:
									</p><div class="formalpara"><p class="title"><strong>Example: Setting proxy variables in a ConfigMap file</strong></p><p>
											
<pre class="programlisting language-yaml"># Other fields omitted
  deployment.yaml: |-
    apiVersion: apps/v1
    kind: Deployment
    spec:
      template:
        spec:
          # Other fields omitted
          initContainers:
            - name: install-dynamic-plugins
              # command omitted
              env:
                - name: NPM_CONFIG_USERCONFIG
                  value: /opt/app-root/src/.npmrc.dynamic-plugins
                - name: HTTP_PROXY
                  value: 'http://10.10.10.105:3128'
                - name: HTTPS_PROXY
                  value: 'http://10.10.10.106:3128'
                - name: NO_PROXY
                  value: 'localhost,example.org'
              # Other fields omitted
          containers:
            - name: backstage-backend
              # Other fields omitted
              env:
                - name: APP_CONFIG_backend_listen_port
                  value: "7007"
                - name: HTTP_PROXY
                  value: 'http://10.10.10.105:3128'
                - name: HTTPS_PROXY
                  value: 'http://10.10.10.106:3128'
                - name: NO_PROXY
                  value: 'localhost,example.org'</pre>
										</p></div></li></ol></div></li><li class="listitem"><p class="simpara">
								As a developer, set the proxy information in your custom resource (CR) file as shown in the following example:
							</p><div class="formalpara"><p class="title"><strong>Example: Setting proxy variables in a CR file</strong></p><p>
									
<pre class="programlisting language-yaml">spec:
  # Other fields omitted
  application:
    extraEnvs:
      envs:
        - name: HTTP_PROXY
          value: 'http://10.10.10.105:3128'
        - name: HTTPS_PROXY
          value: 'http://10.10.10.106:3128'
        - name: NO_PROXY
          value: 'localhost,example.org'</pre>
								</p></div></li></ul></div></li><li class="listitem">
						Save the configuration changes.
					</li></ol></div></section></section><section class="section" id="assembly-rhdh-integration-aws"><div class="titlepage"><div><div><h2 class="title">5. Red Hat Developer Hub integration with Amazon Web Services (AWS)</h2></div></div></div><p>
			You can integrate your Red Hat Developer Hub application with Amazon Web Services (AWS), which can help you streamline your workflows within the AWS ecosystem. Integrating the Developer Hub resources with AWS provides access to a comprehensive suite of tools, services, and solutions.
		</p><p>
			The integration with AWS requires the deployment of Developer Hub in Elastic Kubernetes Service (EKS) using one of the following methods:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The Helm chart
				</li><li class="listitem">
					The Red Hat Developer Hub Operator
				</li></ul></div></section><section class="section" id="assembly-admin-templates"><div class="titlepage"><div><div><h2 class="title">6. Managing templates</h2></div></div></div><p>
			A template is a form composed of different UI fields that is defined in a YAML file. Templates include <span class="emphasis"><em>actions</em></span>, which are steps that are executed in sequential order and can be executed conditionally.
		</p><p>
			You can use templates to easily create Red Hat Developer Hub components, and then publish these components to different locations, such as the Red Hat Developer Hub software catalog, or repositories in GitHub or GitLab.
		</p><section class="section" id="proc-creating-templates_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">6.1. Creating a template by using the Template Editor</h3></div></div></div><p>
				You can create a template by using the Template Editor.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Access the Template Editor by using one of the following options:
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/rhdh/template-editor.png" alt="Template Editor"/></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Open the URL <code class="literal">https://&lt;rhdh_url&gt;/create/edit</code> for your Red Hat Developer Hub instance.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Create…​</strong></span> in the navigation menu of the Red Hat Developer Hub console, then click the overflow menu button and select <span class="strong strong"><strong>Template editor</strong></span>.
							</li></ul></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Edit Template Form</strong></span>.
					</li><li class="listitem">
						Optional: Modify the YAML definition for the parameters of your template. For more information about these parameters, see <a class="xref" href="#ref-creating-templates_assembly-admin-templates" title="6.2. Creating a template as a YAML file">Section 6.2, “Creating a template as a YAML file”</a>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Name *</strong></span> field, enter a unique name for your template.
					</li><li class="listitem">
						From the <span class="strong strong"><strong>Owner</strong></span> drop-down menu, choose an owner for the template.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Next</strong></span>.
					</li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Repository Location</strong></span> view, enter the following information about the hosted repository that you want to publish the template to:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Select an available <span class="strong strong"><strong>Host</strong></span> from the drop-down menu.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									Available hosts are defined in the YAML parameters by the <code class="literal">allowedHosts</code> field:
								</p><div class="formalpara"><p class="title"><strong>Example YAML</strong></p><p>
										
<pre class="programlisting language-yaml"># ...
        ui:options:
          allowedHosts:
            - github.com
# ...</pre>
									</p></div></div></div></li><li class="listitem">
								In the <span class="strong strong"><strong>Owner *</strong></span> field, enter an organization, user or project that the hosted repository belongs to.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Repository *</strong></span> field, enter the name of the hosted repository.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Review</strong></span>.
							</li></ol></div></li><li class="listitem">
						Review the information for accuracy, then click <span class="strong strong"><strong>Create</strong></span>.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click the <span class="strong strong"><strong>Catalog</strong></span> tab in the navigation panel.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Kind</strong></span> drop-down menu, select <span class="strong strong"><strong>Template</strong></span>.
					</li><li class="listitem">
						Confirm that your template is shown in the list of existing templates.
					</li></ol></div></section><section class="section" id="ref-creating-templates_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">6.2. Creating a template as a YAML file</h3></div></div></div><p>
				You can create a template by defining a <code class="literal">Template</code> object as a YAML file.
			</p><p>
				The <code class="literal">Template</code> object describes the template and its metadata. It also contains required input variables and a list of actions that are executed by the scaffolding service.
			</p><div class="formalpara"><p class="title"><strong><code class="literal">Template</code> object example</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: template-name <span id="CO12-1"/><span class="callout">1</span>
  title: Example template <span id="CO12-2"/><span class="callout">2</span>
  description: An example template for v1beta3 scaffolder. <span id="CO12-3"/><span class="callout">3</span>
spec:
  owner: backstage/techdocs-core <span id="CO12-4"/><span class="callout">4</span>
  type: service <span id="CO12-5"/><span class="callout">5</span>
  parameters: <span id="CO12-6"/><span class="callout">6</span>
    - title: Fill in some steps
      required:
        - name
      properties:
        name:
          title: Name
          type: string
          description: Unique name of the component
        owner:
          title: Owner
          type: string
          description: Owner of the component
    - title: Choose a location
      required:
        - repoUrl
      properties:
        repoUrl:
          title: Repository Location
          type: string
  steps: <span id="CO12-7"/><span class="callout">7</span>
    - id: fetch-base
      name: Fetch Base
      action: fetch:template
      # ...
  output: <span id="CO12-8"/><span class="callout">8</span>
    links:
      - title: Repository <span id="CO12-9"/><span class="callout">9</span>
        url: ${{ steps['publish'].output.remoteUrl }}
      - title: Open in catalog <span id="CO12-10"/><span class="callout">10</span>
        icon: catalog
        entityRef: ${{ steps['register'].output.entityRef }}
# ...</pre>
				</p></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO12-1"><span class="callout">1</span></a> </dt><dd><div class="para">
						Specify a name for the template.
					</div></dd><dt><a href="#CO12-2"><span class="callout">2</span></a> </dt><dd><div class="para">
						Specify a title for the template. This is the title that is visible on the template tile in the <span class="strong strong"><strong>Create…​</strong></span> view.
					</div></dd><dt><a href="#CO12-3"><span class="callout">3</span></a> </dt><dd><div class="para">
						Specify a description for the template. This is the description that is visible on the template tile in the <span class="strong strong"><strong>Create…​</strong></span> view.
					</div></dd><dt><a href="#CO12-4"><span class="callout">4</span></a> </dt><dd><div class="para">
						Specify the ownership of the template. The <code class="literal">owner</code> field provides information about who is responsible for maintaining or overseeing the template within the system or organization. In the provided example, the <code class="literal">owner</code> field is set to <code class="literal">backstage/techdocs-core</code>. This means that this template belongs to the <code class="literal">techdocs-core</code> project in the <code class="literal">backstage</code> namespace.
					</div></dd><dt><a href="#CO12-5"><span class="callout">5</span></a> </dt><dd><div class="para">
						Specify the component type. Any string value is accepted for this required field, but your organization should establish a proper taxonomy for these. Red Hat Developer Hub instances may read this field and behave differently depending on its value. For example, a <code class="literal">website</code> type component may present tooling in the Red Hat Developer Hub interface that is specific to just websites.
					</div><p>
						The following values are common for this field:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">service</code></span></dt><dd>
									A backend service, typically exposing an API.
								</dd><dt><span class="term"><code class="literal">website</code></span></dt><dd>
									A website.
								</dd><dt><span class="term"><code class="literal">library</code></span></dt><dd>
									A software library, such as an npm module or a Java library.
								</dd></dl></div></dd><dt><a href="#CO12-6"><span class="callout">6</span></a> </dt><dd><div class="para">
						Use the <code class="literal">parameters</code> section to specify parameters for user input that are shown in a form view when a user creates a component by using the template in the Red Hat Developer Hub console. Each <code class="literal">parameters</code> subsection, defined by a title and properties, creates a new form page with that definition.
					</div></dd><dt><a href="#CO12-7"><span class="callout">7</span></a> </dt><dd><div class="para">
						Use the <code class="literal">steps</code> section to specify steps that are executed in the backend. These steps must be defined by using a unique step ID, a name, and an action. You can view actions that are available on your Red Hat Developer Hub instance by visiting the URL <code class="literal">https://&lt;rhdh_url&gt;/create/actions</code>.
					</div></dd><dt><a href="#CO12-8"><span class="callout">8</span></a> </dt><dd><div class="para">
						Use the <code class="literal">output</code> section to specify the structure of output data that is created when the template is used. The <code class="literal">output</code> section, particularly the <code class="literal">links</code> subsection, provides valuable references and URLs that users can utilize to access and interact with components that are created from the template.
					</div></dd><dt><a href="#CO12-9"><span class="callout">9</span></a> </dt><dd><div class="para">
						Provides a reference or URL to the repository associated with the generated component.
					</div></dd><dt><a href="#CO12-10"><span class="callout">10</span></a> </dt><dd><div class="para">
						Provides a reference or URL that allows users to open the generated component in a catalog or directory where various components are listed.
					</div></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://backstage.io/docs/features/software-templates/writing-templates">Backstage documentation - Writing Templates</a>
					</li><li class="listitem">
						<a class="link" href="https://backstage.io/docs/features/software-templates/builtin-actions">Backstage documentation - Builtin actions</a>
					</li><li class="listitem">
						<a class="link" href="https://backstage.io/docs/features/software-templates/writing-custom-actions">Backstage documentation - Writing Custom Actions</a>
					</li></ul></div></section><section class="section" id="proc-adding-templates_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">6.3. Importing an existing template to Red Hat Developer Hub</h3></div></div></div><p>
				You can add an existing template to your Red Hat Developer Hub instance by using the Catalog Processor.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created a directory or repository that contains at least one template YAML file.
					</li><li class="listitem">
						If you want to use a template that is stored in a repository such as GitHub or GitLab, you must configure a Red Hat Developer Hub integration for your provider.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						In the <code class="literal">app-config.yaml</code> configuration file, modify the <code class="literal">catalog.rules</code> section to include a rule for templates, and configure the <code class="literal">catalog.locations</code> section to point to the template that you want to add, as shown in the following example:
					</p><pre class="programlisting language-yaml"># ...
catalog:
  rules:
    - allow: [Template] <span id="CO13-1"/><span class="callout">1</span>
  locations:
    - type: url <span id="CO13-2"/><span class="callout">2</span>
      target: https://&lt;repository_url&gt;/example-template.yaml <span id="CO13-3"/><span class="callout">3</span>
# ...</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO13-1"><span class="callout">1</span></a> </dt><dd><div class="para">
								To allow new templates to be added to the catalog, you must add a <code class="literal">Template</code> rule.
							</div></dd><dt><a href="#CO13-2"><span class="callout">2</span></a> </dt><dd><div class="para">
								If you are importing templates from a repository, such as GitHub or GitLab, use the <code class="literal">url</code> type.
							</div></dd><dt><a href="#CO13-3"><span class="callout">3</span></a> </dt><dd><div class="para">
								Specify the URL for the template.
							</div></dd></dl></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Click the <span class="strong strong"><strong>Catalog</strong></span> tab in the navigation panel.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Kind</strong></span> drop-down menu, select <span class="strong strong"><strong>Template</strong></span>.
					</li><li class="listitem">
						Confirm that your template is shown in the list of existing templates.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.redhat.com/documentation/en-us/red_hat_developer_hub/1.4/html-single/authentication/index#assembly-auth-provider-github">Enabling the GitHub authentication provider</a>
					</li></ul></div></section></section><section class="section" id="assembly-techdocs-plugin_assembly-admin-templates"><div class="titlepage"><div><div><h2 class="title">7. Configuring the TechDocs plugin in Red Hat Developer Hub</h2></div></div></div><p>
			The Red Hat Developer Hub TechDocs plugin helps your organization create, find, and use documentation in a central location and in a standardized way. For example:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Docs-like-code approach</span></dt><dd>
						Write your technical documentation in Markdown files that are stored inside your project repository along with your code.
					</dd><dt><span class="term">Documentation site generation</span></dt><dd>
						Use MkDocs to create a full-featured, Markdown-based, static HTML site for your documentation that is rendered centrally in Developer Hub.
					</dd><dt><span class="term">Documentation site metadata and integrations</span></dt><dd>
						See additional metadata about the documentation site alongside the static documentation, such as the date of the last update, the site owner, top contributors, open GitHub issues, Slack support channels, and Stack Overflow Enterprise tags.
					</dd><dt><span class="term">Built-in navigation and search</span></dt><dd>
						Find the information that you want from a document more quickly and easily.
					</dd><dt><span class="term">Add-ons</span></dt><dd>
						Customize your TechDocs experience with Add-ons to address higher-order documentation needs.
					</dd></dl></div><p>
			The TechDocs plugin is preinstalled and enabled on a Developer Hub instance by default. You can disable or enable the TechDocs plugin, and change other parameters, by configuring the Red Hat Developer Hub Helm chart or the Red Hat Developer Hub Operator config map.
		</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
				Red Hat Developer Hub includes a built-in TechDocs builder that generates static HTML documentation from your codebase. However, the default basic setup of the local builder is not intended for production.
			</p></div></div><p>
			You can use a CI/CD pipeline with the repository that has a dedicated job to generate docs for TechDocs. The generated static files are stored in OpenShift Data Foundation or in a cloud storage solution of your choice and published to a static HTML documentation site.
		</p><p>
			After you configure OpenShift Data Foundation to store the files that TechDocs generates, you can configure the TechDocs plugin to use the OpenShift Data Foundation for cloud storage.
		</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_developer_hub/1.4/html-single/configuring_plugins_in_red_hat_developer_hub/index">Configuring plugins in Red Hat Developer Hub</a>.
				</li></ul></div><section class="section" id="con-techdocs-configure-storage_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">7.1. Configuring storage for TechDocs files</h3></div></div></div><p>
				The TechDocs publisher stores generated files in local storage or in cloud storage, such as OpenShift Data Foundation, Google GCS, AWS S3, or Azure Blob Storage.
			</p><section class="section" id="proc-techdocs-using-odf-storage_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.1.1. Using OpenShift Data Foundation for file storage</h4></div></div></div><p>
					You can configure OpenShift Data Foundation to store the files that TechDocs generates instead of relying on other cloud storage solutions.
				</p><p>
					OpenShift Data Foundation provides an <code class="literal">ObjectBucketClaim</code> custom resource (CR) that you can use to request an S3 compatible bucket backend. You must install the OpenShift Data Foundation Operator to use this feature.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An OpenShift Container Platform administrator has installed the OpenShift Data Foundation Operator in Red Hat OpenShift Container Platform. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.15/html/deploying_openshift_data_foundation_using_amazon_web_services/deploy-using-dynamic-storage-devices-aws#installing-openshift-data-foundation-operator-using-the-operator-hub_cloud-storage">OpenShift Container Platform - Installing Red Hat OpenShift Data Foundation Operator</a>.
						</li><li class="listitem">
							An OpenShift Container Platform administrator has created an OpenShift Data Foundation cluster and configured the <code class="literal">StorageSystem</code> schema. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/latest/html/deploying_openshift_data_foundation_using_amazon_web_services/deploy-using-dynamic-storage-devices-aws#creating-an-openshift-data-foundation-service_cloud-storage">OpenShift Container Platform - Creating an OpenShift Data Foundation cluster</a>.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Create an <code class="literal">ObjectBucketClaim</code> CR where the generated TechDocs files are stored. For example:
						</p><pre class="programlisting language-yaml">apiVersion: objectbucket.io/v1alpha1
kind: ObjectBucketClaim
metadata:
  name: &lt;rhdh_bucket_claim_name&gt;
spec:
  generateBucketName: &lt;rhdh_bucket_claim_name&gt;
  storageClassName: openshift-storage.noobaa.io</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Creating the Developer Hub <code class="literal">ObjectBucketClaim</code> CR automatically creates both the Developer Hub <code class="literal">ObjectBucketClaim</code> config map and secret. The config map and secret have the same name as the <code class="literal">ObjetBucketClaim</code> CR.
							</p></div></div></li></ul></div><p>
					After you create the <code class="literal">ObjectBucketClaim</code> CR, you can use the information stored in the config map and secret to make the information accessible to the Developer Hub container as environment variables. Depending on the method that you used to install Developer Hub, you add the access information to either the Red Hat Developer Hub Helm chart or Operator configuration.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							For more information about the Object Bucket Claim, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openshift_data_foundation/4.12/html/managing_hybrid_and_multicloud_resources/object-bucket-claim#doc-wrapper">OpenShift Container Platform - Object Bucket Claim</a>.
						</li></ul></div></section><section class="section" id="proc-techdocs-configure-odf-helm_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.1.2. Making object storage accessible to containers by using the Helm chart</h4></div></div></div><p>
					Creating a <code class="literal">ObjectBucketClaim</code> custom resource (CR) automatically generates both the Developer Hub <code class="literal">ObjectBucketClaim</code> config map and secret. The config map and secret contain <code class="literal">ObjectBucket</code> access information. Adding the access information to the Helm chart configuration makes it accessible to the Developer Hub container by adding the following environment variables to the container:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">BUCKET_NAME</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_HOST</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_PORT</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_REGION</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_SUBREGION</code>
						</li><li class="listitem">
							<code class="literal">AWS_ACCESS_KEY_ID</code>
						</li><li class="listitem">
							<code class="literal">AWS_SECRET_ACCESS_KEY</code>
						</li></ul></div><p>
					These variables are then used in the TechDocs plugin configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed Red Hat Developer Hub on OpenShift Container Platform using the Helm chart.
						</li><li class="listitem">
							You have created an <code class="literal">ObjectBucketClaim</code> CR for storing files generated by TechDocs. For more information see <a class="link" href="#proc-techdocs-using-odf-storage_assembly-admin-templates" title="7.1.1. Using OpenShift Data Foundation for file storage">Using OpenShift Data Foundation for file storage</a>
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In the <code class="literal">upstream.backstage</code> key in the Helm chart values, enter the name of the Developer Hub <code class="literal">ObjectBucketClaim</code> secret as the value for the <code class="literal">extraEnvVarsSecrets</code> field and the <code class="literal">extraEnvVarsCM</code> field. For example:
						</p><pre class="programlisting language-yaml">upstream:
  backstage:
    extraEnvVarsSecrets:
      - &lt;rhdh_bucket_claim_name&gt;
    extraEnvVarsCM:
      - &lt;rhdh_bucket_claim_name&gt;</pre></li></ul></div><section class="section" id="ref-techdocs-example-config-plugin-helm_assembly-admin-templates"><div class="titlepage"><div><div><h5 class="title">7.1.2.1. Example TechDocs Plugin configuration for the Helm chart</h5></div></div></div><p>
						The following example shows a Developer Hub Helm chart configuration for the TechDocs plugin:
					</p><pre class="programlisting language-yaml">global:
  dynamic:
    includes:
      - 'dynamic-plugins.default.yaml'
  plugins:
    - disabled: false
      package: ./dynamic-plugins/dist/backstage-plugin-techdocs-backend-dynamic
      pluginConfig:
        techdocs:
          builder: external
          generator:
            runIn: local
          publisher:
            awsS3:
              bucketName: '${BUCKET_NAME}'
              credentials:
                accessKeyId: '${AWS_ACCESS_KEY_ID}'
                secretAccessKey: '${AWS_SECRET_ACCESS_KEY}'
              endpoint: 'https://${BUCKET_HOST}'
              region: '${BUCKET_REGION}'
              s3ForcePathStyle: true
            type: awsS3</pre></section></section><section class="section" id="proc-techdocs-configure-odf-operator_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.1.3. Making object storage accessible to containers by using the Operator</h4></div></div></div><p>
					Creating a <code class="literal">ObjectBucketClaim</code> Custom Resource (CR) automatically generates both the Developer Hub <code class="literal">ObjectBucketClaim</code> config map and secret. The config map and secret contain <code class="literal">ObjectBucket</code> access information. Adding the access information to the Operator configuration makes it accessible to the Developer Hub container by adding the following environment variables to the container:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">BUCKET_NAME</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_HOST</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_PORT</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_REGION</code>
						</li><li class="listitem">
							<code class="literal">BUCKET_SUBREGION</code>
						</li><li class="listitem">
							<code class="literal">AWS_ACCESS_KEY_ID</code>
						</li><li class="listitem">
							<code class="literal">AWS_SECRET_ACCESS_KEY</code>
						</li></ul></div><p>
					These variables are then used in the TechDocs plugin configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed Red Hat Developer Hub on OpenShift Container Platform using the Operator.
						</li><li class="listitem">
							You have created an <code class="literal">ObjectBucketClaim</code> CR for storing files generated by TechDocs.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							In the Developer Hub <code class="literal">Backstage</code> CR, enter the name of the Developer Hub <code class="literal">ObjectBucketClaim</code> config map as the value for the <code class="literal">spec.application.extraEnvs.configMaps</code> field and enter the Developer Hub <code class="literal">ObjectBucketClaim</code> secret name as the value for the <code class="literal">spec.application.extraEnvs.secrets</code> field. For example:
						</p><pre class="programlisting language-yaml">apiVersion: objectbucket.io/v1alpha1
kind: Backstage
metadata:
 name: &lt;name&gt;
spec:
  application:
    extraEnvs:
      configMaps:
        - name: &lt;rhdh_bucket_claim_name&gt;
      secrets:
        - name: &lt;rhdh_bucket_claim_name&gt;</pre></li></ul></div><section class="section" id="ref-techdocs-example-config-plugin-operator_assembly-admin-templates"><div class="titlepage"><div><div><h5 class="title">7.1.3.1. Example TechDocs Plugin configuration for the Operator</h5></div></div></div><p>
						The following example shows a Red Hat Developer Hub Operator config map configuration for the TechDocs plugin:
					</p><pre class="programlisting language-yaml">kind: ConfigMap
apiVersion: v1
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - disabled: false
        package: ./dynamic-plugins/dist/backstage-plugin-techdocs-backend-dynamic
        pluginConfig:
          techdocs:
            builder: external
            generator:
              runIn: local
            publisher:
              awsS3:
                bucketName: '${BUCKET_NAME}'
                credentials:
                  accessKeyId: '${AWS_ACCESS_KEY_ID}'
                  secretAccessKey: '${AWS_SECRET_ACCESS_KEY}'
                endpoint: 'https://${BUCKET_HOST}'
                region: '${BUCKET_REGION}'
                s3ForcePathStyle: true
              type: awsS3</pre></section></section></section><section class="section" id="con-techdocs-config-cicd_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">7.2. Configuring CI/CD to generate and publish TechDocs sites</h3></div></div></div><p>
				TechDocs reads the static generated documentation files from a cloud storage bucket, such as OpenShift Data Foundation. The documentation site is generated on the CI/CD workflow associated with the repository containing the documentation files. You can generate docs on CI and publish to a cloud storage using the <code class="literal">techdocs-cli</code> CLI tool.
			</p><p>
				You can use the following example to create a script for TechDocs publication:
			</p><pre class="programlisting language-shell"># Prepare
REPOSITORY_URL='https://github.com/org/repo'
git clone $REPOSITORY_URL
cd repo

# Install @techdocs/cli, mkdocs and mkdocs plugins
npm install -g @techdocs/cli
pip install "mkdocs-techdocs-core==1.*"

# Generate
techdocs-cli generate --no-docker

# Publish
techdocs-cli publish --publisher-type awsS3 --storage-name &lt;bucket/container&gt; --entity &lt;Namespace/Kind/Name&gt;</pre><p>
				The TechDocs workflow starts the CI when a user makes changes in the repository containing the documentation files. You can configure the workflow to start only when files inside the <code class="literal">docs/</code> directory or <code class="literal">mkdocs.yml</code> are changed.
			</p><section class="section" id="proc-techdocs-config-cicd-prep-repo_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.2.1. Preparing your repository for CI</h4></div></div></div><p>
					The first step on the CI is to clone your documentation source repository in a working directory.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To clone your documentation source repository in a working directory, enter the following command:
						</p><pre class="programlisting language-terminal">git clone &lt;https://path/to/docs-repository/&gt;</pre></li></ul></div></section><section class="section" id="proc-techdocs-generate-site_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.2.2. Generating the TechDocs site</h4></div></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To configure CI/CD to generate your techdocs, complete the following steps:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the <code class="literal">npx</code> package to run <code class="literal">techdocs-cli</code> using the following command:
						</p><pre class="screen">npm install -g npx</pre></li><li class="listitem"><p class="simpara">
							Install the <code class="literal">techdocs-cli</code> tool using the following command:
						</p><pre class="screen">npm install -g @techdocs/cli</pre></li><li class="listitem"><p class="simpara">
							Install the <code class="literal">mkdocs</code> plugins using the following command:
						</p><pre class="screen">pip install "mkdocs-techdocs-core==1.*"</pre></li><li class="listitem"><p class="simpara">
							Generate your techdocs site using the following command:
						</p><pre class="programlisting language-terminal">npx @techdocs/cli generate --no-docker --source-dir &lt;path_to_repo&gt; --output-dir ./site</pre><p class="simpara">
							Where <code class="literal">&lt;path_to_repo&gt;</code> is the location in the file path that you used to clone your repository.
						</p></li></ol></div></section><section class="section" id="proc-techdocs-publish-site_assembly-admin-templates"><div class="titlepage"><div><div><h4 class="title">7.2.3. Publishing the TechDocs site</h4></div></div></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
						To publish your techdocs site, complete the following steps:
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Set the necessary authentication environment variables for your cloud storage provider.
						</li><li class="listitem"><p class="simpara">
							Publish your techdocs using the following command:
						</p><pre class="programlisting language-terminal">npx @techdocs/cli publish --publisher-type &lt;awsS3|googleGcs&gt; --storage-name &lt;bucket/container&gt; --entity &lt;namespace/kind/name&gt; --directory ./site</pre></li><li class="listitem"><p class="simpara">
							Add a <code class="literal">.github/workflows/techdocs.yml</code> file in your Software Template(s). For example:
						</p><pre class="programlisting language-yaml">name: Publish TechDocs Site

on:
 push:
   branches: [main]
   # You can even set it to run only when TechDocs related files are updated.
   # paths:
   #   - "docs/**"
   #   - "mkdocs.yml"

jobs:
 publish-techdocs-site:
   runs-on: ubuntu-latest

   # The following secrets are required in your CI environment for publishing files to AWS S3.
   # e.g. You can use GitHub Organization secrets to set them for all existing and new repositories.
   env:
     TECHDOCS_S3_BUCKET_NAME: ${{ secrets.TECHDOCS_S3_BUCKET_NAME }}
     AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
     AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
     AWS_REGION: ${{ secrets.AWS_REGION }}
     ENTITY_NAMESPACE: 'default'
     ENTITY_KIND: 'Component'
     ENTITY_NAME: 'my-doc-entity'
     # In a Software template, Scaffolder will replace {{cookiecutter.component_id | jsonify}}
     # with the correct entity name. This is same as metadata.name in the entity's catalog-info.yaml
     # ENTITY_NAME: '{{ cookiecutter.component_id | jsonify }}'

   steps:
     - name: Checkout code
       uses: actions/checkout@v3

     - uses: actions/setup-node@v3
     - uses: actions/setup-python@v4
       with:
         python-version: '3.9'

     - name: Install techdocs-cli
       run: sudo npm install -g @techdocs/cli

     - name: Install mkdocs and mkdocs plugins
       run: python -m pip install mkdocs-techdocs-core==1.*

     - name: Generate docs site
       run: techdocs-cli generate --no-docker --verbose

     - name: Publish docs site
       run: techdocs-cli publish --publisher-type awsS3 --storage-name $TECHDOCS_S3_BUCKET_NAME --entity $ENTITY_NAMESPACE/$ENTITY_KIND/$ENTITY_NAME</pre></li></ol></div></section></section></section><section class="section" id="proc-rhdh-deployment-config_assembly-admin-templates"><div class="titlepage"><div><div><h2 class="title">8. Configuring Red Hat Developer Hub deployment</h2></div></div></div><p>
			The Red Hat Developer Hub operator exposes a <code class="literal">rhdh.redhat.com/v1alpha2</code> API Version of its Custom Resource Definition (CRD). This CRD exposes a generic <code class="literal">spec.deployment.patch</code> field, which gives you full control over the Developer Hub Deployment resource. This field can be a fragment of the standard <code class="literal">apps.Deployment</code> Kubernetes object.
		</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Create a Developer Hub Custom Resource Definition with the following fields:
				</li></ol></div><div class="formalpara"><p class="title"><strong>Example</strong></p><p>
				
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:</pre>
			</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">labels</code></span></dt><dd><p class="simpara">
						Add labels to the Developer Hub pod.
					</p><div class="formalpara"><p class="title"><strong>Example adding the label <code class="literal">my=true</code></strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:
          metadata:
            labels:
              my: true</pre>
						</p></div></dd><dt><span class="term"><code class="literal">volumes</code></span></dt><dd/></dl></div><p>
			Add an additional volume named <code class="literal">my-volume</code> and mount it under <code class="literal">/my/path</code> in the Developer Hub application container.
		</p><div class="formalpara"><p class="title"><strong>Example additional volume</strong></p><p>
				
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:
          spec:
            containers:
              - name: backstage-backend
                volumeMounts:
                  - mountPath: /my/path
                    name: my-volume
            volumes:
              - ephemeral:
                  volumeClaimTemplate:
                    spec:
                      storageClassName: "special"
                name: my-volume</pre>
			</p></div><p>
			Replace the default <code class="literal">dynamic-plugins-root</code> volume with a persistent volume claim (PVC) named <code class="literal">dynamic-plugins-root</code>. Note the <code class="literal">$patch: replace</code> directive, otherwise a new volume will be added.
		</p><div class="formalpara"><p class="title"><strong>Example <code class="literal">dynamic-plugins-root</code> volume replacement</strong></p><p>
				
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:
          spec:
            volumes:
              - $patch: replace
                name: dynamic-plugins-root
                persistentVolumeClaim:
                  claimName: dynamic-plugins-root</pre>
			</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">cpu</code> request</span></dt><dd><p class="simpara">
						Set the CPU request for the Developer Hub application container to 250m.
					</p><div class="formalpara"><p class="title"><strong>Example CPU request</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:
          spec:
            containers:
              - name: backstage-backend
                resources:
                  requests:
                    cpu: 250m</pre>
						</p></div></dd><dt><span class="term"><code class="literal">my-sidecar</code> container</span></dt><dd><p class="simpara">
						Add a new <code class="literal">my-sidecar</code> sidecar container into the Developer Hub Pod.
					</p><div class="formalpara"><p class="title"><strong>Example side car container</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha2
kind: Backstage
metadata:
  name: developer-hub
spec:
  deployment:
    patch:
      spec:
        template:
          spec:
            containers:
              - name: my-sidecar
                image: quay.io/my-org/my-sidecar:latest</pre>
						</p></div></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					To learn more about merging, see <a class="link" href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-api-machinery/strategic-merge-patch.md#basic-patch-format">Strategic Merge Patch</a>.
				</li></ul></div><section class="section" id="proc-mount-directories-pvcs_assembly-admin-templates"><div class="titlepage"><div><div><h3 class="title">8.1. Mounting directories from pre-created PVCs</h3></div></div></div><p>
				Starting from <code class="literal">v1alpha3</code>, you can mount directories from pre-created PersistentVolumeClaims (PVCs) using the <code class="literal">spec.application.extraFiles.pvcs</code> field.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have understanding of the mounting logic:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								If <code class="literal">spec.application.extraFiles.pvcs[].mountPath</code> is defined, the PVC is mounted to the specified path.
							</li><li class="listitem">
								If <code class="literal">spec.application.extraFiles.pvcs[].mountPath</code> is not defined, the PVC is mounted under the path specified in <code class="literal">spec.application.extraFiles.mountPath/</code>.
							</li><li class="listitem">
								If <code class="literal">mountPath</code> is not defined, the PVC defaults to <code class="literal">/opt/app-root/src</code>, or you can use the RHDH container’s working directory if it is specified.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Define the PVCs using the following YAML example:
					</p><div class="formalpara"><p class="title"><strong>Example YAML file to define PVCs</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: myclaim1
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: myclaim2
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Use the following configuration to specify how the PVCs are mounted in the container:
					</p><div class="formalpara"><p class="title"><strong>Example configuration for mounting PVCs in a container</strong></p><p>
							
<pre class="programlisting language-yaml">spec:
  application:
    extraFiles:
      mountPath: /my/path
      pvcs:
        - name: myclaim1
        - name: myclaim2
          mountPath: /vol/my/claim</pre>
						</p></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					Based on the configuration, the following directories are mounted in the container:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">/my/path/myclaim1</code>
					</li><li class="listitem">
						<code class="literal">/vol/my/claim</code>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm45975125086368"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></section></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>