<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Orchestrator in Red Hat Developer Hub</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.2"/><meta name="description" content="As an administrator, you can use Orchestrator to enable serverless workflows in Red Hat Developer Hub to support cloud migration, developer onboarding, and custom workflows."/><link rel="next" href="#assembly-orchestrator-rhdh" title="1. About Orchestrator in Red Hat Developer Hub"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><section xml:lang="en-US" class="article" id="idm46594076179824"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Developer Hub</span> <span class="productnumber">1.9</span></div><div><h1 class="title">Orchestrator in Red Hat Developer Hub</h1></div><div><h3 class="subtitle"><em>Orchestrator enables serverless workflows for cloud migration, onboarding, and customization in Red Hat Developer Hub</em></h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat Customer Content Services</span></div></div><div><a href="#idm46594052774928">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				As an administrator, you can use Orchestrator to enable serverless workflows in Red Hat Developer Hub to support cloud migration, developer onboarding, and custom workflows.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="section"><a href="#assembly-orchestrator-rhdh">1. About Orchestrator in Red Hat Developer Hub</a></span><ul><li><span class="section"><a href="#con-compatibility-guide-for-orchestrator_orchestrator-rhdh">1.1. Compatibility guide for Orchestrator</a></span></li><li><span class="section"><a href="#con-architecture-overview_orchestrator-rhdh">1.2. Understand Orchestrator architecture</a></span></li><li><span class="section"><a href="#con-getting-started_orchestrator-rhdh">1.3. Getting started with Orchestrator</a></span></li><li><span class="section"><a href="#con-orchestrator-plugin-dependencies-operator_orchestrator-rhdh">1.4. Orchestrator plugin dependencies for Operator installation</a></span></li></ul></li><li><span class="section"><a href="#assembly-orchestrator-plugins-components_orchestrator-rhdh">2. Enabling Orchestrator plugins components</a></span><ul><li><span class="section"><a href="#proc-enabling-orchestrator-plugins-components_orchestrator-rhdh">2.1. Enabling Orchestrator plugins components</a></span></li></ul></li><li><span class="section"><a href="#assembly-install-rhdh-orchestrator-operator">3. Installing Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Operator</a></span><ul><li><span class="section"><a href="#proc-enable-orchestrator-plugin_install-rhdh-orchestrator">3.1. Enabling the Orchestrator plugin using the Operator</a></span></li><li><span class="section"><a href="#proc-upgrading-the-orchestrator-plugin_install-rhdh-orchestrator">3.2. Upgrading the Orchestrator plugin from <code class="literal">1.7</code> to 1.9</a></span></li><li><span class="section"><a href="#proc-upgrading-the-openshift-serverless-logic-operator_install-rhdh-orchestrator">3.3. Upgrading the OpenShift Serverless Logic Operator for Red Hat Developer Hub 1.9</a></span></li><li><span class="section"><a href="#ref-orchestrator-plugin-permissions_install-rhdh-orchestrator">3.4. Orchestrator plugin permissions</a></span></li><li><span class="section"><a href="#proc-managing-orchestrator-plugin-permissions-using-rbac-policies_install-rhdh-orchestrator">3.5. Managing Orchestrator plugin permissions using RBAC policies</a></span></li></ul></li><li><span class="section"><a href="#assembly-install-rhdh-orchestrator-helm">4. Installing Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Helm chart</a></span><ul><li><span class="section"><a href="#proc-install-rhdh-with-orchestrator-helm-cli_install-rhdh-orchestrator">4.1. Installing Red Hat Developer Hub (RHDH) on OpenShift Container Platform with the Orchestrator using the Helm CLI</a></span></li><li><span class="section"><a href="#proc-install-rhdh-with-orchestrator-helm-webui_install-rhdh-orchestrator">4.2. Install Red Hat Developer Hub (RHDH) using Helm from the OpenShift Container Platform web console</a></span></li><li><span class="section"><a href="#ref-orchestrator-resource-limits_install-rhdh-orchestrator">4.3. Resource limits for installing Red Hat Developer Hub with the Orchestrator plugin when using Helm</a></span></li><li><span class="section"><a href="#proc-manual-install-orchestrator-plugin_install-rhdh-orchestrator">4.4. Installing Orchestrator components manually on OpenShift Container Platform</a></span></li></ul></li><li><span class="section"><a href="#assembly-install-rhdh-orchestrator-plugin-in-an-air-gapped-environment-operator_install-rhdh-orchestrator">5. Installing Orchestrator plugin in an air-gapped environment with the Operator</a></span><ul><li><span class="section"><a href="#proc-install-rhdh-orchestrator-airgapped-env-using-operator-full_install-rhdh-orchestrator">5.1. Installing Red Hat Developer Hub with Orchestrator in a fully disconnected OpenShift Container Platform environment using the Operator</a></span></li><li><span class="section"><a href="#proc-install-rhdh-orchestrator-airgapped-env-using-operator-partial_install-rhdh-orchestrator">5.2. Installing Red Hat Developer Hub with Orchestrator in a partially disconnected OpenShift Container Platform environment using the Operator</a></span></li></ul></li><li><span class="section"><a href="#assembly-install-rhdh-orchestrator-plugin-in-an-air-gapped-environment-helm_install-rhdh-orchestrator">6. Installing Orchestrator plugin in an air-gapped environment with the Helm chart</a></span><ul><li><span class="section"><a href="#proc-install-rhdh-orchestrator-airgapped-env-using-helm-chart-full_install-rhdh-orchestrator">6.1. Installing Red Hat Developer Hub with Orchestrator in a fully disconnected OpenShift Container Platform environment using the Helm chart</a></span></li><li><span class="section"><a href="#proc-install-rhdh-orchestrator-airgapped-env-using-helm-chart-partial_install-rhdh-orchestrator">6.2. Installing Red Hat Developer Hub with Orchestrator in a partially disconnected OpenShift Container Platform environment using the Helm chart</a></span></li></ul></li><li><span class="section"><a href="#assembly-configuring-orchestrator">7. Integrating Loki Logs to debug Orchestrator workflows</a></span><ul><li><span class="section"><a href="#proc-integrating-loki-logs-for-orchestrator-workflows_orchestrator-rhdh">7.1. Integrating Loki logs for Orchestrator workflows</a></span></li></ul></li><li><span class="section"><a href="#assembly-building-and-deploying-serverless-workflows">8. Build and deploy serverless workflows</a></span><ul><li><span class="section"><a href="#con-benefits-of-workflow-images_orchestrator-rhdh">8.1. Benefits of workflow images</a></span></li><li><span class="section"><a href="#proc-building-locally_orchestrator-rhdh">8.2. Building workflow images locally</a></span></li><li><span class="section"><a href="#con-generated-workflow-manifests_orchestrator-rhdh">8.3. Generated workflow manifests</a></span></li><li><span class="section"><a href="#proc-deploying-workflows-on-a-cluster_orchestrator-rhdh">8.4. Deploying workflows on a cluster</a></span></li><li><span class="section"><a href="#ref-best-practices-for-creating-workflows_orchestrator-rhdh">8.5. Best practices when creating serverless workflows</a></span></li></ul></li><li><span class="section"><a href="#assembly-automating-workflow-deployment-with-orchestrator">9. Automating workflow deployment with Orchestrator</a></span><ul><li><span class="section"><a href="#proc-installing-orchestrator-software-templates_orchestrator-rhdh">9.1. Installing Orchestrator software templates</a></span></li><li><span class="section"><a href="#proc-creating-a-serverless-workflow-project_orchestrator-rhdh">9.2. Creating a serverless workflow project</a></span></li><li><span class="section"><a href="#proc-bootstrapping-gitops-resources-and-triggering-pipelines_orchestrator-rhdh">9.3. Bootstrapping GitOps resources and triggering pipelines</a></span></li><li><span class="section"><a href="#proc-verifying-the-deployment_orchestrator-rhdh">9.4. Verifying the deployment</a></span></li><li><span class="section"><a href="#proc-troubleshooting-the-pipelines_orchestrator-rhdh">9.5. Troubleshooting workflow deployments</a></span></li></ul></li><li><span class="section"><a href="#assembly-orchestrator-troubleshooting-serverless-workflows_orchestrator-rhdh">10. Diagnose and resolve serverless workflow issues</a></span><ul><li><span class="section"><a href="#ref-troubleshoot-workflow-http-error-codes_orchestrator-rhdh">10.1. Troubleshoot workflow HTTP error codes</a></span></li><li><span class="section"><a href="#proc-workflow-deployment-errors_orchestrator-rhdh">10.2. Troubleshooting common workflow deployment errors</a></span></li><li><span class="section"><a href="#proc-troubleshoot-sonataflow-cross-namespace-issues_orchestrator-rhdh">10.3. Troubleshooting cross-namespace SonataFlow configuration and deployment issues</a></span></li><li><span class="section"><a href="#proc-troubleshooting-missing-workflows_orchestrator-rhdh">10.4. Troubleshooting workflows missing from the RHDH UI</a></span></li></ul></li><li><span class="section"><a href="#assembly-orchestrator-plugins-technical-appendixes_orchestrator-rhdh">11. Technical appendix</a></span><ul><li><span class="section"><a href="#proc-helper-script-overview_orchestrator-rhdh">11.1. Installing components using the <code class="literal">RHDH</code> helper script</a></span></li></ul></li></ul></div><section class="section" id="assembly-orchestrator-rhdh"><div class="titlepage"><div><div><h2 class="title">1. About Orchestrator in Red Hat Developer Hub</h2></div></div></div><p>
			You can streamline and automate your work by using the Orchestrator in Red Hat Developer Hub. It enables you to:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Design, run, and monitor workflows to simplify multi-step processes across applications and services.
				</li><li class="listitem">
					Standardize onboarding, migration, and integration workflows to reduce manual effort and improve consistency.
				</li><li class="listitem">
					Extend RHDH with enterprise-grade Orchestration features to support collaboration and scalability.
				</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Orchestrator currently supports only Red Hat OpenShift Container Platform (OpenShift Container Platform); it is not available on Microsoft Azure Kubernetes Service (AKS), Amazon Elastic Kubernetes Service (EKS), or Google Kubernetes Engine (GKE).
			</p></div></div><section class="section" id="con-compatibility-guide-for-orchestrator_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">1.1. Compatibility guide for Orchestrator</h3></div></div></div><p>
				The following table lists the RHDH Orchestrator plugin versions and their compatible corresponding infrastructure versions.
			</p><div class="informaltable"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 20%; " class="col_2"/><col style="width: 20%; " class="col_3"/><col style="width: 20%; " class="col_4"/><col style="width: 20%; " class="col_5"/></colgroup><tbody><tr><td align="left" valign="top">
							<p>
								Orchestrator plugin version
							</p>
							</td><td align="left" valign="top">
							<p>
								Red Hat Developer Hub (RHDH) version
							</p>
							</td><td align="left" valign="top">
							<p>
								OpenShift version
							</p>
							</td><td align="left" valign="top">
							<p>
								OpenShift Serverless Logic (OSL) version
							</p>
							</td><td align="left" valign="top">
							<p>
								OpenShift Serverless version
							</p>
							</td></tr><tr><td align="left" valign="top">
							<p>
								Orchestrator <code class="literal">1.5</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.5</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">4.14</code> - <code class="literal">4.18</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								OSL <code class="literal">1.35</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.35</code>
							</p>
							</td></tr><tr><td align="left" valign="top">
							<p>
								Orchestrator <code class="literal">1.6</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.6</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">4.14</code> - <code class="literal">4.18</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								OSL <code class="literal">1.36</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.36</code>
							</p>
							</td></tr><tr><td align="left" valign="top">
							<p>
								Orchestrator <code class="literal">1.7.1</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.7</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">4.16</code> - <code class="literal">4.19</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								OSL <code class="literal">1.36</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.36</code>
							</p>
							</td></tr><tr><td align="left" valign="top">
							<p>
								Orchestrator 1.8.2
							</p>
							</td><td align="left" valign="top">
							<p>
								1.8
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">4.16</code> - <code class="literal">4.19</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								OSL <code class="literal">1.36</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">1.36</code>
							</p>
							</td></tr><tr><td align="left" valign="top">
							<p>
								Orchestrator 1.9.0
							</p>
							</td><td align="left" valign="top">
							<p>
								1.9
							</p>
							</td><td align="left" valign="top">
							<p>
								<code class="literal">4.16</code> - <code class="literal">4.20</code>
							</p>
							</td><td align="left" valign="top">
							<p>
								OSL 1.37
							</p>
							</td><td align="left" valign="top">
							<p>
								1.37
							</p>
							</td></tr></tbody></table></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					Orchestrator plugin supports the same OpenShift Container Platform versions as RHDH. See the <a class="link" href="https://access.redhat.com/support/policy/updates/developerhub?extIdCarryOver=true&amp;sc_cid=RHCTG0180000371695">Life Cycle</a> page.
				</p></div></div></section><section class="section" id="con-architecture-overview_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">1.2. Understand Orchestrator architecture</h3></div></div></div><p>
				The Orchestrator architecture is composed of several components, each contributing to the running and management of workflows.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Red Hat Developer Hub (RHDH)</span></dt><dd><p class="simpara">
							Serves as the primary interface. It contains the following subcomponents:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Orchestrator frontend plugins</span></dt><dd>
										Provide the interface for users to run and monitor workflows within RHDH.
									</dd><dt><span class="term">Orchestrator backend plugins</span></dt><dd>
										Get workflow data into Developer Hub.
									</dd><dt><span class="term">Notifications plugins</span></dt><dd>
										Inform users about workflow events.
									</dd></dl></div></dd><dt><span class="term">OpenShift Serverless Logic Operator</span></dt><dd><p class="simpara">
							Serves as the workflow engine, and its subcomponents handle running, executing and providing persistence for the workflows. The Red Hat Developer Hub Operator and the Red Hat Developer Hub Helm chart manage the following lifecycle of these subcomponents:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Sonataflow Runtime/Workflow Application</span></dt><dd>
										Functions as a deployed workflow. Operates as an HTTP server, handling requests for running workflow instances. It is managed as a Kubernetes (K8s) deployment by the OpenShift Serverless Logic Operator.
									</dd><dt><span class="term">Data Index Service</span></dt><dd>
										Serves as a repository for workflow definitions, instances, and associated jobs. It exposes a GraphQL API used by the Orchestrator backend plugin to retrieve workflow definitions and instances.
									</dd><dt><span class="term">Job Service</span></dt><dd>
										Orchestrates scheduled tasks for workflows.
									</dd><dt><span class="term">OpenShift Serverless</span></dt><dd>
										Provides serverless capabilities essential for workflow communication. It employs Knative eventing to interface with the Data Index service and uses Knative functions to introduce more complex logic to workflows.
									</dd><dt><span class="term">PostgreSQL Server</span></dt><dd>
										Provides a database solution essential for data persistence within the Orchestrator ecosystem. The system uses PostgreSQL Server for storing both Sonataflow information and Developer Hub data.
									</dd></dl></div></dd><dt><span class="term">OpenShift AMQ Streams (Strimzi/Kafka)</span></dt><dd><p class="simpara">
							Provides enhanced reliability of the eventing system. Eventing can work without Kafka by using direct HTTP calls, however, this approach is not reliable.
						</p><p class="simpara">
							Optional: The current deployment iteration does not natively integrate or include the AMQ Streams Operator. However, you can add the Operator post-install for enhanced reliability if you require it.
						</p></dd></dl></div></section><section class="section" id="con-getting-started_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">1.3. Getting started with Orchestrator</h3></div></div></div><p>
				To start using Orchestrator in RHDH, you must:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the required infrastructure components, such as OpenShift Serverless Operator, and OpenShift Serverless Logic Operator
					</li><li class="listitem">
						Configure your Backstage custom resource (CR) or Helm values file for Orchestrator
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					When using the RHDH Operator, you must first install the required infrastructure components. The Operator then provisions the dependent SonataFlow resources once the Orchestrator plugins are enabled in the Backstage CR.
				</p><p>
					When using the RHDH Helm chart, the required infrastructure components are installed automatically using the dedicated <code class="literal">redhat-developer-hub-orchestrator-infra</code> Helm chart prior to enabling the Orchestrator plugins in the main RHDH chart.
				</p></div></div></section><section class="section" id="con-orchestrator-plugin-dependencies-operator_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">1.4. Orchestrator plugin dependencies for Operator installation</h3></div></div></div><p>
				When you enable the Orchestrator plugin in your Backstage custom resource (CR), the Operator automatically provisions the following required dependencies:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A <code class="literal">SonataflowPlatform</code> CR
					</li><li class="listitem">
						<code class="literal">NetworkPolicies</code> that allow traffic between infrastructure resources (Knative, Serverless Logic Operator), monitoring traffic, and intra-namespace traffic
					</li></ul></div><p>
				The Orchestrator plugin requires these components to run. For example, to communicate with the SonataFlow platform, the Orchestrator plugin uses the <code class="literal">sonataflow-platform-data-index-service</code>, which is created by the <code class="literal">SonataFlowPlatform</code> CR.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The <code class="literal">SonataFlowPlatform</code> CR contains Data Index service that requires PostgreSQL database as shown in the following example:
				</p><pre class="programlisting language-yaml">      persistence:
        postgresql:
          secretRef:
            name: backstage-psql-secret-{{backstage-name}}
            userKey: POSTGRES_USER
            passwordKey: POSTGRES_PASSWORD
          serviceRef:
            name: backstage-psql-{{backstage-name}} # # Namespace where the Backstage CR is created
            namespace: {{backstage-ns}} # Namespace where the Backstage (CR) is created
            databaseName: backstage_plugin_orchestrator</pre></div></div><p>
				By default, the Orchestrator plugin dependencies use the following:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The PostgreSQL database named <code class="literal">backstage_plugin_orchestrator</code> created by Backstage
					</li><li class="listitem">
						A Secret created by Backstage Operator for the PostgreSQL with <code class="literal">POSTGRES_USER</code> and <code class="literal">POSTGRES_PASSWORD</code> keys as the database credentials in the Backstage CR namespace.
					</li><li class="listitem">
						A Service created by Backstage Operator for the PostgreSQL database with the name <code class="literal">backstage-psql-{{backstage-name}}</code> in the Backstage CR namespace.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					To enable the Backstage Operator to work with the SonataFlow platform, its <code class="literal">ServiceAccount</code> must have the appropriate permissions.
				</p><p>
					The Operator automatically creates the required Role and <span class="emphasis"><em>RoleBinding</em></span> resource in <code class="literal">profile/rhdh/plugin-rbac</code> directory.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/redhat-developer/rhdh-operator/blob/release-1.9/docs/dynamic-plugins.md#dynamic-plugins-dependency-management">Dynamic plugins dependency management</a>
					</li></ul></div></section></section><section class="section" id="assembly-orchestrator-plugins-components_orchestrator-rhdh"><div class="titlepage"><div><div><h2 class="title">2. Enabling Orchestrator plugins components</h2></div></div></div><section class="section" id="proc-enabling-orchestrator-plugins-components_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">2.1. Enabling Orchestrator plugins components</h3></div></div></div><p>
				To use the Orchestrator, enable the following Orchestrator plugins for Red Hat Developer Hub, that are disabled by default:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Orchestrator-frontend plugin</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">backstage-plugin-orchestrator</code></span></dt><dd>
										Provides the interface for users to run and monitor workflows within RHDH. You can run and track the execution status of processes.
									</dd></dl></div></dd><dt><span class="term">Orchestrator-backend plugin</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">backstage-plugin-orchestrator-backend</code></span></dt><dd>
										Gets workflow data into Developer Hub making sure RHDH processes critical workflow metadata and runtime status fulfilling your need for visibility.
									</dd></dl></div></dd><dt><span class="term">Orchestrator-form-widget</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">backstage-plugin-orchestrator-form-widgets</code></span></dt><dd>
										Provides custom widgets for the workflow execution form, allowing you to customize input fields and streamline the process of launching workflows.
									</dd></dl></div></dd><dt><span class="term">Orchestrator-scaffolder-backend-module</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">scaffolder-backend-module-orchestrator</code></span></dt><dd>
										Provides callable actions from Scaffolder templates, such as <code class="literal">orchestrator:workflow:run</code> or <code class="literal">orchestrator:workflow:get_params</code>.
									</dd></dl></div></dd></dl></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the following operators:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Openshift Serverless
							</li><li class="listitem">
								Openshift Serverless Logic (OSL)
							</li></ul></div></li><li class="listitem">
						(Optional) For managing the Orchestrator project, you have an instance of Argo CD or Red Hat OpenShift GitOps in the cluster. It is disabled by default.
					</li><li class="listitem">
						(Optional) To use Tekton tasks and the build pipeline, you have an instance of Tekton or Red Hat OpenShift Pipelines in the cluster. These features are disabled by default.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Locate your Developer Hub configuration and enable the Orchestrator plugins and the supporting notification plugins.
					</p><pre class="programlisting language-yaml">plugins:
  - package: "@redhat/backstage-plugin-orchestrator@1.9.0"
    disabled: false
  - package: "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0"
    disabled: false
  - package: "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0"
    disabled: false
  - package: "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0"
    disabled: false
  - package: "./dynamic-plugins/dist/backstage-plugin-notifications"
    disabled: false
  - package: "./dynamic-plugins/dist/backstage-plugin-signals"
    disabled: false
  - package: "./dynamic-plugins/dist/backstage-plugin-notifications-backend-dynamic"
    disabled: false
  - package: "./dynamic-plugins/dist/backstage-plugin-signals-backend-dynamic"
    disabled: false</pre></li></ul></div></section></section><section class="section" id="assembly-install-rhdh-orchestrator-operator"><div class="titlepage"><div><div><h2 class="title">3. Installing Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Operator</h2></div></div></div><p>
			You can install Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Operator.
		</p><section class="section" id="proc-enable-orchestrator-plugin_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">3.1. Enabling the Orchestrator plugin using the Operator</h3></div></div></div><p>
				You can enable the Orchestrator plugin in RHDH by configuring dynamic plugins in your Backstage custom resource (CR).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed RHDH on OpenShift Container Platform.
					</li><li class="listitem">
						You have access to edit or create ConfigMaps in the namespace where the Backstage CR is deployed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To enable the Orchestrator plugin with default settings, set <code class="literal">disabled: false</code> for the package. For example, <code class="literal">package: "@redhat/backstage-plugin-orchestrator@&lt;plugin_version&gt;</code> is set to <code class="literal">disabled: false</code>:
					</p><pre class="programlisting language-yaml">- package: "@redhat/backstage-plugin-orchestrator@&lt;plugin_version&gt;"
  disabled: false</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							When you enable the plugins, the pre-loaded plugin configuration are used. Additionally, the <code class="literal">ref: sonataflow</code> field installs the OpenShift Serverless and OpenShift Serverless Logic resources. This happens automatically when you are using the Operator.
						</p></div></div><div class="formalpara"><p class="title"><strong>Example: Complete configuration of the Orchestrator plugin</strong></p><p>
							
<pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: orchestrator-plugin
data:
    dynamic-plugins.yaml: |
      includes:
        - dynamic-plugins.default.yaml
      plugins:
        - package: "@redhat/backstage-plugin-orchestrator@1.9.0"
          disabled: false
          pluginConfig:
            dynamicPlugins:
                frontend:
                  red-hat-developer-hub.backstage-plugin-orchestrator:
                    appIcons:
                      - importName: OrchestratorIcon
                        name: orchestratorIcon
                    dynamicRoutes:
                      - importName: OrchestratorPage
                        menuItem:
                          icon: orchestratorIcon
                          text: Orchestrator
                        path: /orchestrator
                    entityTabs:
                      - path: /workflows
                        title: Workflows
                        mountPoint: entity.page.workflows
                    mountPoints:
                      - mountPoint: entity.page.workflows/cards
                      importName: OrchestratorCatalogTab
                      config:
                        layout:
                          gridColumn: '1 / -1'
                          if:
                            anyOf:
                              - IsOrchestratorCatalogTabAvailable
        - package: "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0"
          disabled: false
          pluginConfig:
            orchestrator:
              dataIndexService:
                url: http://sonataflow-platform-data-index-service
          dependencies:
            - ref: sonataflow
        - package: "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0"
          disabled: false
          pluginConfig:
            orchestrator:
              dataIndexService:
                url: http://sonataflow-platform-data-index-service
        - package: "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0"
          disabled: false
          pluginConfig:
            dynamicPlugins:
              frontend:
                red-hat-developer-hub.backstage-plugin-orchestrator-form-widgets: { }
---
apiVersion: rhdh.redhat.com/v1alpha5
kind: Backstage
metadata:
  name: orchestrator
spec:
  application:
    appConfig:
      configMaps:
        - name: app-config-rhdh
    dynamicPluginsConfigMapName: orchestrator-plugin</pre>
						</p></div></li><li class="listitem"><p class="simpara">
						Create a secret containing the <code class="literal">BACKEND_SECRET</code> value as shown in the following example:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config-rhdh
data:
  app-config.yaml: |-
    auth:
      environment: development
      providers:
        guest:
          # using the guest user to query the '/api/dynamic-plugins-info/loaded-plugins' endpoint.
          dangerouslyAllowOutsideDevelopment: true
    backend:
      auth:
        externalAccess:
          - type: static
            options:
              token: ${BACKEND_SECRET}
              subject: orchestrator
---
apiVersion: v1
kind: Secret
metadata:
  name: backend-auth-secret
stringData:
  # generated with the command below (from https://backstage.io/docs/auth/service-to-service-auth/#setup):
  # node -p 'require("crypto").randomBytes(24).toString("base64")'
  # notsecret
  BACKEND_SECRET: "R2FxRVNrcmwzYzhhN3l0V1VRcnQ3L1pLT09WaVhDNUEK"</pre></li><li class="listitem"><p class="simpara">
						Configure your Backstage CR to update the secret name in the <code class="literal">extraEnvs</code> field as shown in the following example:
					</p><pre class="programlisting language-yaml">apiVersion: rhdh.redhat.com/v1alpha5
kind: Backstage
metadata:
  name: orchestrator
spec:
  application:
    appConfig:
      configMaps:
        - name: app-config-rhdh
    dynamicPluginsConfigMapName: orchestrator-plugin
    extraEnvs:
      secrets:
          # secret that contains the BACKEND_SECRET key
        - name: backend-auth-secret</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						In the RHDH console, confirm that the Orchestrator frontend and backend features are available.
					</li></ul></div></section><section class="section" id="proc-upgrading-the-orchestrator-plugin_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">3.2. Upgrading the Orchestrator plugin from <code class="literal">1.7</code> to 1.9</h3></div></div></div><p>
				You can upgrade an existing <code class="literal">1.7</code> Operator-backed instance with Orchestrator enabled by upgrading the Red Hat Developer Hub Operator to 1.9. After upgrading the Operator to 1.9, manually update the <code class="literal">dynamic-plugins</code> ConfigMap to set the Orchestrator plugin versions to <code class="literal">1.8.2</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have have a running instance of Red Hat Developer Hub with Orchestrator <code class="literal">1.7</code> backed by the Operator.
					</li><li class="listitem">
						You have upgraded the Red Hat Developer Hub Operator to 1.9.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Update your <code class="literal">dynamic-plugins</code> ConfigMap to set the version of the Orchestrator plugin to <code class="literal">1.8.2</code>.
					</p><p class="simpara">
						The following YAML configuration is an example of a <code class="literal">dynamic-plugins</code> ConfigMap enabling the Orchestrator plugins in RHDH for Operator-backed instances:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: dynamic-plugins-rhdh
data:
  dynamic-plugins.yaml: |
    includes:
      - dynamic-plugins.default.yaml
    plugins:
      - package: "@redhat/backstage-plugin-orchestrator@1.8.2"
        disabled: false
      - package: "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.8.2"
        disabled: false
        dependencies:
          - ref: sonataflow
      - package: "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.8.2"
        disabled: false
      - package: "@redhat/backstage-plugin-orchestrator-form-widgets@1.8.2"
        disabled: false</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your Red Hat Developer Hub instance.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The upgrade takes a few minutes to complete. The Red Hat Developer Hub version does not update in the UI until all running Backstage pods are successfully recreated.
						</p></div></div></li><li class="listitem">
						From the profile dropdown in the top menu, click the <span class="strong strong"><strong>Settings</strong></span> icon and then locate the RHDH metadata card.
					</li><li class="listitem">
						Confirm that the value displayed for RHDH version is 1.9.
					</li><li class="listitem"><p class="simpara">
						Alternatively, run the following command in your terminal to wait for all pods in the current project to be in the <code class="literal">running</code> state:
					</p><pre class="programlisting language-terminal">$ oc get pods -w</pre><p class="simpara">
						The upgrade is successful when all Backstage-related pods show a stable <span class="strong strong"><strong>Running</strong></span> status.
					</p></li></ol></div></section><section class="section" id="proc-upgrading-the-openshift-serverless-logic-operator_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">3.3. Upgrading the OpenShift Serverless Logic Operator for Red Hat Developer Hub 1.9</h3></div></div></div><p>
				You must upgrade the OpenShift Serverless Logic (OSL) Operator to version 1.37 for compatibility with Red Hat Developer Hub 1.9. This update includes a base image transition to Red Hat Enterprise Linux (RHEL) 9. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.37/html/serverless_logic/getting-started#serverless-logic-upgrading-operator">OpenShift Serverless Logic Operator documentation</a> for the supported OpenShift Serverless Logic Operator versions and upgrade process.
			</p><p>
				Starting with OSL 1.37, the Operator subscription name and starting ClusterServiceVersion (CSV) no longer explicitly reference the operating system (OS) version.
			</p><p>
				In previous releases, the Operator subscription name and starting CSV explicitly included the OS version, such as <code class="literal">logic-operator-rhel8</code> and <code class="literal">logic-operator-rhel8.v1.36.0</code>.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Before performing the upgrade, make sure you do not delete the existing <code class="literal">SonataflowPlatform</code> operands during this process. When performing the upgrade, you must replace the logic-operator-rhel8 subscription with the logic-operator subscription.
				</p></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have administrative access to the OpenShift cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Delete the previous <code class="literal">logic-operator-rhel8</code> subscription and apply the following configuration to install the <code class="literal">logic-operator</code> subscription:
					</p><pre class="programlisting language-yaml">apiVersion: v1
kind: Namespace
metadata:
  name: openshift-serverless-logic
---
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: openshift-serverless-logic
  namespace: openshift-serverless-logic
spec:
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: logic-operator
  namespace: openshift-serverless-logic
spec:
  channel: stable  #  channel of an operator package to subscribe to
  installPlanApproval: Automatic #  whether the update should be installed automatically
  name: logic-operator  #  name of the operator package
  source: redhat-operators  #  name of the catalog source
  sourceNamespace: openshift-marketplace
  startingCSV: logic-operator.v1.37.0  # The initial version of the operator</pre></li><li class="listitem"><p class="simpara">
						Optional: If your configuration uses an external PostgreSQL database with SSL, add the required datasource environment variables to the <code class="literal">jobService</code> specification in the <code class="literal">SonataflowPlatform</code> custom resource as shown in the following configuration:
					</p><pre class="programlisting language-yaml">jobService:
  enabled: true
  persistence:
    dbMigrationStrategy: service
    postgresql:
      # no additional url params here. We only have currentSchema=jobs-service.
      jdbcUrl: 'jdbc:postgresql://postgress-external-db-primary.postgress-external-db.svc.cluster.local:5432/sonataflow?currentSchema=jobs-service'
      secretRef:
        name: postgres-cred
        passwordKey: POSTGRES_PASSWORD
        userKey: POSTGRES_USER
  podTemplate:
    container:
      env:
        # only this two env vars
        - name: QUARKUS_DATASOURCE_REACTIVE_POSTGRESQL_SSL_MODE
          value: allow
        - name: QUARKUS_DATASOURCE_REACTIVE_TRUST_ALL
          value: 'true'</pre></li></ol></div></section><section class="section" id="ref-orchestrator-plugin-permissions_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">3.4. Orchestrator plugin permissions</h3></div></div></div><p>
				The Orchestrator plugin uses the Red Hat Developer Hub permission mechanism and the Role-Based Access Control (RBAC) plugin to restrict access to backend endpoints. Orchestrator supports decoupling visibility (read) from running (update) using specific workflow IDs instead of generic permissions.
			</p><div class="informaltable"><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"/><col style="width: 15%; " class="col_2"/><col style="width: 15%; " class="col_3"/><col style="width: 50%; " class="col_4"/></colgroup><thead><tr><th align="left" valign="top" id="idm46594053503888" scope="col">Permission name</th><th align="left" valign="top" id="idm46594052125216" scope="col">Resource Type</th><th align="left" valign="top" id="idm46594052124160" scope="col">Policy</th><th align="left" valign="top" id="idm46594052123072" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.workflow</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								read
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Lists and reads all workflow definitions.
							</p>
							<p>
								Lists and reads their instances
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.workflow.[workflowId]</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								read
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Lists and reads a specific workflow definition.
							</p>
							<p>
								Lists and reads instances created for this particular workflow.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.workflow.use</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								update
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Runs or aborts any workflow.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.workflow.use.[workflowId]</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								update
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Runs or aborts a specific workflow.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.workflowAdminView</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								read
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Views instance variables and the workflow definition editor.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053503888">
							<p>
								<code class="literal">orchestrator.instanceAdminView</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594052125216">
							<p>
								named resource
							</p>
							</td><td align="left" valign="top" headers="idm46594052124160">
							<p>
								read
							</p>
							</td><td align="left" valign="top" headers="idm46594052123072">
							<p>
								Views all workflow instances, including those created by other users.
							</p>
							</td></tr></tbody></table></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Generic permissions override specific denial policies within the same action type. To maintain granular control, avoid granting generic permissions if you intend to restrict specific workflows.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Granting <code class="literal">orchestrator.workflow</code> (read) prevents you from denying access to <code class="literal">orchestrator.workflow.[workflowId]</code> (read).
						</li><li class="listitem">
							Granting <code class="literal">orchestrator.workflow.use</code> (update) prevents you from denying access to <code class="literal">orchestrator.workflow.use.[workflowId]</code> (update).
						</li></ul></div></div></div><p>
				The [<code class="literal">workflowId</code>] must match the unique identifier in your workflow definition file. For example, in the workflow definition below, the identifier is <code class="literal">greeting</code>:
			</p><pre class="programlisting language-yaml">id: greeting
version: '1.0'
specVersion: '0.8'
name: Greeting workflow
description: YAML based greeting workflow
annotations:
  - 'workflow-type/infrastructure'
dataInputSchema: 'schemas/greeting.sw.input-schema.json'
extensions:
  - extensionid: workflow-output-schema
    outputSchema: schemas/workflow-output-schema.json</pre></section><section class="section" id="proc-managing-orchestrator-plugin-permissions-using-rbac-policies_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">3.5. Managing Orchestrator plugin permissions using RBAC policies</h3></div></div></div><p>
				You can configure Role-Based Access Control (RBAC) policies so that users can view workflow details without the permission to run those workflows. This configuration restricts user interaction to authorized workflows.
			</p><div class="orderedlist"><p class="title"><strong>Prerequisites</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						You have identified the [<code class="literal">workflowId</code>] for each workflow you want to restrict.
					</li><li class="listitem">
						You have enabled the RBAC plugin.
					</li><li class="listitem">
						You have configured the <code class="literal">policies-csv-file</code> path in your <code class="literal">app-config.yaml</code>.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Identify the <code class="literal">workflowId</code> from your workflow definition file:
					</p><pre class="programlisting language-yaml">id: greeting
version: '1.0'</pre></li><li class="listitem"><p class="simpara">
						In your RBAC policy CSV file, define the permissions using the <code class="literal">p, role, permission, action, allow</code> format.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							Generic permissions (for example, <code class="literal">orchestrator.workflow</code>) take precedence over specific permissions targeting a <code class="literal">workflowId</code>, (for example, <code class="literal">orchestrator.workflow.greeting</code>). You cannot grant generic access and then selectively deny a specific ID.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Add the following example policies to your CSV file to establish basic user and administrator roles:
					</p><pre class="programlisting language-csv"># Minimal user role - can only view and run specific workflows
p, role:default/workflowUser, orchestrator.workflow.greeting, read, allow
p, role:default/workflowUser, orchestrator.workflow.use.greeting, update, allow

# Support role - can view all workflows and instances, but not execute
p, role:default/workflowSupport, orchestrator.workflow, read, allow
p, role:default/workflowSupport, orchestrator.instanceAdminView, read, allow

# Full admin role - complete access to all Orchestrator functions
p, role:default/workflowAdmin, orchestrator.workflow, read, allow
p, role:default/workflowAdmin, orchestrator.workflow.use, update, allow
p, role:default/workflowAdmin, orchestrator.workflowAdminView, read, allow
p, role:default/workflowAdmin, orchestrator.instanceAdminView, read, allow

# Assign users to the roles
g, user:default/example_user, role:default/workflowUser</pre></li><li class="listitem"><p class="simpara">
						In your RHDH <code class="literal">app-config.yaml</code> file, enable permissions by adding the <code class="literal">orchestrator</code> plugin to the <code class="literal">rbac</code> section and setting <code class="literal">policyFileReload</code> to <code class="literal">true</code>.
					</p><pre class="programlisting language-yaml">permission:
  enabled: true
  rbac:
    policies-csv-file: &lt;absolute_path_to_the_policy_file&gt;
    pluginsWithPermission:
      - orchestrator
    policyFileReload: true
    admin:
      users:
        - name: user:default/YOUR_USER</pre></li><li class="listitem">
						Restart the application to apply the changes.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in as a user assigned to the <code class="literal">workflowUser</code> role.
					</li><li class="listitem">
						Navigate to the Orchestrator plugin and verify that the workflow appears in the list.
					</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					You can view dynamic permissions containing a <code class="literal">workflowId</code> in the RBAC UI, but you cannot modify them in the interface. You must use the policy CSV file or the RBAC API to manage these specific workflow permissions.
				</p></div></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://www.casbin.org/docs/rbac">RBAC documentation</a>.
					</li></ul></div></section></section><section class="section" id="assembly-install-rhdh-orchestrator-helm"><div class="titlepage"><div><div><h2 class="title">4. Installing Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Helm chart</h2></div></div></div><p>
			You can install Red Hat Developer Hub with Orchestrator by using the Red Hat Developer Hub Helm chart.
		</p><section class="section" id="proc-install-rhdh-with-orchestrator-helm-cli_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">4.1. Installing Red Hat Developer Hub (RHDH) on OpenShift Container Platform with the Orchestrator using the Helm CLI</h3></div></div></div><p>
				You can install Red Hat Developer Hub (RHDH) on OpenShift Container Platform with the Orchestrator by using the Helm CLI. The installation automatically enables the required dynamic plugins and integrates workflow infrastructure.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as an administrator and have access to the Red Hat Developer Hub Helm chart repository.
					</li><li class="listitem"><p class="simpara">
						You can install the necessary infrastructures resources, such as other OpenShift operators (OpenShift Serverless and OpenShift Serverless Logic), alongside RHDH in the same namespace.
					</p><p class="simpara">
						This is a one-off requirement and must be completed before enabling the Orchestrator plugin.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Manually approve the install plans for the Operators. You must run the <code class="literal">oc patch installplan</code> commands provided in the output to approve their installation.
					</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					By default, Orchestrator Infrastructure for Red Hat Developer Hub Helm chart does <span class="strong strong"><strong>not</strong></span> auto-approve the required Serverless Operators. You must manually approve the install plans.
				</p></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						As an administrator, install relevant cluster-wide resources.
					</p><pre class="programlisting language-terminal">$ helm repo add openshift-helm-charts https://charts.openshift.io/
$ helm install <code class="literal">&lt;release_name&gt;</code> openshift-helm-charts/redhat-developer-hub-orchestrator-infra</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You must be an administrator to install the <code class="literal">redhat-developer-hub-orchestrator-infra</code> Helm chart because it deploys additional cluster-scoped OpenShift Serverless and OpenShift Serverless Logic Operators. As an administrator, you must manually approve the install plans for OpenShift Serverless and Serverless Logic Operators.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Install the Backstage chart with the orchestrator enabled as shown in the following example:
					</p><pre class="programlisting language-terminal">$ helm install &lt;release_name&gt; openshift-helm-charts/redhat-developer-hub --version 1.9.0 \
  --set orchestrator.enabled=true</pre></li><li class="listitem"><p class="simpara">
						(Optional) Enable <span class="strong strong"><strong>Notifications</strong></span> and <span class="strong strong"><strong>Signals</strong></span> plugins by adding them to the <code class="literal">global.dynamic.plugins</code> list in your <code class="literal">values.yaml</code> file as shown in the following example:
					</p><pre class="programlisting language-yaml">global:
  dynamic:
    plugins:
      - disabled: false
        package: "./dynamic-plugins/dist/backstage-plugin-notifications"
      - disabled: false
        package: "./dynamic-plugins/dist/backstage-plugin-signals"
      - disabled: false
        package: "./dynamic-plugins/dist/backstage-plugin-notifications-backend-dynamic"
      - disabled: false
        package: "./dynamic-plugins/dist/backstage-plugin-signals-backend-dynamic"</pre></li><li class="listitem"><p class="simpara">
						(Optional) You can disable the Serverless Logic and Serverless Operators individually or together by setting their values to <code class="literal">false</code>, as shown in the following example:
					</p><pre class="programlisting language-terminal">$ helm install &lt;release_name&gt; openshift-helm-charts/redhat-developer-hub \
  --version 1.9.0 \
  --set orchestrator.enabled=true \
  --set orchestrator.serverlessOperator=false \
  --set orchestrator.serverlessLogicOperator=false</pre></li><li class="listitem"><p class="simpara">
						(Optional) If you are using an external database, add the following configuration under <code class="literal">orchestrator.sonataflowPlatform</code> in your <code class="literal">values.yaml</code> file:
					</p><pre class="programlisting language-yaml">orchestrator:
  sonataflowPlatform:
    externalDBsecretRef: "&lt;cred-secret&gt;"
    externalDBName: "&lt;database_name&gt;" # The name of the user-configured existing database (Not the database that the orchestrator and sonataflow resources use).
    externalDBHost: "&lt;database_host&gt;"
    externalDBPort: "&lt;database_port&gt;"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							This step only configures the Orchestrators use of an external database. To configure Red Hat Developer Hub to use an external PostgreSQL instance, follow the steps in <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/configuring_red_hat_developer_hub/index#proc-configuring-postgresql-instance-using-helm_configuring-external-postgresql-databases">Configuring a PostgreSQL instance using Helm</a>.
						</p></div></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Verify that the Orchestrator plugin is visible in the Red Hat Developer Hub UI.
					</li><li class="listitem">
						Create and run sample workflows to confirm the orchestration is functioning correctly.
					</li></ol></div></section><section class="section" id="proc-install-rhdh-with-orchestrator-helm-webui_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">4.2. Install Red Hat Developer Hub (RHDH) using Helm from the OpenShift Container Platform web console</h3></div></div></div><p>
				You can install Red Hat Developer Hub (RHDH) with the Orchestrator by using the (OpenShift Container Platform) web console. This method is useful if you prefer a graphical interface or want to deploy cluster-wide resources without using the Helm CLI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in to the OpenShift Container Platform web console as an administrator.
					</li><li class="listitem">
						You have access to the Red Hat Developer Hub Helm chart repository.
					</li><li class="listitem">
						Your cluster has internet access or the Helm charts are mirrored in a disconnected environment.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						In the OpenShift Container Platform web console, go to the Helm Charts and verify that the Red Hat Developer Hub Helm chart repository is available.
					</li><li class="listitem"><p class="simpara">
						Search for the Orchestrator infrastructure for Red Hat Developer Hub and select <span class="strong strong"><strong>Install</strong></span>.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You must be an administrator to install the Orchestrator Infrastructure for Red Hat Developer Hub Helm chart because it deploys cluster-scoped resources. As an administrator, you must manually approve the install plans for OpenShift Serverless and Serverless Logic Operators.
						</p></div></div><p class="simpara">
						As a regular user, search for the Red Hat Developer Hub chart and install it by setting the value of <code class="literal">orchestrator.enabled</code> to <code class="literal">true</code>. Otherwise, the Orchestrator will not be deployed.
					</p></li><li class="listitem">
						Wait until they are successfully deployed.
					</li><li class="listitem">
						Monitor the deployment status by navigating to <span class="strong strong"><strong>Pods</strong></span> or releases.
					</li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					After deployment completes:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The orchestrator-related pods are running in the selected namespace.
					</li><li class="listitem">
						Cluster-wide resources are present.
					</li><li class="listitem">
						You can start connecting the orchestrator to your Red Hat Developer Hub UI.
					</li></ul></div></section><section class="section" id="ref-orchestrator-resource-limits_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">4.3. Resource limits for installing Red Hat Developer Hub with the Orchestrator plugin when using Helm</h3></div></div></div><p>
				When installing Red Hat Developer Hub (RHDH) with the Orchestrator plugin using Helm, the chart defines default CPU and memory limits for the <code class="literal">SonataFlowPlatform</code> component.
			</p><p>
				These limits are enforced by the cluster so that pods do not exceed their allocated resources.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Default resource limits
					</li></ol></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 50%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm46594053533664" scope="col"><span class="strong strong"><strong>Resource</strong></span></th><th align="left" valign="top" id="idm46594053532112" scope="col"><span class="strong strong"><strong>Default value</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm46594053533664">
							<p>
								CPU limits
							</p>
							</td><td align="left" valign="top" headers="idm46594053532112">
							<p>
								<code class="literal">500m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594053533664">
							<p>
								Memory limits
							</p>
							</td><td align="left" valign="top" headers="idm46594053532112">
							<p>
								<code class="literal">1Gi</code>
							</p>
							</td></tr></tbody></table></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						You can override these values in any of the following ways:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								With <code class="literal">values.yaml</code>
							</li><li class="listitem">
								With <code class="literal">--set</code> flags
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Override defaults with <code class="literal">values.yaml</code> as shown in the following example:
					</p><pre class="programlisting language-yaml">orchestrator:
  enabled: true
  sonataflowPlatform:
  resources:
      limits:
        cpu: "500m"
        memory: "1Gi"</pre></li><li class="listitem"><p class="simpara">
						Override with <code class="literal">--set</code> as shown in the following example:
					</p><pre class="programlisting language-terminal">$ helm upgrade --install &lt;release_name&gt;  openshift-helm-charts/redhat-developer-hub \
  --set orchestrator.enabled=true \
  --set orchestrator.sonataflowPlatform.resources.requests.cpu=500m \
  --set orchestrator.sonataflowPlatform.resources.requests.memory=128Mi \
  --set orchestrator.sonataflowPlatform.resources.limits.cpu=1 \
  --set orchestrator.sonataflowPlatform.resources.limits.memory=2Gi</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">--set</code> setting is applicable only when <code class="literal">orchestrator.enabled</code> is <code class="literal">true</code>. By default, it is set to <code class="literal">false</code>.
						</p></div></div></li></ol></div></section><section class="section" id="proc-manual-install-orchestrator-plugin_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">4.4. Installing Orchestrator components manually on OpenShift Container Platform</h3></div></div></div><p>
				Use manual installation when you want full control of the setup process and component versions. Manual installation method focuses on setting up the underlying infrastructure.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Install the OpenShift Serverless components manually by following the instructions in the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.37">Red Hat OpenShift Serverless</a> documentation.
					</li><li class="listitem">
						(Optional) If required, deploy a custom PostgreSQL database.
					</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					Prevent workflow context from being lost when the Pod restarts by configuring workflow persistence. You can configure persistence at the namespace level by using the <code class="literal">SonataFlowPlatform</code> or <code class="literal">SonataFlow</code> custom resources (CR). For more information, check the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.37/html-single/serverless_logic/index#serverless-logic-managing-persistence">Managing workflow persistence</a> documentation.
				</p></div></div></section></section><section class="section" id="assembly-install-rhdh-orchestrator-plugin-in-an-air-gapped-environment-operator_install-rhdh-orchestrator"><div class="titlepage"><div><div><h2 class="title">5. Installing Orchestrator plugin in an air-gapped environment with the Operator</h2></div></div></div><p>
			You can configure Red Hat Developer Hub (RHDH) with the Orchestrator plugin in a fully disconnected or partially disconnected environment by using the Operator.
		</p><section class="section" id="proc-install-rhdh-orchestrator-airgapped-env-using-operator-full_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">5.1. Installing Red Hat Developer Hub with Orchestrator in a fully disconnected OpenShift Container Platform environment using the Operator</h3></div></div></div><p>
				You can install Red Hat Developer Hub with Orchestrator plugin in a fully air-gapped environment using the Operator.
			</p><p>
				A disconnected installation prevents unauthorized access, data transfer, or communication with external sources.
			</p><p>
				You can use the helper script to install Red Hat Developer Hub by mirroring the Operator-related images to disk and transferring them to your disconnected environment without any connection to the internet.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have mirrored the Red Hat Developer Hub Operator images to the local registry using the RHDH mirroring script. For more information, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/installing_red_hat_developer_hub_in_an_air-gapped_environment/index#proc-install-rhdh-operator-airgapped-full.adoc_title-install-rhdh-air-grapped"><span class="emphasis"><em>Installing Red Hat Developer Hub in a fully disconnected environment with the Operator</em></span></a>.
					</li><li class="listitem">
						You have set up your disconnected environment using a local registry.
					</li><li class="listitem">
						You have permissions to push NPM packages to an NPM server available in your restricted network.
					</li><li class="listitem">
						You have installed the <a class="link" href="https://docs.redhat.com/en/documentation/openshift_container_platform/4.20/html-single/disconnected_environments/index#installation-oc-mirror-installing-plugin_about-installing-oc-mirror-v2"><code class="literal">oc-mirror</code></a> tool, with a version corresponding to the version of your OpenShift Container Platform cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an <code class="literal">ImageSetConfiguration</code> file for <code class="literal">oc-mirror</code>. You must include the images and operators required by the Serverless Logic Operator in the <code class="literal">ImageSetConfiguration</code> file, as <code class="literal">oc-mirror</code> does not automatically mirror all images. Use the following example:
					</p><pre class="programlisting language-yaml">apiVersion: mirror.openshift.io/v2alpha1
kind: ImageSetConfiguration
mirror:
  additionalimages:
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-db-migrator-tool-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-builder-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-devmode-rhel9:1.37.0
  operators:
    - catalog: registry.redhat.io/redhat/redhat-operator-index:4.20
      # For example: registry.redhat.io/redhat/redhat-operator-index:v4.19
      packages:
      - name: logic-operator-rhel8
        channels:
        - name: alpha
          minVersion: 1.37.0
          maxVersion: 1.37.0
      - name: serverless-operator
        channels:
        - name: stable
          minVersion: 1.37.0
          maxVersion: 1.37.1</pre><p class="simpara">
						Alternatively, you can use <code class="literal">podman</code> commands to find the missing images and add them to the <code class="literal">additionalimages</code> list if the versions change:
					</p><pre class="programlisting language-terminal">IMG=registry.redhat.io/openshift-serverless-1/logic-operator-bundle:1.37.0
mkdir local-manifests-osl
podman create --name temp-container "$IMG" -c "cat /manifests/logic-operator-rhel8.clusterserviceversion.yaml"
podman cp temp-container:/manifests ./local-manifests-osl
podman rm temp-container
yq -r '.data."controllers_cfg.yaml" | from_yaml | .. | select(tag == "!!str") | select(test("^.<span class="strong strong"><strong>\\/.</strong></span>:.*$"))' ./local-manifests-osl/manifests/logic-operator-rhel8-controllers-config_v1_configmap.yaml</pre></li><li class="listitem"><p class="simpara">
						Mirror the images in the <code class="literal">ImageSetConfiguration.yaml</code> file by running the <code class="literal">oc-mirror</code> command. For example:
					</p><pre class="programlisting language-terminal">$ oc-mirror --config=ImageSetConfiguration.yaml file:///path/to/mirror-archive --authfile /path/to/authfile  --v2</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">oc-mirror</code> command generates a local workspace containing the mirror archive files and the required cluster manifests.
						</p></div></div></li><li class="listitem">
						Transfer the directory specified by <code class="literal">/path/to/mirror-archive</code> to a bastion host within your disconnected environment.
					</li><li class="listitem"><p class="simpara">
						From the bastion host which has access to the mirror registry, mirror the images from the disk directory to your target registry. For example:
					</p><pre class="programlisting language-yaml">$ oc-mirror --v2 --from &lt;mirror-archive-file&gt; docker://&lt;target-registry-url:port&gt; --workspace file://&lt;workspace folder&gt; --authfile /path/to/authfile</pre><p class="simpara">
						where:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;mirror-archive-file&gt;</code></span></dt><dd>
									Enter the name of the transferred <code class="literal">tar</code> file.
								</dd><dt><span class="term"><code class="literal">&lt;target-registry-url:port&gt;</code></span></dt><dd>
									Enter your local registry, for example, <code class="literal">registry.localhost:5000</code>.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Apply the cluster-wide resources generated during the push step to redirect all image pulls to your local registry, as shown in the following example:
					</p><pre class="programlisting language-terminal">$ cd &lt;workspace folder&gt;/working-dir/cluster-resources/
$ oc apply -f .</pre></li><li class="listitem"><p class="simpara">
						Download the Node Package Manager (NPM) packages for orchestrator 1.9.0 using any of the following methods:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Download them as <code class="literal">tgz</code> files from the following registry:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz</a>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Alternatively, use the NPM packages from <a class="link" href="https://npm.registry.redhat.com">Red Hat NPM registry</a> as shown in the following example:
							</p><pre class="screen">$ npm pack "@redhat/backstage-plugin-orchestrator@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0 --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0" --registry=https://npm.registry.redhat.com</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Push the NPM packages you have downloaded to your NPM server, as shown in the following example:
					</p><pre class="screen">$ npm publish backstage-plugin-orchestrator-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-form-widgets-1.9.0.tgz
$ npm publish backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</pre></li><li class="listitem">
						Install the OpenShift Serverless Operator and OpenShift Serverless Logic Operators using <code class="literal">OperatorHub</code>.
					</li><li class="listitem">
						Create a Backstage custom resource (CR).
					</li><li class="listitem"><p class="simpara">
						Configure the Backstage CR for the Orchestrator as described in the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/orchestrator_in_red_hat_developer_hub/index#con-orchestrator-plugin-dependencies-operator.adoc_orchestrator-rhdh">Orchestrator plugin dependencies for Operator installation</a>.
					</p><p class="simpara">
						Create all the resources and configure the Backstage instance accordingly. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/red_hat_developer_hub_release_notes/index#removed-functionality-rhdhbugs-2000">Configuring a custom NPM registry</a> for instructions on how to point RHDH towards the custom NPM registry.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart the RHDH pod and wait for the components to deploy properly.
					</li><li class="listitem">
						Once stable, go to the RHDH UI, and confirm that the Orchestrator UI is accessible and functioning correctly.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The successful accessibility of the Orchestrator UI confirms that the underlying components are running and the cluster recognizes the plugin.
				</p></div></div></section><section class="section" id="proc-install-rhdh-orchestrator-airgapped-env-using-operator-partial_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">5.2. Installing Red Hat Developer Hub with Orchestrator in a partially disconnected OpenShift Container Platform environment using the Operator</h3></div></div></div><p>
				You can install Red Hat Developer Hub with Orchestrator plugin in a partial air-gapped environment using the Operator.
			</p><p>
				A disconnected installation prevents unauthorized access, data transfer, or communication with external sources.
			</p><p>
				You can use the <code class="literal">oc-mirror</code> command to mirror resources directly to your accessible local mirror registry and apply the generated cluster resources.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have mirrored the Red Hat Developer Hub Operator images to the local registry using the RHDH mirroring script. For more information, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/installing_red_hat_developer_hub_in_an_air-gapped_environment/index#proc-install-rhdh-operator-airgapped-partial.adoc_title-install-rhdh-air-grapped"><span class="emphasis"><em>Installing Red Hat Developer Hub in a partially disconnected environment with the Operator</em></span></a>.
					</li><li class="listitem">
						You have set up your disconnected environment using a local registry.
					</li><li class="listitem">
						You have permissions to push NPM packages to an NPM server available in your restricted network.
					</li><li class="listitem">
						You have installed the <a class="link" href="https://docs.redhat.com/en/documentation/openshift_container_platform/4.20/html-single/disconnected_environments/index#installation-oc-mirror-installing-plugin_about-installing-oc-mirror-v2"><code class="literal">oc-mirror</code></a> tool, with a version corresponding to the version of your OpenShift Container Platform cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an <code class="literal">ImageSetConfiguration</code> file for <code class="literal">oc-mirror</code>. You must include the images and operators required by the Serverless Logic Operator in the <code class="literal">ImageSetConfiguration</code> file, as <code class="literal">oc-mirror</code> does not automatically mirror all images. Use the following example:
					</p><pre class="programlisting language-yaml">apiVersion: mirror.openshift.io/v2alpha1
kind: ImageSetConfiguration
mirror:
  additionalimages:
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-db-migrator-tool-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-builder-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-devmode-rhel9:1.37.0
  operators:
    - catalog: registry.redhat.io/redhat/redhat-operator-index:4.20
      # For example: registry.redhat.io/redhat/redhat-operator-index:v4.19
      packages:
      - name: logic-operator-rhel8
        channels:
        - name: alpha
          minVersion: 1.37.0
          maxVersion: 1.37.0
      - name: serverless-operator
        channels:
        - name: stable
          minVersion: 1.37.0
          maxVersion: 1.37.1</pre><p class="simpara">
						Alternatively, you can use the <code class="literal">podman</code> commands to find the missing images and add them to the <code class="literal">additionalimages</code> list if the versions change:
					</p><pre class="programlisting language-terminal">IMG=registry.redhat.io/openshift-serverless-1/logic-operator-bundle:1.37.0
mkdir local-manifests-osl
podman create --name temp-container "$IMG" -c "cat /manifests/logic-operator-rhel8.clusterserviceversion.yaml"
podman cp temp-container:/manifests ./local-manifests-osl
podman rm temp-container
yq -r '.data."controllers_cfg.yaml" | from_yaml | .. | select(tag == "!!str") | select(test("^.<span class="strong strong"><strong>\\/.</strong></span>:.*$"))' ./local-manifests-osl/manifests/logic-operator-rhel8-controllers-config_v1_configmap.yaml</pre></li><li class="listitem"><p class="simpara">
						Mirror the images in the <code class="literal">ImageSetConfiguration.yaml</code> file by running the <code class="literal">oc-mirror</code> command. For example:
					</p><pre class="programlisting language-terminal">$ oc-mirror --config=imagesetconfiguration.yaml docker://&lt;registry URL:port&gt; --workspace file://&lt;workspace folder&gt; --authfile /path/to/authfile  --v2
$ cd &lt;workspace folder&gt;/working-dir/cluster-resources/
$ oc apply -f .</pre></li><li class="listitem"><p class="simpara">
						Download the Node Package Manager (NPM) packages for orchestrator 1.9.0 using any of the following methods:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Download them as <code class="literal">tgz</code> files from the following registry:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz</a>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Alternatively, use the NPM packages from <a class="link" href="https://npm.registry.redhat.com">Red Hat NPM registry</a> as shown in the following example:
							</p><pre class="screen">$ npm pack "@redhat/backstage-plugin-orchestrator@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0 --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0" --registry=https://npm.registry.redhat.com</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Push the NPM packages you have downloaded to your NPM server, as shown in the following example:
					</p><pre class="screen">$ npm publish backstage-plugin-orchestrator-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-form-widgets-1.9.0.tgz
$ npm publish backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</pre></li><li class="listitem">
						Install the OpenShift Serverless Operator and OpenShift Serverless Logic Operators using <code class="literal">OperatorHub</code>.
					</li><li class="listitem">
						Create a Backstage custom resource (CR).
					</li><li class="listitem"><p class="simpara">
						Configure the Backstage CR for the Orchestrator as described in the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/orchestrator_in_red_hat_developer_hub/index#con-orchestrator-plugin-dependencies-operator_orchestrator-rhdh">Orchestrator plugin dependencies for Operator installation</a>.
					</p><p class="simpara">
						Create all the resources and configure the Backstage instance accordingly. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/red_hat_developer_hub_release_notes/index#removed-functionality-rhdhbugs-2000">Configuring a custom NPM registry</a> for instructions on how to point RHDH towards the custom NPM registry.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart the RHDH pod and wait for the components to deploy properly.
					</li><li class="listitem">
						Once stable, go to the RHDH UI, and confirm that the Orchestrator UI is accessible and functioning correctly.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The successful accessibility of the Orchestrator UI confirms that the underlying components are running and the cluster recognizes the plugin.
				</p></div></div></section></section><section class="section" id="assembly-install-rhdh-orchestrator-plugin-in-an-air-gapped-environment-helm_install-rhdh-orchestrator"><div class="titlepage"><div><div><h2 class="title">6. Installing Orchestrator plugin in an air-gapped environment with the Helm chart</h2></div></div></div><p>
			You can configure Red Hat Developer Hub (RHDH) with the Orchestrator plugin in a fully disconnected or partially disconnected environment by using the Helm chart.
		</p><section class="section" id="proc-install-rhdh-orchestrator-airgapped-env-using-helm-chart-full_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">6.1. Installing Red Hat Developer Hub with Orchestrator in a fully disconnected OpenShift Container Platform environment using the Helm chart</h3></div></div></div><p>
				You can install Red Hat Developer Hub (RHDH) with the Orchestrator plugin in a fully air-gapped OpenShift Container Platform environment using the Helm chart.
			</p><p>
				You can mirror images to an intermediary disk, and then mirror from the disk to your target local registry and apply the generated cluster resources.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have set up your disconnected environment using a local registry.
					</li><li class="listitem">
						You have permissions to push NPM packages to an NPM server available in your restricted network.
					</li><li class="listitem">
						You have installed the <a class="link" href="https://docs.redhat.com/en/documentation/openshift_container_platform/4.20/html-single/disconnected_environments/index#installation-oc-mirror-installing-plugin_about-installing-oc-mirror-v2"><code class="literal">oc-mirror</code></a> tool, with a version corresponding to the version of your OpenShift Container Platform cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an <code class="literal">ImageSetConfiguration.yaml</code> file for <code class="literal">oc-mirror</code>. You must use an <code class="literal">ImageSetConfiguration</code> file to include all mirrored images required by the Serverless Logic Operator, as shown in the following example:
					</p><pre class="programlisting language-yaml">apiVersion: mirror.openshift.io/v2alpha1
kind: ImageSetConfiguration
mirror:
  additionalimages:
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-db-migrator-tool-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-builder-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-devmode-rhel9:1.37.0

  helm:
    repositories:
      - name: openshift-charts
        url: https://charts.openshift.io
        charts:
          - name: redhat-developer-hub
            version: "1.9.0"
          - name: redhat-developer-hub-orchestrator-infra
            version: "1.9.0"
  operators:
    - catalog: registry.redhat.io/redhat/redhat-operator-index:4.20
      # For example: registry.redhat.io/redhat/redhat-operator-index:v4.19
      packages:
      - name: logic-operator-rhel8
        channels:
        - name: alpha
          minVersion: 1.37.0
          maxVersion: 1.37.0
      - name: serverless-operator
        channels:
        - name: stable
          minVersion: 1.37.0
          maxVersion: 1.37.1</pre><p class="simpara">
						Alternatively, you can use <code class="literal">podman</code> commands to find the missing images and add them to the <code class="literal">additionalimages</code> list if the versions change:
					</p><pre class="programlisting language-terminal">IMG=registry.redhat.io/openshift-serverless-1/logic-operator-bundle:1.37.0
mkdir local-manifests-osl
podman create --name temp-container "$IMG" -c "cat /manifests/logic-operator-rhel8.clusterserviceversion.yaml"
podman cp temp-container:/manifests ./local-manifests-osl
podman rm temp-container
yq -r '.data."controllers_cfg.yaml" | from_yaml | .. | select(tag == "!!str") | select(test("^.<span class="strong strong"><strong>\\/.</strong></span>:.*$"))' ./local-manifests-osl/manifests/logic-operator-rhel8-controllers-config_v1_configmap.yaml</pre></li><li class="listitem"><p class="simpara">
						Mirror the images in the <code class="literal">ImageSetConfiguration.yaml</code> file by running the <code class="literal">oc-mirror</code> command. For example:
					</p><pre class="programlisting language-terminal">$ oc-mirror --config=ImageSetConfiguration.yaml file:///path/to/mirror-archive --authfile /path/to/authfile  --v2</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">oc-mirror</code> command pulls the charts listed in the <code class="literal">ImageSetConfiguration</code> file and makes them available as <code class="literal">tgz</code> archives under the <code class="literal">/path/to/mirror-archive</code> directory.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Apply the cluster-wide resources generated during the push step to redirect all image pulls to your local registry, as shown in the following example:
					</p><pre class="programlisting language-terminal">$ cd &lt;workspace folder&gt;/working-dir/cluster-resources/
$ oc apply -f .</pre></li><li class="listitem">
						Transfer the generated mirror archive file, for example, <code class="literal">/path/to/mirror-archive/mirror_000001.tar</code>, to a bastion host within your disconnected environment.
					</li><li class="listitem"><p class="simpara">
						From the bastion host in your disconnected environment, which has access to the mirror registry, mirror the images from the archive file to your target registry. For example:
					</p><pre class="programlisting language-terminal">$ oc-mirror --v2 --from &lt;mirror-archive-file&gt; docker://&lt;target-registry-url:port&gt; --workspace file://&lt;workspace folder&gt; --authfile /path/to/authfile</pre><p class="simpara">
						where:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;mirror-archive-file&gt;</code></span></dt><dd>
									Enter the name of the transferred <code class="literal">tar</code> file.
								</dd><dt><span class="term"><code class="literal">&lt;target-registry-url:port&gt;</code></span></dt><dd>
									Enter your local registry, for example, <code class="literal">registry.localhost:5000</code>.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Download the Node Package Manager (NPM) packages for orchestrator 1.9.0 using any of the following methods:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Download them as <code class="literal">tgz</code> files from the following registry:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz</a>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Alternatively, use the NPM packages from <a class="link" href="https://npm.registry.redhat.com">Red Hat NPM registry</a> as shown in the following example:
							</p><pre class="screen">$ npm pack "@redhat/backstage-plugin-orchestrator@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0 --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0" --registry=https://npm.registry.redhat.com</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Push the NPM packages you have downloaded to your NPM server, as shown in the following example:
					</p><pre class="screen">$ npm publish backstage-plugin-orchestrator-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-form-widgets-1.9.0.tgz
$ npm publish backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</pre></li><li class="listitem">
						Apply the <code class="literal">redhat-developer-hub-orchestrator-infra</code> Helm chart and approve the install plans. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/installing_red_hat_developer_hub_in_an_air-gapped_environment/index#assembly-install-rhdh-airgapped-environment-ocp-helm_title-install-rhdh-air-grapped">Air-gapped installation with Helm chart instructions</a> for details.
					</li><li class="listitem"><p class="simpara">
						Apply the RHDH 1.9 Helm chart. Include the version 1.9.0 and enable the Orchestrator plugin, as shown in the following example:
					</p><pre class="programlisting language-yaml">orchestrator.enabled=true</pre></li><li class="listitem"><p class="simpara">
						The RHDH 1.9 Helm chart defaults to pulling Orchestrator plugins from the official Red Hat NPM registry using full URL references. You must override this behavior to point to your local registry.
					</p><p class="simpara">
						To configure the Orchestrator plugins to use a custom registry, complete the following steps:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Open your <code class="literal">values.yaml</code> file.
							</li><li class="listitem"><p class="simpara">
								List the Orchestrator plugin packages under the <code class="literal">orchestrator.plugins</code> section. You must replace the simplified package references with the full URLs that point to your custom NPM registry, as shown in the following example:
							</p><pre class="programlisting language-yaml">orchestrator:
  plugins:
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-{product-bundle-version}.tgz
      integrity: sha512-xxxxxx
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-{product-bundle-version}.tgz
      integrity: sha512-xxxxxy
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-{product-bundle-version}.tgz
      integrity: sha512-xxxxxz
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-{product-bundle-version}.tgz
      integrity: sha512-xxxx1</pre><p class="simpara">
								where:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;custom_NPM_registry_URL&gt;</code></span></dt><dd>
											Enter the address of your custom registry and make sure the integrity checksum, such as sha512-xxxxxx, matches the files in your registry.
										</dd></dl></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart the RHDH Pod and wait for the components to deploy properly.
					</li><li class="listitem">
						After deployment is complete, go to the <span class="strong strong"><strong>RHDH</strong></span> UI and confirm that the <span class="strong strong"><strong>Orchestrator</strong></span> UI is accessible and functioning correctly.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The successful accessibility of the Orchestrator UI confirms that the underlying components are running and the cluster recognizes the plugin.
				</p></div></div></section><section class="section" id="proc-install-rhdh-orchestrator-airgapped-env-using-helm-chart-partial_install-rhdh-orchestrator"><div class="titlepage"><div><div><h3 class="title">6.2. Installing Red Hat Developer Hub with Orchestrator in a partially disconnected OpenShift Container Platform environment using the Helm chart</h3></div></div></div><p>
				You can install Red Hat Developer Hub (RHDH) with the Orchestrator plugin in a partial OpenShift Container Platform environment using the Helm chart.
			</p><p>
				A disconnected installation prevents unauthorized access, data transfer, or communication with external sources.
			</p><p>
				You can use the <code class="literal">oc-mirror</code> command to mirror resources directly to your accessible local registry and apply the generated cluster resources.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have set up your disconnected environment using a local registry.
					</li><li class="listitem">
						You have permissions to push NPM packages to an NPM server available in your restricted network.
					</li><li class="listitem">
						You have installed the <a class="link" href="https://docs.redhat.com/en/documentation/openshift_container_platform/4.20/html-single/disconnected_environments/index#installation-oc-mirror-installing-plugin_about-installing-oc-mirror-v2"><code class="literal">oc-mirror</code></a> tool, with a version corresponding to the version of your OpenShift Container Platform cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an <code class="literal">ImageSetConfiguration</code> file for <code class="literal">oc-mirror</code>. You must include the images and operators required by the Serverless Logic Operator in the <code class="literal">ImageSetConfiguration</code> file, as <code class="literal">oc-mirror</code> does not automatically mirror all images. Use the following example:
					</p><pre class="programlisting language-yaml">apiVersion: mirror.openshift.io/v2alpha1
kind: ImageSetConfiguration
mirror:
  additionalimages:
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-jobs-service-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-postgresql-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-data-index-ephemeral-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-db-migrator-tool-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-builder-rhel9:1.37.0
  - name: registry.redhat.io/openshift-serverless-1/logic-swf-devmode-rhel9:1.37.0

  helm:
    repositories:
      - name: openshift-charts
        url: https://charts.openshift.io
        charts:
          - name: redhat-developer-hub
            version: "1.9.0"
          - name: redhat-developer-hub-orchestrator-infra
            version: "1.9.0"
  operators:
    - catalog: registry.redhat.io/redhat/redhat-operator-index:4.20
      # For example: registry.redhat.io/redhat/redhat-operator-index:v4.19
      packages:
      - name: logic-operator-rhel8
        channels:
        - name: alpha
          minVersion: 1.37.0
          maxVersion: 1.37.0
      - name: serverless-operator
        channels:
        - name: stable
          minVersion: 1.37.0
          maxVersion: 1.37.1</pre></li><li class="listitem"><p class="simpara">
						Mirror the images in the <code class="literal">ImageSetConfiguration.yaml</code> file by running the <code class="literal">oc-mirror</code> command to pull images and charts, and push the images directly to the target registry. For example:
					</p><pre class="programlisting language-terminal">$ oc-mirror --config=imagesetconfiguration.yaml docker://&lt;registry URL:port&gt; --workspace file://&lt;workspace folder&gt; --authfile /path/to/authfile  --v2</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">oc-mirror</code> command pulls the charts listed in the <code class="literal">ImageSetConfiguration</code> file and makes them available as <code class="literal">tgz</code> archives under the <code class="literal">&lt;workspace folder&gt;</code> directory.
						</p></div></div></li><li class="listitem"><p class="simpara">
						Apply the generated cluster resources to the disconnected cluster. For example:
					</p><pre class="programlisting language-terminal">$ cd &lt;workspace folder&gt;/working-dir/cluster-resources/
$ oc apply -f .</pre></li><li class="listitem"><p class="simpara">
						Download the Node Package Manager (NPM) packages for orchestrator 1.9.0 using any of the following methods:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Download them as <code class="literal">tgz</code> files from the following registry:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</a>
									</li><li class="listitem">
										<a class="link" href="https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz">https://npm.registry.redhat.com/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-1.9.0.tgz</a>
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Alternatively, use the NPM packages from <a class="link" href="https://npm.registry.redhat.com">Red Hat NPM registry</a> as shown in the following example:
							</p><pre class="screen">$ npm pack "@redhat/backstage-plugin-orchestrator@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-backend-dynamic@1.9.0" --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic@1.9.0 --registry=https://npm.registry.redhat.com
$ npm pack "@redhat/backstage-plugin-orchestrator-form-widgets@1.9.0" --registry=https://npm.registry.redhat.com</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Push the NPM packages you have downloaded to your NPM server, as shown in the following example:
					</p><pre class="screen">$ npm publish backstage-plugin-orchestrator-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-backend-dynamic-1.9.0.tgz
$ npm publish backstage-plugin-orchestrator-form-widgets-1.9.0.tgz
$ npm publish backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-1.9.0.tgz</pre></li><li class="listitem">
						Apply the <code class="literal">redhat-developer-hub-orchestrator-infra</code> Helm chart and approve the install plans. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/installing_red_hat_developer_hub_in_an_air-gapped_environment/index#assembly-install-rhdh-airgapped-environment-ocp-helm_title-install-rhdh-air-grapped">Air-gapped installation with Helm chart instructions</a> for details.
					</li><li class="listitem"><p class="simpara">
						Apply the RHDH 1.9 Helm chart. Include the version 1.9.0 and enable the Orchestrator plugin, as shown in the following example:
					</p><pre class="programlisting language-yaml">orchestrator.enabled=true</pre></li><li class="listitem"><p class="simpara">
						The RHDH 1.9 Helm chart defaults to pulling Orchestrator plugins from the official Red Hat NPM registry using full URL references. You must override this behavior to point to your local registry.
					</p><p class="simpara">
						To configure the Orchestrator plugins to use a custom registry, complete the following steps:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Open your <code class="literal">values.yaml</code> file.
							</li><li class="listitem"><p class="simpara">
								Explicitly list the Orchestrator plugin packages under the <code class="literal">orchestrator.plugins</code> section.
							</p><p class="simpara">
								You must replace the simplified package references with the full URLs that point to your custom NPM registry, as shown in the following example:
							</p><pre class="programlisting language-yaml">orchestrator:
  plugins:
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator-backend-dynamic/-/backstage-plugin-orchestrator-backend-dynamic-{product-bundle-version}.tgz
      integrity: sha512-xxxxxx
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator/-/backstage-plugin-orchestrator-{product-bundle-version}.tgz
      integrity: sha512-xxxxxy
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-orchestrator-form-widgets/-/backstage-plugin-orchestrator-form-widgets-{product-bundle-version}.tgz
      integrity: sha512-xxxxxz
    - disabled: false
      package: &lt;custom_NPM_registry_URL&gt;[:&lt;port&gt;]/@redhat/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic/-/backstage-plugin-scaffolder-backend-module-orchestrator-dynamic-{product-bundle-version}.tgz
      integrity: sha512-xxxx1</pre><p class="simpara">
								where:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">&lt;custom_NPM_registry_URL&gt;</code></span></dt><dd>
											Enter the address of your custom registry and make sure the integrity checksum, such as sha512-xxxxxx, matches the files in your registry.
										</dd></dl></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Restart the RHDH pod and wait for the components to deploy properly.
					</li><li class="listitem">
						After deployment is complete, go to the <span class="strong strong"><strong>RHDH</strong></span> UI and confirm that the Orchestrator UI is accessible and functioning correctly.
					</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The successful accessibility of the Orchestrator UI confirms that the underlying components are running and the cluster recognizes the plugin.
				</p></div></div></section></section><section class="section" id="assembly-configuring-orchestrator"><div class="titlepage"><div><div><h2 class="title">7. Integrating Loki Logs to debug Orchestrator workflows</h2></div></div></div><p>
			You can configure the Orchestrator backend to integrate external services and support serverless workflows. For detailed workflow debugging, integrate a log provider.
		</p><section class="section" id="proc-integrating-loki-logs-for-orchestrator-workflows_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">7.1. Integrating Loki logs for Orchestrator workflows</h3></div></div></div><p>
				To troubleshoot and debug errors, integrate Loki logs into the Red Hat Developer Hub interface. You must install the Loki backend module and configure the connection details.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed and integrated the Orchestrator backend plugin in your Red Hat Developer Hub instance.
					</li><li class="listitem">
						You have a running Loki instance.
					</li><li class="listitem">
						You have stored your Orchestrator logs in the Loki instance.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Loki backend module by entering the following command in your root directory:
					</p><pre class="programlisting language-terminal">$ yarn workspace backend add @red-hat-developer-hub/backstage-plugin-orchestrator-backend-module-loki</pre></li><li class="listitem"><p class="simpara">
						Import the new backend module into your <code class="literal">packages/backend/src/index.ts</code> file:
					</p><pre class="programlisting language-yaml">import { createBackend } from '@backstage/backend-defaults';
const backend = createBackend();

// orchestrator backend
backend.add(
  import('@red-hat-developer-hub/backstage-plugin-orchestrator-backend'),
);

// orchestrator Log Provider
backend.add(
  import('@red-hat-developer-hub/backstage-plugin-orchestrator-backend-module-loki'),
);

backend.start();</pre></li><li class="listitem"><p class="simpara">
						Add the Loki workflow log provider integration to the <span class="strong strong"><strong>orchestrator</strong></span> section of your application <code class="literal">app-config.yaml</code> file:
					</p><pre class="programlisting language-yaml">orchestrator:
  workflowLogProvider:
    loki:
      baseUrl: http://localhost:3100
      # logStreamSelectors:
      #   - label: 'app'
      #     value: '=\~".+"'</pre><p class="simpara">
						where:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">baseUrl</code></span></dt><dd>
									Specifies the base URL of your Loki instance. This value is required.
								</dd><dt><span class="term"><code class="literal">logStreamSelectors</code></span></dt><dd>
									Specifies log stream selectors to filter the logs. By default, the plugin retrieves all logs. For more information about selector syntax, see the <a class="link" href="https://grafana.com/docs/loki/latest/query/log_queries/#log-stream-selector">Grafana Loki documentation</a>.
								</dd></dl></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Navigate to the Orchestrator plugin in the RHDH interface.
					</li><li class="listitem">
						Select a workflow instance.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>View Logs</strong></span> to display the workflow instance logs.
					</li></ul></div></section></section><section class="section" id="assembly-building-and-deploying-serverless-workflows"><div class="titlepage"><div><div><h2 class="title">8. Build and deploy serverless workflows</h2></div></div></div><p>
			To deploy a workflow and make it available in the Orchestrator plugin, follow these main steps:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Building workflow images
				</li><li class="listitem">
					Generating workflow manifests
				</li><li class="listitem">
					Deploying workflows to a cluster
				</li></ul></div><p>
			This process moves the workflow from your local machine to deployment on a cluster.
		</p><section class="section" id="con-benefits-of-workflow-images_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">8.1. Benefits of workflow images</h3></div></div></div><p>
				While the OpenShift Serverless Logic Operator supports the building of workflows dynamically, this approach is primarily for experimentation. For production deployments, building images is the preferred method due to the following reasons:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Production readiness: Prebuilt images can be scanned, secured, and tested before going live.
					</li><li class="listitem">
						GitOps compatibility: The Orchestrator relies on a central OpenShift Serverless Logic Operator instance to track workflows and their state. To use this tracking service, you must deploy workflows with the <code class="literal">gitops</code> profile, which expects a prebuilt image.
					</li><li class="listitem">
						Testing and quality: Building an image gives you more control over the testing process.
					</li></ul></div><section class="section" id="con-project-structure-overview_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.1.1. Project structure overview</h4></div></div></div><p>
					The project utilizes <span class="strong strong"><strong>Quarkus project layout</strong></span> (Maven project structure). This structure is illustrated by the following <code class="literal">01_basic</code> workflow example:
				</p><pre class="programlisting language-yaml">01_basic
├── pom.xml
├── README.md
└── src
    └── main
        ├── docker
        │   ├── Dockerfile.jvm
        │   ├── Dockerfile.legacy-jar
        │   ├── Dockerfile.native
        │   └── Dockerfile.native-micro
        └── resources
            ├── application.properties
            ├── basic.svg
            ├── basic.sw.yaml
            ├── schemas
            │   ├── basic__main-schema.json
            │   └── workflow-output-schema.json
            └── secret.properties</pre><p>
					The main workflow resources are located under the <code class="literal">src/main/resources/</code> directory.
				</p><p>
					The <code class="literal">kn-workflow CLI</code> generated this project structure. You can try generating the structure yourself by following the <span class="emphasis"><em>Getting Started guide</em></span>. For more information on the Quarkus project, see <a class="link" href="https://quarkus.io/guides/getting-started">Creating your first application</a>.
				</p></section><section class="section" id="proc-creating-and-running-workflows_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.1.2. Creating and running your serverless workflow project locally</h4></div></div></div><p>
					The <code class="literal">kn-workflow</code> CLI is an essential tool that generates workflow manifests and project structures. To ensure successful development and immediate testing, begin developing a new serverless workflow locally by completing the following steps:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Use the <code class="literal">kn-workflow</code> CLI to create a new workflow project, which adheres to the Quarkus structure as shown in the following example:
						</p><pre class="programlisting language-bash">$ kn-workflow quarkus create --name &lt;specify project name, for example ,00_new_project&gt;</pre></li><li class="listitem"><p class="simpara">
							Edit the workflow, add schema and specific files, and run it locally from project folder as shown in the following example:
						</p><pre class="programlisting language-bash">$ kn-workflow quarkus run</pre></li><li class="listitem"><p class="simpara">
							Run the workflow locally using the <code class="literal">kn-workflow run</code> which pulls the following image:
						</p><pre class="programlisting language-yaml">registry.redhat.io/openshift-serverless-1/logic-swf-devmode-rhel8:1.36.0</pre></li><li class="listitem"><p class="simpara">
							For building the workflow image, the <code class="literal">kn-workflow</code> CLI pulls the following images:
						</p><pre class="programlisting language-yaml">registry.redhat.io/openshift-serverless-1/logic-swf-builder-rhel8:1.36.0-8
registry.access.redhat.com/ubi9/openjdk-17:1.21-2</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://openshift-knative.github.io/docs/docs/latest/serverless-logic/about.html">About OpenShift Serverless Logic</a>
						</li><li class="listitem">
							<a class="link" href="https://redhat-scholars.github.io/serverless-workflow/osl/index.html">OpenShift Serverless Logic Tutorial</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/configuring_red_hat_developer_hub/index#running-behind-a-proxy">Running Red Hat Developer Hub behind a corporate proxy</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_build_of_quarkus/3.15/html-single/getting_started_with_red_hat_build_of_quarkus/index#proc_online-maven_quarkus-getting-started">Using the Red Hat-hosted Quarkus repository</a>
						</li></ul></div></section></section><section class="section" id="proc-building-locally_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">8.2. Building workflow images locally</h3></div></div></div><p>
				You can use the build script (<code class="literal">build.sh</code>) to build workflow images. You can run it either locally or inside a container. This section highlights how build workflow images locally.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Clone the project as shown in the following example:
					</p><pre class="programlisting language-yaml">git clone git@github.com:rhdhorchestrator/orchestrator-demo.git
cd orchestrator-demo</pre></li><li class="listitem"><p class="simpara">
						Check the help menu of the script:
					</p><pre class="programlisting language-yaml">./scripts/build.sh --help</pre></li><li class="listitem"><p class="simpara">
						Run the <code class="literal">build.sh</code> script, providing the required flags, for instance, the image path (<code class="literal">-i</code>), workflow source directory (<code class="literal">-w</code>), and manifests output directory (<code class="literal">-m</code>).
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							You must specify the full target image path with a tag as shown in the following example:
						</p><pre class="programlisting language-yaml">./scripts/build.sh --image=quay.io/orchestrator/demo-basic:test -w 01_basic/ -m 01_basic/manifests</pre></div></div></li></ol></div><section class="section" id="con-build-sh-script-and-its-uses_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.2.1. The <code class="literal">build-sh</code> script functionality and important flags</h4></div></div></div><p>
					The <code class="literal">build-sh</code> script does the following tasks in order:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Generates workflow manifests using the <code class="literal">kn-workflow</code> CLI.
						</li><li class="listitem">
							Builds the workflow image using <code class="literal">podman</code> or <code class="literal">docker</code>.
						</li><li class="listitem">
							Optional: The script pushes the images to an image registry and deploys the workflow using <code class="literal">kubectl</code>.
						</li></ul></div><p>
					You can review the script configuration options and see available flags and their functions by accessing the help menu:
				</p><pre class="programlisting language-bash">./scripts/build.sh [flags]</pre><p>
					The following flags are essential for running the script:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 75%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm46594052651760" scope="col">Flag</th><th align="left" valign="top" id="idm46594052650672" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">-i</code>, <code class="literal">--image</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Required: Full image path, for example, <code class="literal">quay.io/orchestrator/demo:latest</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">-w</code>, <code class="literal">--workflow-directory</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Workflow source directory (default is the current directory)
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">-m</code>, <code class="literal">--manifests-directory</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Where to save generated manifests
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">--push</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Push the image to the registry
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">--deploy</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Deploy the workflow
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052651760">
								<p>
									<code class="literal">-h</code>, <code class="literal">--help</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052650672">
								<p>
									Show the help message
								</p>
								</td></tr></tbody></table></div><div class="admonition tip"><div class="admonition_header">Tip</div><div><p>
					The script also supports builder and runtime image overrides, namespace targeting, and persistence flags.
				</p></div></div></section><section class="section" id="con-environment-variables-supported-by-the-build-script_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.2.2. Environment variables supported by the build script</h4></div></div></div><p>
					The <code class="literal">build-sh</code> script supports the following environment variables to customize the workflow build process without modifying the script itself:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">QUARKUS_EXTENSIONS</code></span></dt><dd><p class="simpara">
								The <code class="literal">QUARKUS_EXTENSIONS</code> variable specifies additional <a class="link" href="https://quarkus.io/extensions/">Quarkus</a> extensions required by the workflow. This variable takes the format of a comma-separated list of fully qualified extension IDs as shown in the following example:
							</p><pre class="programlisting language-yaml">export QUARKUS_EXTENSIONS="io.quarkus:quarkus-smallrye-reactive-messaging-kafka"</pre><p class="simpara">
								Add Kafka messaging support or other integrations at build time.
							</p></dd><dt><span class="term"><code class="literal">MAVEN_ARGS_APPEND</code></span></dt><dd><p class="simpara">
								The <code class="literal">MAVEN_ARGS_APPEND</code> variable appends additional arguments to the <span class="strong strong"><strong>Maven build</strong></span> command. This variable takes the format of a string of Maven CLI arguments as shown in the following example:
							</p><pre class="programlisting language-yaml">export MAVEN_ARGS_APPEND="-DmaxYamlCodePoints=35000000"</pre><p class="simpara">
								Control build behavior. For example, set <code class="literal">maxYamlCodePoints</code> parameter that controls the maximum input size for YAML input files to 35000000 characters (~33MB in UTF-8).
							</p></dd></dl></div></section><section class="section" id="con-required-tools_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.2.3. Required tools</h4></div></div></div><p>
					To run the <code class="literal">build-sh</code> script locally and manage the workflow lifecycle, you must install the following command-line tools:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 75%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm46594052834560" scope="col">Tool</th><th align="left" valign="top" id="idm46594052833472" scope="col">Conceptual Purpose.</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									podman or docker
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									Container runtime required for building the workflow images.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									<code class="literal">kubectl</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									Kubernetes CLI.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									<code class="literal">yq</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									YAML processor.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									<code class="literal">jq</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									JSON processor.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									<code class="literal">curl</code>, <code class="literal">git</code>, <code class="literal">find</code>, <code class="literal">which</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									Shell utilities.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm46594052834560">
								<p>
									<code class="literal">kn-workflow</code>
								</p>
								</td><td align="left" valign="top" headers="idm46594052833472">
								<p>
									CLI for generating workflow manifests.
								</p>
								</td></tr></tbody></table></div></section><section class="section" id="proc-building-the-01-basic-workflow_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">8.2.4. Building the <code class="literal">01_basic</code> workflow</h4></div></div></div><p>
					To run the script from the root directory of the repository, you must use the <code class="literal">-w</code> flag to point to the workflow directory. Additionally, specify the output directory with the <code class="literal">-m</code> flag.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have specified the target image using a tag.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the following command:
						</p><pre class="programlisting language-bash">$ ./scripts/build.sh --image=quay.io/orchestrator/demo-basic:test -w 01_basic/ -m 01_basic/manifests</pre><p class="simpara">
							This build command produces the following two artifacts:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A workflow image and Kubernetes manifests: <code class="literal">quay.io/orchestrator/demo-basic:test</code> and tagged as <code class="literal">latest</code>.
								</li><li class="listitem">
									Kubernetes manifests under: <code class="literal">01_basic/manifests/</code>
								</li></ul></div></li><li class="listitem">
							Optional: You can add the <code class="literal">--push</code> flag to automatically push the image after building. Otherwise, pushing manually is mandatory before deploying.
						</li></ol></div></section></section><section class="section" id="con-generated-workflow-manifests_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">8.3. Generated workflow manifests</h3></div></div></div><p>
				The following example is an illustration of what is generated under the <code class="literal">01_basic/manifests</code>:
			</p><pre class="programlisting language-yaml">01_basic/manifests
├── 00-secret_basic-secrets.yaml
├── 01-configmap_basic-props.yaml
├── 02-configmap_01-basic-resources-schemas.yaml
└── 03-sonataflow_basic.yaml</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">00-secret_basic-secrets.yaml</code></span></dt><dd>
							Contains secrets from <code class="literal">01_basic/src/main/resources/secret.properties</code>. Values are not required at this stage as you can set them later after applying CRs or when using GitOps.
						</dd></dl></div><div class="informalexample"><p>
				In OpenShift Serverless Logic <code class="literal">v1.36</code>, after updating a secret, you must manually restart the workflow Pod for changes to apply.
			</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">01-configmap_basic-props.yaml</code></span></dt><dd>
							Holds application properties from application.properties. Any change to this ConfigMap triggers an automatic Pod restart.
						</dd><dt><span class="term"><code class="literal">02-configmap_01-basic-resources-schemas.yaml</code></span></dt><dd><p class="simpara">
							Contains JSON schemas from src/main/resources/schemas.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You do not need to deploy certain configuration resources when using the GitOps profile.
							</p></div></div></dd><dt><span class="term"><code class="literal">03-sonataflow_basic.yaml</code></span></dt><dd><p class="simpara">
							The SonataFlow custom resource (CR) that defines the workflow.
						</p><pre class="programlisting language-yaml">podTemplate:
  container:
    image: quay.io/orchestrator/demo-basic
    resources: {}
    envFrom:
      - secretRef:
          name: basic-secrets</pre><pre class="programlisting language-yaml">persistence:
  postgresql:
    secretRef:
      name: <code class="literal">sonataflow-psql-postgresql</code>
      userKey: <code class="literal"><span class="emphasis"><em>&lt;your_postgres_username&gt;</em></span></code>
      passwordKey: <code class="literal"><span class="emphasis"><em>&lt;your_postgres_password&gt;</em></span></code>
    serviceRef:
      name: <code class="literal">sonataflow-psql-postgresql</code>
      port: 5432
      databaseName: sonataflow
      databaseSchema: basic</pre><p class="simpara">
							where:
						</p></dd><dt><span class="term"><code class="literal">postgresql:secretRef:name</code></span></dt><dd>
							Enter the Secret name for your deployment.
						</dd><dt><span class="term"><code class="literal">postgresql:secretRef:userKey</code></span></dt><dd>
							Enter the key for your deployment.
						</dd><dt><span class="term"><code class="literal">postgresql:secretRef:passwordKey</code></span></dt><dd>
							Enter the password for your deployment.
						</dd><dt><span class="term"><code class="literal">postgresql:serviceRef:name</code></span></dt><dd><p class="simpara">
							Enter the Service name for your deployment.
						</p><p class="simpara">
							If you must connect to an external database, replace <code class="literal">serviceRef</code> with <code class="literal">jdbcUrl</code>. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.36/html-single/serverless_logic/index#serverless-logic-managing-persistence">Managing workflow persistence</a>.
						</p></dd></dl></div><p>
				By default, the script generates all the manifests without a namespace. You can specify a namespace to the script by using the <code class="literal">--namespace</code> flag if you know the target namespace in advance. Otherwise, you must provide the namespace when applying the manifests to the cluster. See <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.36/html-single/serverless_logic/index#serverless-logic-configuring-workflow-services">Configuring workflow services</a>.
			</p></section><section class="section" id="proc-deploying-workflows-on-a-cluster_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">8.4. Deploying workflows on a cluster</h3></div></div></div><p>
				You can deploy the workflow on a cluster, because the image is pushed to the image registry and the deployment manifests are available.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have an OpenShift Container Platform cluster with the following versions of components installed:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Red Hat Developer Hub (RHDH) 1.9
							</li><li class="listitem">
								Orchestrator plugins 1.9.0
							</li><li class="listitem">
								OpenShift Serverless <code class="literal">v1.36</code>
							</li><li class="listitem"><p class="simpara">
								OpenShift Serverless Logic <code class="literal">v1.36</code>
							</p><p class="simpara">
								For instructions on how to install these components, see the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/orchestrator_in_red_hat_developer_hub/index#con-orchestrator-plugin-components.adoc_orchestrator-rhdh">Orchestrator plugin components on OpenShift Container Platform</a>.
							</p></li></ul></div></li><li class="listitem">
						You must apply the workflow manifests in a namespace that contains a <code class="literal">SonataflowPlatform</code> custom resource (CR), which manages the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_openshift_serverless/1.36/html-single/serverless_logic/index#serverless-logic-configuring-workflow-services">supporting services</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal">kubectl create</code> command specifying the target namespace to apply the Kubernetes manifests as shown in the following example:
					</p><pre class="programlisting language-bash">$ kubectl create -n &lt;your_namespace&gt; -f ./01_basic/manifests/.</pre></li><li class="listitem"><p class="simpara">
						After deployment, monitor the status of the workflow pods as shown in the following example:
					</p><pre class="programlisting language-bash">$ kubectl get pods -n &lt;your_namespace&gt; -l app=basic</pre><p class="simpara">
						The pod may initially appear in an <code class="literal">Error</code> state because of missing or incomplete configuration in the Secret or ConfigMap.
					</p></li><li class="listitem"><p class="simpara">
						Inspect the Pod logs as shown in the following example:
					</p><pre class="programlisting language-bash">$ oc logs -n &lt;your_namespace&gt; basic-f7c6ff455-vwl56</pre><p class="simpara">
						The following code is an example of the output:
					</p><pre class="programlisting language-yaml">SRCFG00040: The config property quarkus.openapi-generator.notifications.auth.BearerToken.bearer-token is defined as the empty String ("") which the following Converter considered to be null: io.smallrye.config.Converters$BuiltInConverter
java.lang.RuntimeException: Failed to start quarkus
...
Caused by: io.quarkus.runtime.configuration.ConfigurationException: Failed to read configuration properties</pre><p class="simpara">
						The error indicates a missing property: <code class="literal">quarkus.openapi-generator.notifications.auth.BearerToken.bearer-token</code>.
					</p></li><li class="listitem"><p class="simpara">
						In such a case where the logs show the <code class="literal">ConfigurationException: Failed to read configuration properties</code> error or indicate a missing value, retrieve the ConfigMap as shown in the following example:
					</p><pre class="programlisting language-bash">$ oc get -n &lt;your_namespace&gt; configmaps basic-props -o yaml</pre><p class="simpara">
						The following code is an example of the sample output:
					</p><pre class="programlisting language-yaml">apiVersion: v1
data:
  application.properties: |
    # Backstage notifications service
    quarkus.rest-client.notifications.url=${BACKSTAGE_NOTIFICATIONS_URL}
    quarkus.openapi-generator.notifications.auth.BearerToken.bearer-token=${NOTIFICATIONS_BEARER_TOKEN}
...</pre><p class="simpara">
						Resolve the placeholders using values provided using a Secret.
					</p></li><li class="listitem"><p class="simpara">
						You must edit the corresponding Secret and provide appropriate base64-encoded values to resolve the placeholders in <code class="literal">application.properties</code> as shown in the following example:
					</p><pre class="programlisting language-bash">$ kubectl edit secrets -n &lt;your_namespace&gt; basic-secrets</pre></li><li class="listitem">
						Restart the workflow Pod for Secret changes to take effect in OpenShift Serverless Logic <code class="literal">v1.36</code>.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify the deployment status by checking the Pods again as shown in the following example:
					</p><pre class="programlisting language-bash">$ oc get pods -n &lt;your_namespace&gt; -l app=basic</pre><p class="simpara">
						The expected status for a successfully deployed workflow Pod is as shown in the following example:
					</p><pre class="programlisting language-yaml">NAME                    READY   STATUS    RESTARTS   AGE
basic-f7c6ff455-grkxd   1/1     Running   0          47s</pre></li><li class="listitem">
						Once the Pod is in the <code class="literal">Running</code> state, the workflow now appears in the Orchestrator plugin inside the Red Hat Developer Hub.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Inspect the provided build script to extract the actual steps and implement them in your preferred CI/CD tool, for example, GitHub Actions, GitLab CI, Jenkins, and Tekton.
					</li></ul></div></section><section class="section" id="ref-best-practices-for-creating-workflows_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">8.5. Best practices when creating serverless workflows</h3></div></div></div><p>
				Create effective serverless workflows using thoughtful approaches to design, handle data, and manage error by following these best practices based on the Serverless Workflow Domain Specific Language (DSL) principles. These principles help you to build robust workflows.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Workflow design principles</span></dt><dd><p class="simpara">
							The Serverless Workflow DSL prioritizes clarity and ease of use when writing workflows.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Priority of constituencies</span></dt><dd>
										When developing workflows or APIs, ensure the needs of the author (workflow writer) come first. The constituencies are prioritized in the following order: Authors &gt; Operators &gt; Implementers &gt; Specifications writers.
									</dd><dt><span class="term">Linguistic fluency and clarity</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												Use imperative verbs such as <code class="literal">Call</code>, <code class="literal">Emit</code>, <code class="literal">For</code>, <code class="literal">Fork</code>, <code class="literal">Raise</code>, <code class="literal">Run</code>, <code class="literal">Set</code>, <code class="literal">Switch</code>, and <code class="literal">Wait</code>. These simple, universally understood terms make your workflow simple to read and understand.
											</li></ul></div></dd><dt><span class="term">Structure and extensibility</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												Use implicit default behaviors to reduce redundancy.
											</li><li class="listitem">
												Declare components inline if they are not reusable to keep the definition self-contained.
											</li><li class="listitem">
												Use external references to import and reuse shared components, which promotes a modular design.
											</li><li class="listitem">
												Prioritize flexibility over strict enumerations to ensure extensibility and adaptability across different runtime environments.
											</li></ul></div></dd></dl></div></dd><dt><span class="term">Data flow and runtime management</span></dt><dd>
							Controlling data flow is critical for efficient workflows. Tasks are the fundamental computing units of a workflow. The Domain Specific Language (DSL) defines several default task types that runtimes must do. These include <code class="literal">Do</code>, <code class="literal">Listen</code>, <code class="literal">Raise</code>, <code class="literal">Run</code>, <code class="literal">Try</code>, and <code class="literal">Wait</code>.
						</dd><dt><span class="term">Security and error handling</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Secrets</span></dt><dd>
										Use Secrets with caution. Avoid passing them directly in call inputs as this might expose sensitive information.
									</dd><dt><span class="term">Fault tolerance and error handling</span></dt><dd>
										Serverless Workflow is designed with resilience in mind to recover from failures.
									</dd></dl></div></dd><dt><span class="term">Orchestrator UI integration best practices</span></dt><dd><p class="simpara">
							For your workflow results to be effectively displayed in the Orchestrator UI and to facilitate chaining of workflows, you must structure the output data according to the <code class="literal">WorkflowResult</code> schema. Additionally, include any error information as part of the workflow output so the UI and subsequent workflows can handle them accordingly.
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Workflow output schema</span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">Results placement</span></dt><dd>
													The primary output intended for subsequent processing must be placed under the <code class="literal">data.result</code> property.
												</dd><dt><span class="term">Schema reference</span></dt><dd>
													Your output schema file (<code class="literal">schemas/workflow-output-schema.json</code>) must reference the <code class="literal">WorkflowResult</code> schema.
												</dd><dt><span class="term">Outputs definition</span></dt><dd><p class="simpara">
													Include an <code class="literal">outputs</code> section in your workflow definition. This section contains human-readable key/value pairs that the UI will display.
												</p><p class="simpara">
													Structure of workflow:
												</p><pre class="programlisting language-yaml">id: my-workflow
version: "0.8"
specVersion: "0.8"
name: My Workflow
start: ImmediatelyEnd
dataInputSchema: schemas/basic__main-schema.json
extensions:
  - extensionid: workflow-output-schema
    outputSchema: schemas/workflow-output-schema.json
functions:
  - name: print
    type: custom
    operation: sysout
  - name: successResult
    type: expression
    operation: '{
      "result": {
      "message": "Project " + .projectName + " active",
      "outputs":[]
      }
      }'
start: "successResult"
states:
  - name: successResult
    type: operation
    actions:
      - name: setOutput
        functionRef:
          refName: successResult
    end: true</pre></dd></dl></div></dd></dl></div></dd></dl></div></section></section><section class="section" id="assembly-automating-workflow-deployment-with-orchestrator"><div class="titlepage"><div><div><h2 class="title">9. Automating workflow deployment with Orchestrator</h2></div></div></div><p>
			The Orchestrator plugin for Red Hat Developer Hub (RHDH) automates the software development lifecycle (SDLC) for serverless workflows. By using the Orchestrator software templates, you bootstrap a complete serverless workflow project that includes a fully operational Git repository, deployment configurations, and automated continuous integration (CI) and continuous deployment (CD) pipelines.
		</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
				Use the <code class="literal">rhdh</code> namespace where the RHDH chart is installed.
			</p></div></div><p>
			The Orchestrator plugin integrates these components:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">RHDH Helm chart</span></dt><dd>
						Installs the RHDH Orchestrator.
					</dd><dt><span class="term">Tekton or Red Hat OpenShift Pipelines</span></dt><dd>
						Manages the <code class="literal">Kubernetes-native</code> CI pipeline to build images.
					</dd><dt><span class="term">ArgoCD or Red Hat OpenShift GitOps</span></dt><dd>
						Manages the CD pipeline to deploy the workflow on the RHDH instance.
					</dd><dt><span class="term">Quay.io</span></dt><dd>
						Stores the container images generated by the pipelines.
					</dd><dt><span class="term">OpenShift Serverless Logic operator</span></dt><dd>
						Implements serverless workflow specifications
					</dd></dl></div><section class="section" id="proc-installing-orchestrator-software-templates_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">9.1. Installing Orchestrator software templates</h3></div></div></div><p>
				To enable software templates on RHDH, you must install two additional Helm charts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed RHDH and the Orchestrator plugin by using the Helm chart.
					</li><li class="listitem">
						You have installed the <code class="literal">redhat-developer-hub-orchestrator-infra</code> chart.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Install the <code class="literal">orchestrator-software-templates-infra</code> chart.
					</li><li class="listitem">
						Install the <code class="literal">orchestrator-software-templates</code> chart.
					</li></ol></div><section class="section" id="proc-installing-the-orchestrator-software-templates-infra-chart_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">9.1.1. Installing the Orchestrator Software Templates Infra chart</h4></div></div></div><p>
					The <code class="literal">orchestrator-software-templates-infra</code> chart installs the Custom Resource Definitions (CRDs) and operators for Tekton (Red Hat OpenShift Pipelines) and Argo CD (Red Hat OpenShift GitOps). These are required to handle the CI/CD automation for serverless workflows.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have <code class="literal">cluster-admin</code> privileges.
						</li><li class="listitem">
							You have installed the Helm CLI.
						</li><li class="listitem"><p class="simpara">
							You have added the following plugins to the RHDH chart <code class="literal">values.yaml</code> file to include the following dynamic plugins:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">backstage-plugin-scaffolder-backend-module-github-dynamic</code>
								</li><li class="listitem">
									<code class="literal">backstage-plugin-scaffolder-backend-module-gitlab-dynamic</code>
								</li><li class="listitem">
									<code class="literal">backstage-plugin-kubernetes-backend-dynamic</code>
								</li><li class="listitem">
									<code class="literal">backstage-plugin-kubernetes</code>
								</li><li class="listitem">
									<code class="literal">backstage-community-plugin-tekton</code>
								</li><li class="listitem">
									<code class="literal">backstage-community-plugin-redhat-argocd</code>
								</li><li class="listitem">
									<code class="literal">roadiehq-backstage-plugin-argo-cd-backend-dynamic</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal">roadiehq-scaffolder-backend-argocd-dynamic</code>
								</p><p class="simpara">
									Edit the <code class="literal">values.yaml</code> and upgrade the chart.
								</p></li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Install the infrastructure chart:
						</p><pre class="programlisting language-terminal">$ helm install &lt;release_name&gt; redhat-developer/redhat-developer-hub-orchestrator-infra</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify the installation by running the following command:
						</p><pre class="programlisting language-terminal">$ helm test redhat-developer-hub-orchestrator-infra</pre></li></ul></div></section><section class="section" id="proc-installing-the-orchestrator-software-templates-chart_orchestrator-rhdh"><div class="titlepage"><div><div><h4 class="title">9.1.2. Installing the Orchestrator Software Templates chart</h4></div></div></div><p>
					The <code class="literal">orchestrator-software-templates</code> chart loads the actual software templates into your RHDH instance. This allows users to select workflow templates from the RHDH Catalog.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have installed the <code class="literal">orchestrator-software-templates-infra</code> chart to deploy OpenShift Pipelines (Tekton) operator and OpenShift GitOps (ArgoCD) operator in the same namespace as RHDH.
						</li><li class="listitem"><p class="simpara">
							You have labeled the <code class="literal">rhdh</code> namespace to enable GitOps sync:
						</p><pre class="programlisting language-terminal">$ oc label ns rhdh rhdh.redhat.com/argocd-namespace=true</pre></li><li class="listitem"><p class="simpara">
							You have created a secret named <code class="literal">orchestrator-auth-secret</code> in the <code class="literal">rhdh</code> namespace containing the following keys:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">BACKEND_SECRET</code>: Backend authentication secret
								</li><li class="listitem">
									<code class="literal">K8S_CLUSTER_TOKEN</code>: Kubernetes cluster token
								</li><li class="listitem">
									<code class="literal">K8S_CLUSTER_URL</code>: Kubernetes cluster URL
								</li><li class="listitem">
									<code class="literal">GITHUB_TOKEN</code>: GitHub access token (optional)
								</li><li class="listitem">
									<code class="literal">GITHUB_CLIENT_ID</code>: GitHub OAuth client ID (optional)
								</li><li class="listitem">
									<code class="literal">GITHUB_CLIENT_SECRET</code>: GitHub OAuth client secret (optional)
								</li><li class="listitem">
									<code class="literal">GITLAB_HOST</code>: GitLab host URL (optional)
								</li><li class="listitem">
									<code class="literal">GITLAB_TOKEN</code>: GitLab access token (optional)
								</li><li class="listitem">
									<code class="literal">ARGOCD_URL</code>: ArgoCD server URL (optional)
								</li><li class="listitem">
									<code class="literal">ARGOCD_USERNAME</code>: ArgoCD username (optional)
								</li><li class="listitem">
									<code class="literal">ARGOCD_PASSWORD</code>: ArgoCD password (optional)
								</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the software templates chart:
						</p><pre class="programlisting language-terminal">$ helm repo add redhat-developer https://redhat-developer.github.io/rhdh-chart
$ helm install my-orchestrator-templates redhat-developer/orchestrator-software-templates --version 0.2.0</pre></li><li class="listitem"><p class="simpara">
							Create your environment-specific values file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Retrieve your RHDH route URL:
								</p><pre class="programlisting language-terminal">RHDH_ROUTE="https://$(oc get route -n {{ .Values.orchestratorTemplates.rhdhChartNamespace }} -o jsonpath='{.items[0].spec.host}')"</pre></li><li class="listitem"><p class="simpara">
									Copy the template and replace placeholders
								</p><pre class="programlisting language-yaml">cp charts/orchestrator-software-templates/orchestrator-templates-values.yaml.template orchestrator-templates-values.yaml
sed -i "s|__RHDH_BASE_URL__|$RHDH_ROUTE|g" orchestrator-templates-values.yaml</pre></li></ol></div></li><li class="listitem"><p class="simpara">
							Backup your RHDH configuration:
						</p><pre class="programlisting language-terminal">helm show values charts/backstage \
     -n {{ .Values.orchestratorTemplates.rhdhChartNamespace }} &gt; current-backstage-values.yaml</pre></li><li class="listitem"><p class="simpara">
							Upgrade the RHDH chart with both value files:
						</p><pre class="programlisting language-terminal"> helm upgrade {{ .Values.orchestratorTemplates.rhdhChartReleaseName }} charts/backstage \
     -n {{ .Values.orchestratorTemplates.rhdhChartNamespace }} \
     -f current-backstage-values.yaml \
     -f orchestrator-templates-values.yaml</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Wait for the deployment to complete.
						</li><li class="listitem">
							Open your RHDH instance and verify the new software templates appear in the <span class="strong strong"><strong>Create</strong></span> menu.
						</li></ol></div></section></section><section class="section" id="proc-creating-a-serverless-workflow-project_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">9.2. Creating a serverless workflow project</h3></div></div></div><p>
				Use the Orchestrator software templates to generate a project that includes workflow definitions, <code class="literal">Kustomize</code> configurations, and CI/CD pipelines.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed <code class="literal">orchestrator-software-templates-infra</code> and <code class="literal">orchestrator-software-templates</code> Helm charts to enable templates.
					</li><li class="listitem">
						You have installed RHDH and the Orchestrator plugin by using the Helm chart.
					</li><li class="listitem">
						You have a <code class="literal">Quay.io</code> organization and repository for storing the workflow images.
					</li><li class="listitem">
						You have a GitHub or Gitlab personal access token with repository creation permissions.
					</li><li class="listitem">
						You have configured a GitOps secret for the target cluster.
					</li><li class="listitem">
						You have set the target namespace for both the pipeline and the workflow to the <code class="literal">rhdh</code> namespace.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare the image registry. Before creating the template, configure the target repository in <code class="literal">Quay.io</code>.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Log in to your <code class="literal">Quay.io</code> organization (for example, <code class="literal">orchestrator-testing</code>).
							</li><li class="listitem">
								Create a new repository (for example, <code class="literal">serverless-workflow-demo</code>).
							</li><li class="listitem">
								Add robot account permissions to the repository settings.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Open the Red Hat Developer Hub Catalog.
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/rhdh/product-catalog.png" alt="product-catalog"/></div></div></li><li class="listitem">
						Select the <span class="strong strong"><strong>Basic workflow bootstrap project</strong></span> template and click <span class="strong strong"><strong>Launch Template</strong></span>.
					</li><li class="listitem">
						Follow the template form to enter required details, including the <span class="strong strong"><strong>GitHub organization</strong></span>, <span class="strong strong"><strong>source code repository name</strong></span>, and a unique <span class="strong strong"><strong>Workflow ID</strong></span>.
					</li><li class="listitem">
						For the CI/CD method, select <span class="strong strong"><strong>Tekton with Argo CD</strong></span> to generate GitOps resources.
					</li><li class="listitem">
						Set the <span class="strong strong"><strong>Workflow Namespace</strong></span> to <code class="literal">rhdh</code> and the <span class="strong strong"><strong>GitOps Namespace</strong></span> to <code class="literal">orchestrator-gitops</code>.
					</li><li class="listitem">
						Enter your <code class="literal">Quay.io</code> registry details.
					</li><li class="listitem"><p class="simpara">
						Click <span class="strong strong"><strong>Review</strong></span>, then click <span class="strong strong"><strong>Create</strong></span>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="images/rhdh/basic-workflow-bootstrap.png" alt="basic-workflow-bootstrap"/></div></div></li><li class="listitem">
						Optional: Enable persistence and provide database connection details if the workflow requires a database schema.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The system creates the following repositories:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Source code repository: Contains the serverless workflow project.
							</li><li class="listitem">
								GitOps repository: Contains GitOps configurations, Tekton pipeline templates, and bootstrap instructions.
							</li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/orchestrator_in_red_hat_developer_hub/index#assembly-building-and-deploying-serverless-workflows">Building and deploying serverless workflows</a>
					</li></ul></div></section><section class="section" id="proc-bootstrapping-gitops-resources-and-triggering-pipelines_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">9.3. Bootstrapping GitOps resources and triggering pipelines</h3></div></div></div><p>
				You must manually bootstrap the GitOps resources to trigger the continuous integration (CI) pipeline.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the generated <span class="strong strong"><strong>GitOps repository</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Clone the repository and navigate to the <code class="literal">bootstrap</code> directory:
					</p><pre class="programlisting language-terminal">$ git clone https://token:&lt;PAT&gt;@${{ values.gitHost }}/${{ values.orgName }}/${{ values.repoName }}.git
cd &lt;repo_name&gt;/bootstrap</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							If you are not authenticated, you must use a personal access token (PAT) in the clone URL. Make sure the PAT has repository access permissions.
						</p></div></div></li><li class="listitem">
						Open <code class="literal">${{values.workflowId}}-argocd-repo.yaml</code> and replace the <code class="literal"><span class="emphasis"><em>REPLACE_SSH_PRIVATE_KEY</em></span></code> string with your SSH private key.
					</li><li class="listitem"><p class="simpara">
						Apply the manifests to the cluster:
					</p><pre class="programlisting language-bash">$ kubectl apply -f .</pre><p class="simpara">
						Applying these manifests triggers the following automated sequence:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								CI Pipeline (Tekton): Builds the workflow image and pushes it to your <code class="literal">Quay.io</code> registry.
							</li><li class="listitem">
								CD Pipeline (Argo CD): Deploys the serverless workflow manifests to the cluster.
							</li></ol></div></li></ol></div></section><section class="section" id="proc-verifying-the-deployment_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">9.4. Verifying the deployment</h3></div></div></div><p>
				Verify the status of your continuous integration (CI) and continuous deployment (CD) pipelines in the RHDH component catalog.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						For CI:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								In the RHDH Catalog, select your source code repository component (for example, <code class="literal">onboardings</code>).
							</li><li class="listitem">
								Click the <span class="strong strong"><strong>CI</strong></span> tab and verify that the pipeline run status is <span class="strong strong"><strong>Succeeded</strong></span>.
							</li><li class="listitem">
								If the pipeline status does not appear in the Red Hat Developer Hub console, verify the CI status directly in your Git provider (GitHub or GitLab).
							</li><li class="listitem">
								If the pipeline fails, click the <span class="strong strong"><strong>run</strong></span> name to view the logs and identify build errors.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						For CD:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Open the GitOps Resources Repository component in the Catalog (for example, <code class="literal">onboarding-gitops</code>).
							</li><li class="listitem"><p class="simpara">
								Click the <span class="strong strong"><strong>CD</strong></span> tab and make sure the Kubernetes resources are <span class="strong strong"><strong>synced</strong></span> and <span class="strong strong"><strong>healthy</strong></span>. This confirms that ArgoCD deployed the workflow to the cluster.
							</p><div class="informalfigure"><div class="mediaobject"><img src="images/rhdh/workflow-deployment-successful.png" alt="workflow-deployment-successful"/></div></div></li></ol></div></li></ol></div></section><section class="section" id="proc-troubleshooting-the-pipelines_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">9.5. Troubleshooting workflow deployments</h3></div></div></div><p>
				Identify and resolve issues related to plugin visibility, pipeline execution, or resource synchronization.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Visibility issues
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Missing Orchestrator plugin</span></dt><dd>
									If Orchestrator features do not appear in RHDH, make sure you have updated the RHDH Helm chart with the required plugins.
								</dd><dt><span class="term">Software templates not appearing</span></dt><dd>
									Make sure the <code class="literal">orchestrator-software-templates</code> chart is installed and the <code class="literal">orchestrator-auth-secret</code> exists in the correct namespace.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Pipeline failure (CI)
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">GitHub or GitLab actions failure</span></dt><dd>
									The GitOps automation includes a GitHub Action or GitLab CI step that creates a <code class="literal">PipelineRun</code> manifest from a <code class="literal">PipelineRun</code> template. Examine the failed GitHub or GitLab actions logs. Failures often occur due to invalid Git credentials or misconfigured runner permissions. You can also create the <code class="literal">PipelineRun</code> file manually to bypass automation issues.
								</dd><dt><span class="term">Build or push issues</span></dt><dd><p class="simpara">
									Check the <span class="strong strong"><strong>CI</strong></span> tab in the RHDH Catalog.
								</p><p class="simpara">
									If RHDH does not display the status, use the OpenShift Container Platform console to monitor pipeline instances and triggered jobs. Navigate to <span class="strong strong"><strong>Pipelines</strong></span> &gt; <span class="strong strong"><strong>PipelineRuns</strong></span> for detailed logs.
								</p><p class="simpara">
									If the Tekton pipeline fails during the build or push stages:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Verify that your <code class="literal">Quay.io</code> robot account has <span class="strong strong"><strong>Write</strong></span> permissions.
										</li><li class="listitem">
											Ensure the <code class="literal">docker-registry-credentials</code> secret exists in the <code class="literal">rhdh</code> namespace.
										</li></ul></div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Resource visibility and Sync issues (CD)
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Pipeline succeeds but workflows are missing</span></dt><dd><p class="simpara">
									If the CI pipeline succeeds but the workflow does not appear in the <span class="strong strong"><strong>CD</strong></span> tab:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Make sure the target namespace is labeled for Argo CD:
										</p><pre class="programlisting language-terminal">$ oc label ns sonataflow-infra rhdh.redhat.com/argocd-namespace=true</pre></li><li class="listitem">
											Make sure the ArgoCD ServiceAccount has the required permissions to manage resources in the <code class="literal">rhdh</code> namespace.
										</li></ul></div></dd><dt><span class="term">Argo CD sync failure</span></dt><dd>
									If resources appear but remain in an <code class="literal">OutOfSync</code> state, click <span class="strong strong"><strong>Refresh</strong></span> in the Argo CD UI or verify that the <span class="strong strong"><strong>AppProject</strong></span> exists in the <code class="literal">orchestrator-gitops</code> namespace.
								</dd></dl></div></li></ol></div></section></section><section class="section" id="assembly-orchestrator-troubleshooting-serverless-workflows_orchestrator-rhdh"><div class="titlepage"><div><div><h2 class="title">10. Diagnose and resolve serverless workflow issues</h2></div></div></div><p>
			Use the following information to diagnose and resolve serverless workflow and visibility issues.
		</p><section class="section" id="ref-troubleshoot-workflow-http-error-codes_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">10.1. Troubleshoot workflow HTTP error codes</h3></div></div></div><p>
				Workflow operations fail when a service endpoint returns an HTTP error code. The user interface displays the HTTP code and error message. See <a class="link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status">external documentation</a> for a complete list of HTTP status code meanings.
			</p><p>
				The following table lists common HTTP errors encountered during workflow execution:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"/><col style="width: 25%; " class="col_2"/><col style="width: 50%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm46594054368496" scope="col">HTTP code</th><th align="left" valign="top" id="idm46594054367408" scope="col">Description</th><th align="left" valign="top" id="idm46594054366320" scope="col">Possible cause</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm46594054368496">
							<p>
								<code class="literal">401</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594054367408">
							<p>
								Unauthorized access
							</p>
							</td><td align="left" valign="top" headers="idm46594054366320">
							<p>
								The token, password, or username provided for the endpoint might be incorrect or expired.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594054368496">
							<p>
								<code class="literal">403</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594054367408">
							<p>
								Forbidden
							</p>
							</td><td align="left" valign="top" headers="idm46594054366320">
							<p>
								The server understood the request but refused to process it due to insufficient permissions to a resource or action.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm46594054368496">
							<p>
								<code class="literal">409</code>
							</p>
							</td><td align="left" valign="top" headers="idm46594054367408">
							<p>
								Conflict
							</p>
							</td><td align="left" valign="top" headers="idm46594054366320">
							<p>
								The workflow attempted to create or update a resource (for example, Kubernetes or OpenShift resources) that already exists.
							</p>
							</td></tr></tbody></table></div></section><section class="section" id="proc-workflow-deployment-errors_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">10.2. Troubleshooting common workflow deployment errors</h3></div></div></div><p>
				Use these steps to diagnose and resolve common workflow deployment, connectivity, or configuration failures.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If the workflow operation fails, examine the container log of the specific workflow instance to determine the cause by running the following command:
					</p><pre class="programlisting language-terminal">$ oc logs my-workflow-xy73lj</pre></li><li class="listitem"><p class="simpara">
						If the workflow fails to reach an HTTPS endpoint, check the pod log for an SSL certificate verification failure. This occurs if the target endpoint uses a Certificate Authority (CA) that the workflow cannot verify. The resulting error resembles the following:
					</p><pre class="programlisting language-yaml">sun.security.provider.certpath.SunCertPathBuilderException - unable to find valid certification path to requested target</pre></li><li class="listitem">
						To resolve the SSL certificate error, load the additional CA certificate into the running workflow container.
					</li></ol></div></section><section class="section" id="proc-troubleshoot-sonataflow-cross-namespace-issues_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">10.3. Troubleshooting cross-namespace SonataFlow configuration and deployment issues</h3></div></div></div><p>
				Use this procedure to resolve configuration and deployment failures when SonataFlow workflows are installed in a namespace separate from the core services, or if the Data Index fails to connect to the PostgreSQL database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have administrator privileges to access the OpenShift cluster.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Identify required namespaces.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Retrieve the namespace value where RHDH is running using <code class="literal">oc get backstage -A</code>.
							</li><li class="listitem"><p class="simpara">
								Identify the SonataFlow Services Namespace by checking for either a <code class="literal">sonataflowclusterplatform</code> or <code class="literal">sonataflowplatform</code> instance.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									By default, the SonataFlow namespace must be the same as the RHDH namespace.
								</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
						If the workflow is deployed to a namespace outside the core SonataFlow services, configure network policies to permit the necessary inter-namespace traffic.
					</p><pre class="screen"># Example <code class="literal">NetworkPolicy</code> configuration to ingress traffic into the workflow namespace
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: {{ .Release.Name }}-allow-infra-ns-to-workflow-ns
  # Sonataflow and Workflows are using the RHDH target namespace.
  namespace: {{ .Release.Namespace | quote }}
spec:
  podSelector: {}
  ingress:
    - from:
      - namespaceSelector:
          matchLabels:
            # Allow knative events to be delivered to workflows.
            kubernetes.io/metadata.name: knative-eventing
      - namespaceSelector:
          matchLabels:
            # Allow auxiliary knative function for workflow (such as m2k-save-transformation)
            kubernetes.io/metadata.name: knative-serving
      - namespaceSelector:
          matchLabels:
            # Allow communication between the serverless logic operator and the workflow namespace.
            kubernetes.io/metadata.name: openshift-serverless-logic</pre></li><li class="listitem"><p class="simpara">
						Add <code class="literal">SonataFlowClusterPlatform</code> Custom Resource as shown in the following configuration:
					</p><pre class="programlisting language-yaml">oc create -f - &lt;&lt;EOF
apiVersion: sonataflow.org/v1alpha08
kind: SonataFlowClusterPlatform
metadata:
  name: cluster-platform
spec:
  platformRef:
    name: sonataflow-platform
    namespace: $RHDH_NAMESPACE</pre></li><li class="listitem"><p class="simpara">
						To allow communication between RHDH namespace and the workflow namespace, create the following network policies:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Allow RHDH services to accept traffic from workflows. Create an additional network policy within the RHDH instance namespace as shown in the following configuration::
							</p><pre class="programlisting language-yaml">oc create -f - &lt;&lt;EOF
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-external-workflows-to-rhdh
  # Namespace where network policies are deployed
  namespace: $RHDH_NAMESPACE
spec:
  podSelector: {}
  ingress:
    - from:
      - namespaceSelector:
          matchLabels:
            # Allow SonataFlow services to communicate with new/additional workflow namespace.
            kubernetes.io/metadata.name: $ADDITIONAL_WORKFLOW_NAMESPACE</pre></li><li class="listitem"><p class="simpara">
								Allow traffic from RHDH, SonataFlow and Knative. Create a network policy within the additional workflow namespace as shown in the following configuration:
							</p><pre class="programlisting language-yaml">oc create -f - &lt;&lt;EOF
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-rhdh-and-knative-to-workflows
  namespace: $ADDITIONAL_WORKFLOW_NAMESPACE
spec:
  podSelector: {}
  ingress:
    - from:
      - namespaceSelector:
          matchLabels:
            # Allows traffic from pods in the {product-very-short} namespace.
            kubernetes.io/metadata.name: $RHDH_NAMESPACE
      - namespaceSelector:
          matchLabels:
            # Allows traffic from pods in the Knative Eventing namespace.
            kubernetes.io/metadata.name: knative-eventing
      - namespaceSelector:
          matchLabels:
            # Allows traffic from pods in the Knative Serving namespace.
            kubernetes.io/metadata.name: knative-serving</pre></li></ol></div></li><li class="listitem">
						(Optional) Create an <code class="literal">allow-intra-namespace</code> policy in the workflow namespace to enable unrestricted communication among all pods within that namespace.
					</li><li class="listitem"><p class="simpara">
						If workflow persistence is required, perform the following configuration steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a dedicated PostgreSQL Secret containing database credentials within the workflow namespace as shown in the following configuration:
							</p><pre class="programlisting language-yaml">oc get secret sonataflow-psql-postgresql -n &lt;your_namespace&gt; -o yaml &gt; secret.yaml
sed -i '/namespace: &lt;your_namespace&gt;/d' secret.yaml
oc apply -f secret.yaml -n $ADDITIONAL_NAMESPACE</pre></li><li class="listitem"><p class="simpara">
								Configure the workflow <code class="literal">serviceRef</code> property to correctly reference the PostgreSQL service namespace as shown in the following configuration:
							</p><pre class="programlisting language-yaml">apiVersion: sonataflow.org/v1alpha08
kind: SonataFlow
  ...
spec:
  ...
  persistence:
    postgresql:
      secretRef:
        name: sonataflow-psql-postgresql
        passwordKey: postgres-password
        userKey: postgres-username
      serviceRef:
        databaseName: sonataflow
        databaseSchema: greeting
        name: sonataflow-psql-postgresql
        namespace: $POSTGRESQL_NAMESPACE
        port: 5432</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">namespace</code></span></dt><dd>
											Enter the namespace where the PostgreSQL server is deployed.
										</dd></dl></div></li></ol></div></li><li class="listitem"><p class="simpara">
						If the <code class="literal">sonataflow-platform-data-index-service</code> cannot connect to the PostgreSQL database on startup, perform the following diagnostic checks:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Verify that the PostgreSQL Pod has fully transitioned to a <code class="literal">running</code> and operational status. Allow additional time for database initialization before expecting related service pods (<code class="literal">DataIndex</code>, <code class="literal">JobService</code>) to establish a connection.
							</li><li class="listitem">
								If the PostgreSQL Server operates in a dedicated namespace (for example, outside RHDH), verify that network policies are configured to allow ingress traffic from the SonataFlow services namespace. Network policies might prevent the Data Index and Job Service pods from connecting to the database.
							</li></ol></div></li></ol></div></section><section class="section" id="proc-troubleshooting-missing-workflows_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">10.4. Troubleshooting workflows missing from the RHDH UI</h3></div></div></div><p>
				You can perform the following checks to verify the workflow status and connectivity when the deployed workflow is missing from the RHDH Orchestrator UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have administrator privileges to access the OpenShift cluster where RHDH and SonataFlow services are running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Verify if the workflow uses GitOps profile. The RHDH Orchestrator UI displays only the workflows that use this profile. Make sure the workflow definition and the SonataFlow manifests use the GitOps profile.
					</li><li class="listitem"><p class="simpara">
						Verify that the workflow pod has started and is ready. The readiness of a workflow pod depends on its successful registration with the Data Index. When a workflow initializes, it performs the following actions:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								It attempts to create its schema in the database (if persistence is active).
							</li><li class="listitem"><p class="simpara">
								It attempts to register itself to the Data Index. The workflow pod remains in an unready state until it successfully registers to the Data Index.
							</p><p class="simpara">
								Check the workflow deployment for additional status and error messages that might be unavailable in the pod log.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Check if the workflow pod can reach the Data Index service. Connect to the workflows pod and send the following GraphQL request to the Data Index:
					</p><pre class="screen">curl -g -k  -X POST  -H "Content-Type: application/json" \
                    -d '{"query":"query{ ProcessDefinitions  { id, serviceUrl, endpoint } }"}' \
                    http://sonataflow-platform-data-index-service.&lt;your_namespace&gt;/graphql</pre><p class="simpara">
						Use the Data Index service and namespace as defined in your environment. By default, this is the same namespace where RHDH is installed. If your SonataFlow resources are installed in a separate namespace, use <code class="literal">&lt;your_namespace&gt;</code>. Check if the RHDH pod can reach the workflow service by running the following command:
					</p><pre class="programlisting language-bash">curl http://&lt;workflow_service&gt;.&lt;workflow_namespace&gt;/management/processes</pre></li><li class="listitem"><p class="simpara">
						Connect to the RHDH pod. Verify its connection to the Data Index service and inspect the RHDH pod logs for messages from the Orchestrator plugin.
					</p><p class="simpara">
						To inspect the logs, identify the RHDH pod and run the following <span class="strong strong"><strong>oc logs</strong></span> command:
					</p><pre class="programlisting language-yaml">oc get pods -n &lt;your_namespace&gt;
oc logs &lt;rhdh_pod_name&gt; -n &lt;your_namespace&gt;</pre><p class="simpara">
						You must find messages indicating it is attempting to fetch workflow information from the Data Index, similar to the following:
					</p><pre class="programlisting language-yaml">{"level":"\u001b[32minfo\u001b[39m","message":"fetchWorkflowInfos() called: http://sonataflow-platform-data-index-service.&lt;your_namespace&gt;","plugin":"orchestrator","service":"backstage","span_id":"fca4ab29f0a7aef9","timestamp":"2025-08-04 17:58:26","trace_flags":"01","trace_id":"5408d4b06373ff8fb34769083ef771dd"}</pre><p class="simpara">
						Notice the <span class="emphasis"><em>"plugin":"orchestrator"</em></span> that can help to filter the messages.
					</p></li><li class="listitem"><p class="simpara">
						Make sure the Data Index properties are set in the <code class="literal">-managed-props</code> ConfigMap of the workflow as shown in the following configuration:
					</p><pre class="programlisting language-yaml">kogito.data-index.health-enabled = true
kogito.data-index.url = http://sonataflow-platform-data-index-service.&lt;your_namespace&gt;
...
mp.messaging.outgoing.kogito-processdefinitions-events.url = http://sonataflow-platform-data-index-service.&lt;your_namespace&gt;/definitions
mp.messaging.outgoing.kogito-processinstances-events.url = http://sonataflow-platform-data-index-service.&lt;your_namespace&gt;/processes</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							The <code class="literal">-managed-props</code> ConfigMap is located in the same namespace as the workflow and is generated by the OpenShift Serverless Logic (OSL) Operator.
						</p></div></div><p class="simpara">
						These properties, along with similar settings for the Job Services, indicate that the (OSL) Operator successfully registered the Data Index service.
					</p></li><li class="listitem"><p class="simpara">
						Confirm that the workflow is registered in the Data Index database. Connect to the database used by the Data Index and run the following command from the PSQL instance pod:
					</p><pre class="programlisting language-bash">PGPASSWORD=&lt;psql password&gt; psql -h localhost -p 5432 -U &lt; user&gt; -d sonataflow</pre><p class="simpara">
						Replace <code class="literal">&lt;psql password&gt;</code> and <code class="literal">&lt;user&gt;</code> with your database credentials.
					</p><p class="simpara">
						Run the following SQL commands to query the registered workflow definitions:
					</p><pre class="programlisting language-yaml">sonataflow=# SET search_path TO "sonataflow-platform-data-index-service";
sonataflow=# select id, name from definitions;</pre><p class="simpara">
						You must see your workflows listed in the query results.
					</p></li><li class="listitem"><p class="simpara">
						Make sure you have enabled Data Index and Job Service in the <code class="literal">SonataFlowPlatform</code> custom resource (CR) as shown in the following configuration:
					</p><pre class="programlisting language-yaml">services:
    dataIndex:
      enabled: true
    jobService:
      enabled: true</pre><p class="simpara">
						If you fail to enable the Data Index and the Job Services in the <code class="literal">SonataFlowPlatform</code> custom resource (CR), the Orchestrator plugin fails to fetch the available workflows.
					</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
							You can also manually edit the <code class="literal">SonataFlowPlatform</code> CR instance to trigger the re-creation of workflow-related manifests.
						</p></div></div></li><li class="listitem">
						Set the RBAC permissions correctly. For more information, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/authorization_in_red_hat_developer_hub/index#managing-authorizations-by-using-the-rest-api">RBAC documentation</a>.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_developer_hub/1.9/html-single/monitoring_and_logging/index#configuring-the-application-log-level-by-using-the-operator_assembly-rhdh-observability">Configuring the application log level by using the Red Hat Developer Hub Operator</a>
					</li></ul></div></section></section><section class="section" id="assembly-orchestrator-plugins-technical-appendixes_orchestrator-rhdh"><div class="titlepage"><div><div><h2 class="title">11. Technical appendix</h2></div></div></div><p>
			The following appendix provides technical information, and details on non-production tools, such as the RHDH helper script, which might be helpful for understanding setup options or quick testing.
		</p><section class="section" id="proc-helper-script-overview_orchestrator-rhdh"><div class="titlepage"><div><div><h3 class="title">11.1. Installing components using the <code class="literal">RHDH</code> helper script</h3></div></div></div><p>
				You can use the RHDH helper script <code class="literal">plugin-infra.sh</code> to quickly install the OpenShift Serverless infrastructure and OpenShift Serverless Logic infrastructure required by the Orchestrator plugin.
			</p><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Do not use <code class="literal">plugin-infra.sh</code> in production.
				</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Download the <code class="literal">plugin-infra.sh</code> script as shown in the following example:
					</p><pre class="programlisting language-terminal">$ curl -sSLO https://raw.githubusercontent.com/redhat-developer/rhdh-operator/refs/heads/release-1.9/config/profile/rhdh/plugin-infra/plugin-infra.sh # Specify the Red Hat Developer Hub version in the URL or use main</pre></li><li class="listitem"><p class="simpara">
						Run the script:
					</p><pre class="programlisting language-terminal">$ ./plugin-infra.sh</pre></li></ol></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm46594052774928"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2026 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></section></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>