
:_mod-docs-content-type: procedure
[id="proc_enabling-service-to-service-authentication-by-using-jwks-tokens"]
= Enabling service-to-service authentication by using JSON web key sets (JWKS) tokens

You can use JSON Web Key Sets (JWKS) tokens to enable service-to-service authentication.

Consider using JWKS tokens when you need a more secure and scalable authentication method compared to static tokens.
While JWKS tokens require more setup and configuration, they offer enhanced security features that are crucial for production environments and sensitive applications:

Asymmetric encryption::
Your trusted Identity Provider issues JWKS tokens by using asymmetric encryption.
JWKS uses a pair of shared keys: one public, one private, instead of a single shared static token.
The Identity Provider signs the JWT with its private key, then {product-short} verifies it using the public key fetched from the JWKS endpoint.
{product-short} can validate these tokens without sharing secret keys directly.
This means {product-short} never has access to the private signing key, reducing the risk of compromise.

Easy key rotation::
The Identity Provider can rotate signing keys regularly without requiring changes to {product-short} afterward.
This minimizes downtime and enhances security.

Ability to validate claims::
JWKS tokens include claims such as issuer and audience. {product-short} can verify these claims to ensure the token is from a trusted source and prevent the external service from using the token in unintended contexts.

The diagram illustrates the authentication flow between an external service and {product-short}:

* The external service requests, receives, and returns an access token from the identity provider to request a resource from {product-short}.
* The identity provider issues a JWKS token signed with its private key, and provides the public key via the JWKS endpoint.
* {product-short} receives and validates the token and its claims.

image::authentication/jwks-authentication-flow.png["The diagram illustrates the authentication flow between an external service and {product-short}."]

.Prerequisites

* You have administrative access to configure {product-short} in your OpenShift cluster.
* {product-short} can access a JWKS endpoint available from your Identity Provider.
* You have configured your external service to obtain a JWT from your Identity Provider and include it in the `Authorization` header of requests to {product-short}.

.Procedure

* Add the JWKS URL to your `{my-app-config-file}` {product-short} configuration ile.
+
[source,yaml,subs="+attributes,+quotes"]
----
backend:
  auth:
    externalAccess:
      - type: jwks
        options:
          url: _<your_jwks_endpoint>_
          algorithm: RS256
          issuer: _<your_issuer_claim>_
          audience: _<your_audience_claim>_
          subjectPrefix: _<your_subject_prefix>_
----

`type`::
Enter `jwks` to specify that authentication is using JWKS tokens.

`options`::
Enter the configuration options for JWKS authentication.

`url`:::
Enter the URL of your JWKS endpoint, such as `pass:c,a,q[http://your-idp.example.com/well-known/jwks.json]`.

`algorithm`:::
(Optional) Enter the signing algorithm used by your Identity Provider, such as `pass:c,a,q[RS256]`.

`issuer`:::
(Optional) Enter the expected issuer claim in the token  `iss` field, such as `pass:c,a,q[http://your-idp.example.com]`.

`audience`:::
(Optional) Enter the expected audience claim in the token `aud` field, such as `pass:c,a,q[management]`.

`subjectPrefix`:::
(Optional) Enter a prefix to add to the subject claim, and to display in the Audit Log for debugging and tracking purposes, such as `pass:c,a,q[your_prefix]`.

