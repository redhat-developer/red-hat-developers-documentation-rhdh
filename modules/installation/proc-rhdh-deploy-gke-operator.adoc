[id="proc-rhdh-deploy-gke-operator.adoc_{context}"]
= Installing {product-short} on {gke-short} with the Operator

You can install the {product-short} Operator on {gke-short} using the https://olm.operatorframework.io[Operator Lifecycle Manager (OLM) framework]. Following that, you can proceed to deploy your {product-short} instance in {gke-short}.

== Installing the {product-short} Operator

.Prerequisites

* You have subscribed to `registry.redhat.io`. For more information, see https://access.redhat.com/RegistryAuthentication[{company-name} Container Registry Authentication].

* You have installed the Operator Lifecycle Manager (OLM). For more information about installation and troubleshooting, see https://operatorhub.io/how-to-install-an-operator#How-do-I-get-Operator-Lifecycle-Manager?[How do I get Operator Lifecycle Manager?]

* You have installed `kubectl`. For more information, see https://kubernetes.io/docs/tasks/tools/#kubectl[Install kubetl].

* You have installed the Google Cloud CLI. For more information, see https://cloud.google.com/sdk/docs/install[Install the gcloud CLI].

* You have logged in to your Google account and created a https://cloud.google.com/kubernetes-engine/docs/how-to/creating-an-autopilot-cluster[GKE Autopilot] or https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-zonal-cluster[GKE Standard] cluster.

.Procedure

. Connect to your GKE cluster using the following command:
+
--
[source,terminal]
----
gcloud container clusters get-credentials <cluster-name> \ <1>
    --location=<cluster-location> <2>
----
<1> Enter your GKE cluster name.
<2> Enter your GKE cluster location.
--
This command configures your Kubernetes client to point to your GKE cluster.

// Procedure fragment on installing the operator using OLM on a non OCP cluster
include::./snip-install-rhdh-operator-olm.adoc[]

.. Locate the `db-statefulset.yaml` string and add the `fsGroup` to its `spec.template.spec.securityContext`, as shown in the following example:
+
--
.`db-statefulset.yaml` fragment
[source,yaml]
----
  db-statefulset.yaml: |
    apiVersion: apps/v1
    kind: StatefulSet
--- TRUNCATED ---
    spec:
    --- TRUNCATED ---
      restartPolicy: Always
      securityContext:
      # You can assign any random value as fsGroup
        fsGroup: 2000
      serviceAccount: default
      serviceAccountName: default
--- TRUNCATED ---
----
--

.. Locate the `deployment.yaml` string and add the `fsGroup` to its specification, as shown in the following example:
+
--
.`deployment.yaml` fragment
[source,yaml]
----
  deployment.yaml: |
    apiVersion: apps/v1
    kind: Deployment
--- TRUNCATED ---
    spec:
      securityContext:
        # You can assign any random value as fsGroup
        fsGroup: 3000
      automountServiceAccountToken: false
--- TRUNCATED ---
----
--

.. Locate the `service.yaml` string and change the `type` to `NodePort` as follows:
+
--
.`service.yaml` fragment
[source,yaml]
----
  service.yaml: |
    apiVersion: v1
    kind: Service
    spec:
      type: NodePort
--- TRUNCATED ---
----
--

.. Save and exit.
+
Wait until the changes are automatically applied to the Operator pods.