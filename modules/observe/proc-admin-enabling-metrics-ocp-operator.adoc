// Module included in the following assemblies:
//
// * assemblies/assembly-rhdh-observability.adoc

:_mod-docs-content-type: PROCEDURE
[id="proc-admin-enabling-metrics-ocp-operator_{context}"]
= Enabling metrics monitoring in a {product} Operator installation on an {ocp-short} cluster

You can enable and view metrics for an Operator-installed {product} instance from the *Developer* perspective of the {ocp-short} web console.

.Prerequisites

* Your {ocp-short} cluster has link:https://docs.redhat.com/en/documentation/openshift_container_platform/{ocp-version}/html-single/monitoring/index#enabling-monitoring-for-user-defined-projects[monitoring for user-defined projects] enabled.
* You have installed {product} on {ocp-short} using the {product} Operator.
* You have installed the {openshift-cli}.

.Procedure

Currently, the {product} Operator does not support creating a `ServiceMonitor` custom resource (CR) by default. You must complete the following steps to create a `ServiceMonitor` CR to scrape metrics from the endpoint.

. Create the `ServiceMonitor` CR as a YAML file:
+
[source,yaml,subs="+attributes,+quotes"]
----
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: developer-hub-service-monitor <1>
  namespace: {my-product-namespace} <2>
  labels:
    app.kubernetes.io/instance: <rhdh-cr-name> <3>
    app.kubernetes.io/name: {product-custom-resource-type}
spec:
  namespaceSelector:
    matchNames:
      - <rhdh-namespace-name> <4>
  selector:
    matchLabels:
      app.kubernetes.io/instance: developer-hub <4>
      app.kubernetes.io/name: {product-custom-resource-type}
  endpoints:
  - port: http-metrics
    path: '/metrics'
----
<1> The name of your ServiceMonitor resource, for example, `developer-hub-service-monitor`.
<2> The namespace where your ServiceMonitor lives and where your {product-very-short} instance is installed.
<3> The name of the {ocp-short} project where your {product} instance is running.
<4> The name of your {product-very-short} deployment. 
[NOTE]
+
====
`spec.selector.matchLabels` configuration must match the labels of your {product-very-short} installation. To confirm the label names, go to Project > Services and get the labels for `backstage-developer-hub`.
==== 

. Apply the `ServiceMonitor` CR by running the following command:
+
[source,terminal]
----
oc apply -f <filename>
----

.Verification

. From the *Developer* perspective in the {ocp-short} web console, select the *Observe* view.
. Click the *Metrics* tab to view metrics for {product} pods.
. From the OpenShift Console in the Developer view, click **Project > Services** and verify the labels for `backstage-developer-hub`.