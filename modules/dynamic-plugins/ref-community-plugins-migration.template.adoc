// Module included in the following assemblies:
// assembly-dynamic-plugins.adoc

// This page is generated! Do not edit the .adoc file, but instead run rhdh-supported-plugins.sh to regen this page from the latest plugin metadata.

:_mod-docs-content-type: REFERENCE
[id="ref-community-plugins-migration_{context}"]
= Community plugins migration from bundled wrappers to ghcr.io

[IMPORTANT]
====
*Breaking Change in RHDH 1.9*

Starting with {product} 1.9, community-supported plugins are no longer distributed as bundled wrappers in the {product-short} container image. These plugins are now built using GitHub Actions and published exclusively to the GitHub Container Registry (ghcr.io).

If you are using any of the plugins listed in this section, you must update your dynamic plugins configuration (in `dynamic-plugins-default.yaml`, your ConfigMap or CustomResource) to use the new `oci://ghcr.io/...` paths.
====

== What changed

In previous versions of {product-short} (1.8 and earlier), community plugins were:

* Wrapped and bundled in the {product-short} container image
* Referenced using local paths like `./dynamic-plugins/dist/<plugin-name>`

Starting with {product-short} 1.9, community plugins are:

* Built using GitHub Actions from the link:https://github.com/redhat-developer/rhdh-plugin-export-overlays[rhdh-plugin-export-overlays] repository
* Published to `ghcr.io/redhat-developer/rhdh-plugin-export-overlays`
* Referenced using OCI registry paths like `oci://ghcr.io/redhat-developer/rhdh-plugin-export-overlays/<plugin-name>:<tag>`, or ideally by a SHA digest

== Migration steps

To migrate your configuration:

. Identify which plugins in your ConfigMap or CustomResource use local paths starting with `./dynamic-plugins/dist/`
. Find the corresponding new ghcr.io path in the migration table below
. Update your configuration to use the new OCI registry path

.Example migration
[source,yaml]
----
# Before (RHDH 1.8 and earlier)
plugins:
  - package: ./dynamic-plugins/dist/backstage-community-plugin-jenkins
    disabled: false

# After (RHDH 1.9+)
plugins:
  - package: oci://ghcr.io/redhat-developer/rhdh-plugin-export-overlays/backstage-community-plugin-jenkins:bs_1.45.3__0.26.0
    disabled: false
----

== Understanding the tag format

The ghcr.io image tags follow the format: `bs_<backstage-version>__<plugin-version>`

For example: `bs_1.45.3__0.26.0` means:

* `bs_1.45.3` - Built against Backstage version 1.45.3
* `0.26.0` - Nodejs-packaged Backstage plugin, version 0.26.0

== Community plugins migration table

The following table lists all %%MIGRATION_COUNT%% community-supported plugins that have been migrated from bundled wrappers to ghcr.io.

[NOTE]
====
Replace `<tag>` with the appropriate version tag for your {product-short} version. Check the link:https://github.com/redhat-developer/rhdh-plugin-export-overlays[rhdh-plugin-export-overlays repository] for the latest available tags.

Use of tags is not recommended; instead a SHA256 digest is preferred to avoid surprises. 

[cols="1,2,3", options="header"]
|===
|Plugin Name
|Old Path (RHDH 1.8)
|New Path (RHDH 1.9+)

%%MIGRATION_TABLE%%
|===

== Plugins remaining bundled in RHDH 1.9

The following plugins remain bundled in version 1.9 while transitioning to `ghcr.io` distribution in a future release:

[cols="1,2,3", options="header"]
|===
|Plugin Name
|Old Path (RHDH 1.9)
|New Path (RHDH 1.10+)

%%BUNDLED_PLUGINS%%
|===

== Troubleshooting

=== Plugin not loading after migration

If a plugin fails to load after migration:

. Verify the ghcr.io path is correct and the image tag or digest exists
. Check that your cluster has network access to `ghcr.io`
. Review the {product-short} logs for OCI pull errors
. To avoid unexpected updates, use a SHA256 digest instead of a tag

=== Finding available tags

To find available image tags for a plugin:

[source,bash]
----
# Using skopeo (filter for bs_ tags only, excluding pr_ and next__ tags)
skopeo list-tags docker://ghcr.io/redhat-developer/rhdh-plugin-export-overlays/<plugin-name> | jq -r '.Tags[]' | grep '^bs_'
----

== Additional resources

* link:https://github.com/redhat-developer/rhdh-plugin-export-overlays[rhdh-plugin-export-overlays GitHub repository]
* xref:ref-community-plugins.adoc[Community Plugins Reference]
* xref:proc-config-dynamic-plugins-rhdh-operator.adoc[Configuring dynamic plugins with the Operator]


